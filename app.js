(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t){e.exports='<section><h2>February, 16th − Beta 1 Release</h2>\n  <section><h3>Welcome!</h3>\n\n    <p>Equilibre.io is a portfolio balancer that runs on the Stellar\n    Decentralized Exchange. It is a convenient trading tool to manage long-term\n    positions.</p>\n\n    <p>Regularly balancing an investment portfolio is known to boost its\n    performances, providing you choose wisely the assets to bet on. Equilibre.io\n    also lets you spread your positions over several anchors, for better fund\n    safety.</p>\n\n    <p>Equilibre.io is still under testing & development. If you use it now,\n    I\'ll ask you to consider yourself as a tester. Please report any bug you\n    could encounter, and double-check transactions before signing them.</p>\n\n    <p>Your feedback matters to me and will be listened to.</p>\n\n    <p>Respectfully, <br>MisterTicot</p>\n\n  </section>\n\n  <section><h3>To Be Implemented</h3>\n    <ul>\n      <li>Interface to add/remove assets</li>\n      <li>Portfolio historic value</li>\n      <li>Customizable rebalancing periodicity</li>\n      <li>Pie graph for rebalancing tab</li>\n    </ul>\n  </section>\n\n  <section><h3>Known Limitations</h3>\n    <ul>\n\n      <li>It is required to "Cancel All" offers between applying a new balance\n      setup</li>\n\n    </ul>\n  </section>\n</section>\n'},101:function(e,t,n){var r=n(3),o=n(8),i=n(7),a=n(9),s=n(35).CosmicLink,c=n(30),u=n(1),l=n(6).__,f=n(12),d=n(51),h="GAWO2C52D57XBT7SQL6YB3XPHFLFD2J4Z5RN7HPFZSHXJMXH72HRXNV3",p=function(e){"use strict";function t(e,n){return r(this,t),o(this,i(t).call(this,'\n<footer id="footer" class="scrollable">\n  <div class="nobreak">%icons...</div>\n  %links\n</footer>\n    ',{icons:e,links:n}))}return a(t,c),t}(),m=function(e){"use strict";function t(e,n,a){var s;return r(this,t),(s=o(this,i(t).call(this,'<a -ref=%link class="Icon">%image</a>'))).image="string"==typeof e?new c(e):e,s.link.title=n,"function"==typeof a?s.link.onclick=a:"string"==typeof a&&(s.link.href=a,a.match(/^http/)&&(s.link.target="_blank",s.link.rel="noopener")),s}return a(t,c),t}();var v=[new m(n(102),"Keybase","https://keybase.io/team/cosmic_plus"),new m(n(103),"Telegram","https://t.me/cosmic_plus"),new m(n(104),"Reddit","https://reddit.com/r/cosmic_plus"),new m(n(105),"Twitter","https://twitter.com/cosmic_plus"),new m(n(106),"Medium","https://medium.com/cosmic-plus"),new m(n(107),"GitHub","https://github.com/cosmic-plus/webapp-equilibre-io"),new m(n(108),l("Website"),"https://cosmic.plus"),new m(n(109),l("Email"),"mailto:mister.ticot@cosmic.plus"),new m(n(110),l("Donate"),function(){var e=prompt("".concat(l("Equilibre.io runs on donation."),"\n\n").concat(l("Please contribute to its development according to what you think the service worth."),"\n\n").concat(l("Enter an amount (in Lumens)"),":"));if("0"===e||isNaN(+e))confirm("".concat(l("Not a valid amount"),": ").concat(e));else if(e){var t=new s({memo:l("Donation to Equilibre.io"),network:"public"}).addOperation("payment",{amount:e,destination:h});new d(t.uri)}})];var b='{"childs":["EUR","CNY","USD",{"size":12.5,"mode":"percentage","asset":"XLM"},{"size":12.5,"mode":"percentage","asset":"ETH"},{"size":12.5,"mode":"percentage","asset":"BTC"},{"size":4,"mode":"percentage","asset":"SLT"},{"size":4,"mode":"percentage","asset":"REPO"},{"size":2.25,"mode":"percentage","asset":"PEDI"},{"size":2.25,"mode":"percentage","asset":"TERN"}]}',g=new p(v,new c('\n<p>\n  <a target="_blank" rel="noopener" href="https://cosmic.plus">'.concat(l("A Cosmic.Plus Software"),"</a>\n  − <a onclick=%displayDemo>").concat(l("Demo"),'</a>\n  − <a target="_blank" rel="noopener" href="https://nucleo.fi/leaderboard/top/?span=3m">Performance</a>\n  − <a onclick=%displayLicense>').concat(l("License"),"</a>\n  − <a onclick=%displayAbout>").concat(l("About"),"</a>\n</p>\n"),{displayDemo:function(){localStorage["target:".concat(h)]=b,location.href="?address=".concat(h)},displayLicense:function(){return f.tabs.select("#license")},displayAbout:function(){return f.tabs.select("#about")}}));u.append(document.body,g)},110:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="none" d="M0 0h512v512H0z"/><path d="M211.719 367.797C219.469 379.281 224 393.109 224 408c0 39.734-32.266 72-72 72-39.758 0-72-32.266-72-72 0-23.172 11.148-43.563 28.164-56.734 1.852 5.594 4.336 11.125 8.289 15.906 7.055 8.516 20.336 18.266 43.531 16.344 7.578-.641 15.844-2.547 24.586-5.641 8.875-3.078 18.508-6.5 27.149-10.078zM389.875 32.578c-13.344 3.797-24.156 10.672-38.813 18.328-90 47-196.25 39.25-220 77-27.469 51.672-48.883 89.203-48.945 107.625-.016.063-.055.094-.07.141.586 19.953 19.625 58.438 29.07 75.969 6.789-15.516 17.492-29.219 32.25-40.688 7.414-5.766 13.289-9.922 18.617-13.5-3.016-9.25-6.945-20.016-10.875-28.203 10.742-7.391 26.078-26.484 31.398-40.313 13.227.094 30.25-3.172 44.773-6.938 6.406 6.844 12.977 13.563 21.766 20.016-3.961 14.344-7.07 27.063-23.438 38.359-22.313 15.438-42.734 21.578-69.484 43.109-16.086 12.953-26.07 28.203-30.625 45.641-3.148 12.094 4.734 53.016 58 33.141 10.023-3.75 23.398-8.531 34.875-14.25 23.797-11.813 52.922-40.781 61-44.828 15.234-7.641 49.813-10.656 86.313-35.016 12.531-8.375 22.063-20.688 26.477-33.625 33.242-64.828 60.883-59.656 68.633-72.563C477.734 133.734 423.563 23 389.875 32.578z"/></svg>\n'},26:function(e,t,n){var r=n(4),o=n(5),i=n(17),a=n(68),s=n(30),c=n(1),u=n(43),l=n(77),f=n(6).__,d=n(78),h=n(12),p=n(79),m=n(88).isOverflowing,v=n(89),b=n(90),g=n(94),y=n(95),w=new s(n(99)),k=new s(n(100));n(101);var T=h.tabs=new u({nav:i.header,view:i.main});T.add("#welcome",f("Welcome"),k),T.add("#login",f("Login"),i.loginForm),T.add("#license",null,w),T.add("#about",null,k),T.select(location.hash),T.selected||T.select("#welcome"),T.fitScreen=function(){m(i.header)&&c.replace(T.nav.domNode,T.selector.domNode)},T.fitScreen();var O,A=new a(i.loginForm).addValidator(E);function S(){return(S=o(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(4),n.e(1)]).then(n.t.bind(null,111,7)).then(function(e){return e.default});case 2:return O=e.sent,A.setInfo(f("Please open the Stellar App in your Ledger Wallet")),e.prev=4,e.next=7,O.connect();case 7:i.loginAddressBox.value=O.publicKey,E(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),console.error(e.t0),A.setError(e.t0);case 15:case"end":return e.stop()}},e,null,[[4,11]])}))).apply(this,arguments)}function E(){return C.apply(this,arguments)}function C(){return(C=o(r.mark(function e(){var t,n=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:i.loginAddressBox.value){e.next=3;break}throw new Error(f("Please enter an address."));case 3:return O&&O.disconnect(),A.setInfo(f("Connecting to your account...")),l.$set({address:t}),d.enable(),e.prev=7,e.next=10,p.resolve(t);case 10:h.portfolio=e.sent,A.setInfo("".concat(f("Fetching market data"),"...")),setTimeout(function(){return A.setInfo("".concat(f('Sorry, it takes a while (^.^)"'),"..."))},1e4),setTimeout(function(){return A.setInfo("".concat(f("Almost there"),"..."))},2e4),setTimeout(function(){return A.setInfo("".concat(f("I'm running, I'm running"),"..."))},3e4),h.portfolio.listen("open",function(){I(),d.disable()}),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(7),console.error(e.t0),A.setError(e.t0),d.disable();case 23:case"end":return e.stop()}},e,null,[[7,18]])}))).apply(this,arguments)}function I(){var e=h.portfolio,t=location.hash;T.remove("#welcome"),T.remove("#login"),T.add("#portfolio",f("Portfolio"),new b(e)),T.add("#rebalance",f("Rebalance"),new y(e)),T.add("#activity",f("Activity"),new v(e)),T.add("#settings",f("Settings"),new g),T.add("#logout",f("Logout"),function(){location.replace(location.href.replace(/\?.*$/,"#login"))}),T.fitScreen(),T.select(t),T.selected||T.select("#portfolio")}c.show(i.loginForm),i.loginForm.autocomplete="on",l.address?(T.select("#login"),i.loginAddressBox.value=l.address,E()):i.ledgerLoginButton.onclick=function(){return function(){return S.apply(this,arguments)}()},T.listen("select",function(e){location.hash=e,window.scrollTo(0,0)})},42:function(e,t,n){var r=n(4),o=n(5),i=n(3),a=n(8),s=n(7),c=n(11),u=n(10),l=n(9),f="https://www.xe.com/themes/xe/images/flags/svg/",d=".svg",h=n(32),p=n(13),m=n(12),v=n(60),b=n(61),g=e.exports=function(e){"use strict";function t(e){var n;return i(this,t),(n=a(this,s(t).call(this))).id=e,t.table[e]=c(n),n.image="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",t.info[e]?(n.code=e,Object.assign(c(n),t.info[e]),"fiat"===n.type?(t.fiats.push(c(n)),n.image="".concat(f).concat(e.toLowerCase()).concat(d)):(t.cryptos.push(c(n)),n.type="crypto")):(n.code=e.replace(/:.*/,""),n.name=n.code,n.type="unknown"),n.anchors=new h,n.balances=new h,n.offers=new h,n.balances.mirror(function(e){n.anchors.push(e.anchor),n.watch(e,"amount",function(){return n.compute("amount")}),n.watch(e,["buying","selling"],function(){n.compute("liabilities")})}),n.orderbook=b.forAsset(c(n)),n.define("price","globalPrice",function(){return n.globalPrice||n.orderbook.price}),n.watch(n.orderbook,"price",function(){return n.compute("price")}),n}return l(t,p),u(t,null,[{key:"resolve",value:function(e){return t.table[e]||new t(e)}}]),u(t,[{key:"getInfo",value:function(){var e=o(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.name&&"crypto"===this.type){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,v.crypto.info(this);case 4:this.info=e.sent,this.name=this.info.name,this.image=this.info.image.small;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addOrderbook",value:function(e){this.orderbook.addChild(e)}}]),t}();g.define("amount","balances",function(){return this.balances&&this.balances.reduce(function(e,t){return e+t.amount},0)}),g.define("value",["amount","price"],function(){return 0===this.amount?0:this.amount*this.price}),g.define("liabilities",["balances","price"],function(){if(this.balances){var e=this.balances.reduce(function(e,t){return e+t.buying-t.selling},0);return this.price*e}}),g.define("isSupported",["type","price"],function(){return!("unknown"===this.type&&!this.price)}),g.refreshPrices=function(){var e=o(r.mark(function e(t){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=7;break}return e.next=3,g.refreshCryptoPrices();case 3:return e.next=5,g.refreshFiatPrices();case 5:e.next=11;break;case 7:return e.next=9,g.refreshCryptoPrices(t.filter(function(e){return"crypto"===e.type}).map(function(e){return e.code}));case 9:return e.next=11,g.refreshFiatPrices(t.filter(function(e){return"fiat"===e.type}).map(function(e){return e.code}));case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),g.refreshCryptoPrices=o(r.mark(function e(){var t,n,o=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=o.length>0&&void 0!==o[0]?o[0]:g.cryptos).length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,v.crypto.prices(t);case 5:n=e.sent,t.forEach(function(e){return e.globalPrice=n[e.code]});case 7:case"end":return e.stop()}},e)})),g.refreshFiatPrices=o(r.mark(function e(){var t,n,o=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=o.length>0&&void 0!==o[0]?o[0]:g.fiats).length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,v.fiat.prices(t);case 5:n=e.sent,t.forEach(function(e){return e.price=e.globalPrice=n[e.code]});case 7:case"end":return e.stop()}},e)})),g.info={USD:{type:"fiat",name:"US Dollar"},EUR:{type:"fiat",name:"Euro"},CNY:{type:"fiat",name:"Renminbi"},BTC:{id:"bitcoin"},ETH:{id:"ethereum"},XRP:{id:"ripple"},XLM:{id:"stellar"},KIN:{id:"kin"},BAT:{id:"basic-attention-token"},ZRX:{id:"0x"},BCH:{id:"bitcoin-cash"},STEEM:{id:"steem"},SBD:{id:"steem-dollar"},LINK:{id:"chainlink"},SLT:{id:"smartlands"},MOBI:{id:"mobius"},SHX:{id:"stronghold-token"},RMT:{id:"sureremit"},TERN:{id:"ternio"},PEDI:{id:"pedity"},GRAT:{id:"gratz"},REPO:{id:"repo"}},g.table={},g.cryptos=[],g.fiats=[],new g(m.currency),setInterval(g.refreshCryptoPrices,6e4),setInterval(g.refreshFiatPrices,36e5),console.log(g.table)},51:function(e,t,n){var r=n(3),o=n(10),i=n(8),a=n(7),s=n(11),c=n(9),u=n(1),l=n(19),f=n(0).timeout,d=n(6).__,h=function(e){"use strict";function t(e){var n;return r(this,t),n=i(this,a(t).call(this)),t.current&&t.current.close(),t.current=s(n),n.domNode=u.create("iframe",{title:"Signing Frame",className:"animated",src:e,sandbox:"allow-same-origin allow-scripts allow-forms allow-popups",hidden:!0}),Object.assign(n.domNode.style,t.style),u.append(document.body,n.domNode),n.show(),n}return c(t,l),o(t,[{key:"show",value:function(){var e=this;if(this.domNode.hidden)return this.htmlOverflow=document.documentElement.style.overflow,this.bodyOverflow=document.body.style.overflow,document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",u.show(t.shadow,t.close,this.domNode),this.domNode.style.animationName="slideInRight",t.shadow.style.background="rgba(0,0,0,0.3)",f(400).then(function(){t.shadow.onclick=function(){return e.close()},t.close.onclick=function(){return e.close()},e.trigger("show")})}},{key:"hide",value:function(){var e=this;if(!this.domNode.hidden)return document.documentElement.style.overflow=this.htmlOverflow,document.body.style.overflow=this.bodyOverflow,t.shadow.onclick=null,u.hide(t.close),this.domNode.style.animationName="slideOutRight",t.shadow.style.background="transparent",f(400).then(function(){u.hide(t.shadow,t.close,e.domNode),e.trigger("hide")})}},{key:"close",value:function(){var e=this;t.current=null,this.hide().then(function(){u.destroy(e.domNode),e.trigger("close"),e.destroy()})}}]),t}();window.addEventListener("message",function(e){var t=h.current&&h.current.domNode.contentWindow;if(e.source===t)switch(e.data){case"show":h.current.show();break;case"hide":h.current.hide();break;case"close":h.current.close()}}),h.style={position:"fixed",zIndex:998,right:0,top:0,width:"30em",maxWidth:"100%",height:"100vh",border:"0.1em solid hsl(240, 10%, 75%)",background:"hsl(240, 40%, 98%)",backgroundImage:"url('./images/cosmic-link.svg')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"12em 12em",padding:0},h.close=u.create("span",{hidden:!0},"× ".concat(d("Close"))),Object.assign(h.close.style,{position:"fixed",zIndex:999,top:"0.1em",right:"0.1em",color:"hsl(0, 0%, 40%)",fontSize:"0.9em",fontWeight:"bold",cursor:"pointer",background:"hsl(0, 0%, 95%)",borderBottomLeftRadius:"0.1em",padding:"0.1em 0.3em"}),document.body.insertBefore(h.close,document.body.firstChild),h.shadow=u.create("div",{hidden:!0}),Object.assign(h.shadow.style,{position:"fixed",zIndex:997,top:0,width:"100%",height:"100%",background:"transparent",transition:"background 0.4s"}),document.body.insertBefore(h.shadow,document.body.firstChild),e.exports=h},60:function(e,t,n){var r=n(4),o=n(5),i=t,a=n(44),s=n(28),c=n(0).day,u=n(12);function l(e,t){return a.get("https://api.coingecko.com/api/v3/".concat(e),{params:t})}function f(e,t){return d.apply(this,arguments)}function d(){return(d=o(r.mark(function e(t,n){var o,i=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(o=i.length>2&&void 0!==i[2]?i[2]:{}).base=u.currency,"string"==typeof n?o.symbols=n:("EUR"===u.currency&&(n=n.filter(function(e){return"EUR"!==e})),o.symbols=n.join(",")),o.source="equilibre.io",e.abrupt("return",a.get("https://api.exchangeratesapi.io/".concat(t),{params:o}).then(function(e){return"EUR"!==u.currency||e.data.start_at||(e.data.rates.EUR=1),e}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(e,t){localStorage["prices.".concat(e.code)]=JSON.stringify([c(),t])}function p(e){var t=localStorage["prices.".concat(e.code)];if(t){var n=JSON.parse(t);return n[0]===c()?n[1]:void 0}}i.assetHistory=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return"crypto"===e.type?i.crypto.history(e,t):"fiat"===e.type?i.fiat.history(e,t):void 0},i.crypto={},i.crypto.list=o(r.mark(function e(){var t,n;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l("coins/list");case 2:return t=e.sent,n={},t.data.forEach(function(e){var t=e.symbol.toUpperCase();n[t]={id:e.id,name:e.name}}),e.abrupt("return",n);case 6:case"end":return e.stop()}},e)})),i.crypto.stellarNative=o(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l("exchanges/stellar_term");case 2:return t=e.sent,e.abrupt("return",t.data.tickers.map(function(e){return e.coin_id}).filter(function(e){return e}));case 4:case"end":return e.stop()}},e)})),i.crypto.info=function(){var e=o(r.mark(function e(t){var n;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l("coins/".concat(t.id),{localization:!1,tickers:!1,market_data:!1,community_data:!1,developer_data:!1,sparkline:!1});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),i.crypto.prices=function(){var e=o(r.mark(function e(t){var n,o,i,a;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(function(e){return e.id}).join(","),o=u.currency.toLowerCase(),e.next=4,l("simple/price",{ids:n,vs_currencies:o});case 4:return i=e.sent,a={},t.forEach(function(e){var t=i.data[e.id];t&&(a[e.code]=t[o])}),e.abrupt("return",a);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),i.crypto.history=function(){var e=o(r.mark(function e(t){var n,o,i,a=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:1e3,e.next=3,l("coins/".concat(t.id,"/market_chart"),{vs_currency:u.currency,days:n});case 3:return o=e.sent,i=o.data.prices.map(function(e,t){return{time:e[0],price:e[1],volume:+s(o.data.total_volumes[t][1]/e[1])}}),e.abrupt("return",i);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),i.fiat={},i.fiat.prices=function(){var e=o(r.mark(function e(t){var n,o,i,a;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(function(e){return e.code}),e.next=3,f("latest",n);case 3:for(a in o=e.sent,i=o.data.rates)i[a]=s(1/i[a],8);return e.abrupt("return",i);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),i.fiat.history=function(){var e=o(r.mark(function e(t){var n,o,i,a,c,u,l,d=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:1e3,!(o=p(t))){e.next=4;break}return e.abrupt("return",o);case 4:return i=(new Date).toISOString().slice(0,10),(a=new Date(i)).setDate(a.getDate()-n),c=a.toISOString().slice(0,10),e.next=10,f("history",t.code,{start_at:c,end_at:i});case 10:return u=e.sent,l=Object.keys(u.data.rates).sort().map(function(e){return{time:new Date(e).getTime(),price:+s(1/u.data.rates[e][t.code],8)}}),h(t,l),e.abrupt("return",l);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},61:function(e,t,n){var r=n(4),o=n(5),i=n(3),a=n(8),s=n(7),c=n(10),u=n(9),l=n(35),f=n(28),d=n(13),h=n(27),p=n(0).timeout,m=n(6).__,v=e.exports=function(e){"use strict";function t(e){var n;return i(this,t),n=a(this,s(t).call(this)),e.balance?(n.type="native",n.balance=e.balance,n.base=e.balance.asset,n.quote=e.quote,n.name="".concat(n.base.code,"/").concat(n.quote.code),n.offersCallBuilder=t.offersCallBuilder(n.balance),n.watch(n.quote,"price",function(){return n.updateOffersPrices()})):e.asset&&(n.type="agregated",n.base=e.asset,n.name="".concat(n.base.code," (").concat(m("Agregated"),")"),n.childs=[]),n.watch(n.base,"globalPrice",function(){return n.compute("price")}),n}return u(t,d),c(t,null,[{key:"forBalance",value:function(e,n){if(e.asset!==n){var r=new t({balance:e,quote:n});return r.streamOffers(),e.orderbook=r,e.asset.addOrderbook(r),r}}},{key:"forAsset",value:function(e){return new t({asset:e})}}]),c(t,[{key:"streamOffers",value:function(){var e=o(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.getOffers();case 3:return e.next=5,p(15e3);case 5:e.next=0;break;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getOffers",value:function(){var e=o(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.offersCallBuilder.call();case 3:t=e.sent,this.ingest(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"ingest",value:function(e){b(this.bids,e.bids)||(this.bids=g(e.bids,this.quote,this.balance,"bids")),b(this.asks,e.asks)||(this.asks=g(e.asks,this.quote,this.balance,"asks"))}},{key:"updateOffersPrices",value:function(){this.bids&&this.set("bids",y(this.bids,this.quote)),this.asks&&this.set("asks",y(this.asks,this.quote))}},{key:"mergeOffers",value:function(e){if(this.childs.length<2)this.set(e,this.childs[0]&&this.childs[0][e]);else{var t=this.childs.reduce(function(t,n){return n[e]?t.concat(n[e]):t},[]);if(t.length){var n="bids"===e?function(e,t){return t.price-e.price}:function(e,t){return e.price-t.price},r=0,o=0,i=0;this.set(e,t.sort(n).map(function(e){var t=Object.assign({},e);return t.volume=r+=+f(e.amount*e.price,7),t.baseVolume=o+=+e.amount,t.quoteVolume=i+=+e.quoteAmount,t}))}else this[e]=null}}},{key:"addChild",value:function(e){var t=this;this.childs.push(e),this.watch(e,"bids",function(){return t.mergeOffers("bids")}),this.watch(e,"asks",function(){return t.mergeOffers("asks")})}}],[{key:"offersCallBuilder",value:function(e){var t=new h.Asset(e.code,e.anchor.address),n=h.Asset.native();return l.resolve.server().orderbook(t,n)}}]),t}();function b(e,t){if(!e)return!1;if(e.length!==t.length)return!1;for(var n in e.length){if(e[n].amount!==t[n].amount)return!1;if(e[n].price!==t[n].price)return!1}return!0}function g(e,t,n,r){return e.forEach(function(e){e.volume=void 0,e.baseVolume=void 0,e.basePrice=+e.price,e.quoteAmount=+e.amount,e.quoteVolume=void 0,e.balance=n,e.side=r}),y(e,t)}function y(e,t){var n=0,r=0,o=0;return e.forEach(function(e){"asks"===e.side?e.quoteAmount=+f(e.amount*e.basePrice,7):e.amount=+f(e.quoteAmount/e.basePrice,7),e.price=+f(e.basePrice*t.price,7),e.volume=n+=+f(e.amount*e.price,7),e.baseVolume=o+=+e.amount,e.quoteVolume=r+=+e.quoteAmount}),e}v.define("bestBid","bids",function(){return this.bids&&this.bids[0]&&this.bids[0].price}),v.define("bestAsk","asks",function(){return this.asks&&this.asks[0]&&this.asks[0].price}),v.define("price",["bestBid","bestAsk"],function(){return this.base.globalPrice?(this.bestBid+this.bestAsk)/2:this.marketPrice()}),v.define("spread",["bestBid","bestAsk"],function(){return this.bestAsk-this.bestBid}),v.define("spread%",["spread","bestAsk"],function(){return 100*this.spread/this.bestAsk}),v.prototype.findOffer=function(e,t){var n,r=this[e],o=this.childs?this.childs.length:1,i={};for(var a in r){var s=r[a];if(!t||t(s)){var c=s.balance.anchor.address;if(i[c]||(i[c]=!0,n=s),Object.keys(i).length===o)break}}return n},v.prototype.findAsk=function(e){return this.findOffer("asks",e)},v.prototype.findBid=function(e){return this.findOffer("bids",e)},v.prototype.marketPrice=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bids",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=this.findOffer(e,function(e){return e.quoteVolume>t});return n?n.price:0}},62:function(e,t,n){var r=n(3),o=n(8),i=n(7),a=n(11),s=n(10),c=n(9),u=n(32),l=n(13),f=n(85),d=n(42),h=n(61),p=e.exports=function(e){"use strict";function t(e){var n;return r(this,t),(n=o(this,i(t).call(this))).id=m(e),n.code=e.asset_code||"XLM",n.anchor=f.resolve(e.asset_issuer||"stellar.org"),t.table[n.id]=a(n),"XLM"===n.id||n.id in f.known?(n.asset=d.resolve(f.known[n.id]||n.code),n.known=!0):(n.asset=d.resolve(n.id),n.known=!1),n.amount=+e.balance,n.buying=+e.buying_liabilities,n.offers=new u,n.selling=+e.selling_liabilities,n.asset.balances.push(a(n)),"XLM"===n.code?n.asset.project("price",a(n)):(n.orderbook=h.forBalance(a(n),d.resolve("XLM")),n.orderbook.project("price",a(n))),n}return c(t,l),s(t,null,[{key:"resolve",value:function(e,n){var r=e?"".concat(e,":").concat(n):"XLM";return t.table[r]}},{key:"ingest",value:function(e){var n=m(e),r=t.table[n];return r?(r.amount=+e.balance,r.buying=+e.buying_liabilities,r.selling=+e.selling_liabilities,r):new t(e,n)}}]),t}();function m(e){return e.asset_code?"".concat(e.asset_code,":").concat(e.asset_issuer):"XLM"}p.table={},p.define("value",["amount","price"],function(){return 0===this.amount?0:this.amount*this.price})},64:function(e,t,n){var r=n(53),o=n(38),i=n(3),a=n(8),s=n(7),c=n(10),u=n(9),l=n(35).CosmicLink,f=n(32),d=n(28),h=n(13),p=n(6).__,m=n(12),v=e.exports=function(e){"use strict";function t(e,n){var r;i(this,t),(r=a(this,s(t).call(this))).type=e,r.method=t.type[r.type],r.operations=new f,r.orderbook=n;for(var o=arguments.length,c=new Array(o>2?o-2:0),u=2;u<o;u++)c[u-2]=arguments[u];return r.parameters=c,r.operations.listen("update",function(){r.compute(["cosmicLink","description"])}),r.refresh(),r}return u(t,h),c(t,null,[{key:"rebalance",value:function(e){if("XLM"!==e.asset.code){var n=new t("balance",e.asset.orderbook,e);return n.watch(e,"amount",function(){return n.refresh()}),n.watch(e.asset.orderbook,["bids","asks"],function(){return n.refresh()}),e.asset.offers.listen("change",function(){return n.refresh()},n),n}}}]),c(t,[{key:"refresh",value:function(){this.operations.splice(0,this.operations.length),this.operations.trigger("update"),this.method.apply(this,[this].concat(o(this.parameters))),this.trigger("refresh")}},{key:"getOperation",value:function(e,t){var n="".concat(e.balance.anchor.name,":").concat(t?e.price:"take"),r=this.operations.find(function(e){return e.id===n});if(r)return r;var o={id:n};return this.operations.push(o),o}},{key:"addOperation",value:function(e,t){var n=this.getOperation(e,t>0);this.setOperation(n,e,Number(t)||n.amount)}},{key:"setOperation",value:function(e,t,n){e.amount=n,e.cost=n*t.price,e.offer=t,this.operations.trigger("update")}}]),t}();function b(e){return e.amount>0&&"bids"===e.offer.side||e.amount<0&&"asks"===e.offer.side?"buy":"sell"}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.filter(function(e){return e.amountTradable>=t})}function y(e,t,n){var r=function(e,t){var n="quantity"===e.mode||0===e.amount;return function(e){return e.balance.amountTradable>=t&&e.baseVolume>t*m.skipMarginalOffers&&(n||t*e.basePrice>m.minOfferValue)}}(e,Math.abs(n));v.type.limit(e.order,n,{orderbook:t,filter:r})}function w(e,t,n){return Math.min(Math.max(e,t),n)}v.define("cosmicLink","operations",function(){return v.operationsToCosmicLink(this.operations)}),v.define("description","operations",function(){return v.operationsToDescription(this.operations)}),v.operationsToCosmicLink=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=new l({memo:"Equilibre.io",maxTime:"+5",source:m.portfolio.accountId});return e.forEach(function(e){t.addOperation("manageOffer",function(e){var t,n=e.offer,r=n.balance.code+":"+n.balance.anchor.address;t="buy"===b(e)?{buying:r,selling:"XLM",amount:e.amount*n.price_r.n/n.price_r.d,price:{n:n.price_r.d,d:n.price_r.n}}:{buying:"XLM",selling:r,amount:e.amount,price:n.price_r};return t.amount=Math.abs(t.amount).toFixed(7),t.offerId=e.offer.id,t}(e))}),t},v.operationsToDescription=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];return e.forEach(function(e){"buy"===b(e)?t.push("\n".concat(p("Buy")," ").concat(d(e.amount)," ").concat(e.offer.balance.code," ").concat(p("at")," ").concat(d(e.offer.price)," ").concat(m.currency,"\n      ")):t.push("\n".concat(p("Sell")," ").concat(d(e.amount)," ").concat(e.offer.balance.code," ").concat(p("at")," ").concat(d(e.offer.price)," ").concat(m.currency,"\n      "))}),t},v.type={},v.type.market=function(e,t){if(t){var n=t>0?"asks":"bids",r=Math.abs(t),o=e.orderbook.findOffer(n,function(e){return e.baseVolume>r});e.addOperation(o,r)}},v.type.limit=function(e,t,n){var r=n.orderbook,o=n.filter;if(t){var i=t>0?"bids":"asks",a=(r||e.orderbook).findOffer(i,o);a&&e.addOperation(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.spreadTightening,n=Object.assign({},e),r=t*e.balance.asset.orderbook["spread%"]/100;"bids"===e.side?n.price=e.price*(1+r):n.price=e.price*(1-r);e.balance.asset.globalPrice&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.maxSpread/2,n=e.balance.asset.price;"bids"===e.side?e.price=w(e.price,n*(1-t),n):e.price=w(e.price,n,n*(1+t))}(n);return function(e){var t=e.balance.orderbook.quote;for(e.price_r={n:d(1e10*e.price,0),d:d(1e10*t.price,0)};e.price_r.n>999999999||e.price_r.d>999999999;)e.price_r.n=d(e.price_r.n/10,0),e.price_r.d=d(e.price_r.d/10,0)}(n),n}(a),Math.abs(t))}},v.type.balance=function(e,t){var n=t.asset,r=n.orderbook;if(null!=t.amount&&0!==t.amountDelta)if(r.bestBid&&r.bestAsk){if(n.liabilities)if(n.offers.filter(function(e){return!e.outdated}).length)return void(e.description=[p("Rebalancing...")]);!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.balanceTargetDeviation,n=[];if(e.asset.balances.forEach(function(e){null!=e.orderbook.price?n.push(e):e.amountTradable=0}),!n.length)return;if(1===n.length)return n[0].amountTradable=e.amountDelta;var r=+d(e.amount/n.length,7),o=+d(r*(1-t),7),i=+d(r*(1+t),7);n.forEach(function(t){e.amountDiff>0?t.amountTradable=i-t.amount:t.amountTradable=t.amount-o})}(t),!function(e){return!!g(e.asset.balances,e.amountDelta).length}(t)?function(e){var t=g(e.asset.balances),n=t.map(function(e){return e.amountTradable}),r=n.reduce(function(e,t){return e+t},0),o=n.map(function(e){return e/r}).map(function(t){return+d(t*e.amountDiff,7)});t.forEach(function(t,n){y(e,t.orderbook,o[n])})}(t):y(t,r,t.amountDiff)}else e.description=[p("Fetching orderbook...")]};var k=function(e){v[e]||(v[e]=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return r(v,[e].concat(n))})};for(var T in v.type)k(T)},78:function(e,t,n){var r=e.exports,o=n(1),i=o.create("div",{hidden:!0});o.append(document.body,i),Object.assign(i.style,{position:"fixed",zIndex:999,top:0,width:"100%",height:"100%"}),r.enable=function(){return o.show(i)},r.disable=function(){return o.hide(i)}},79:function(e,t,n){var r=n(4),o=n(5),i=n(3),a=n(8),s=n(7),c=n(11),u=n(10),l=n(9),f=n(44),d=n(35),h=n(32),p=n(13),m=n(0).timeout,v=n(6).__,b=n(42),g=n(62),y=n(12),w=n(86);function k(){return T.apply(this,arguments)}function T(){return(T=o(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.resolve.horizon(),e.prev=1,e.next=4,f.get(t);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),new Error(v("Can't connect to the Stellar blockchain"));case 9:case"end":return e.stop()}},e,null,[[1,6]])}))).apply(this,arguments)}e.exports=function(e){"use strict";function t(e){var n;return i(this,t),n=a(this,s(t).call(this)),console.log(c(n)),n.accountId=e,n.assets=new h,n.balances=new h,n.accountCallBuilder=t.accountCallBuilder(e),n.define("total","assets",function(){return n.assets.filter(function(e){return e.isSupported}).reduce(function(e,t){return e+t.value},0)}),n.assets.mirror(function(e){return n.watch(e,["value","isSupported"],function(){return n.compute("total")})}),n.new=!0,n}return l(t,p),u(t,null,[{key:"resolve",value:function(){var e=o(r.mark(function e(n){var o,i;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:return e.next=4,d.resolve.address(n);case 4:if(!(o=e.sent).memo){e.next=7;break}throw new Error(v("Invalid federated address: shared account."));case 7:return e.next=9,d.resolve.isAccountEmpty(o.account_id);case 9:if(!e.sent){e.next=11;break}throw new Error(v("Empty account"));case 11:return i=new t(o.account_id),d.config.source=i.address=n,i.streamAccount(),e.abrupt("return",i);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),u(t,[{key:"streamAccount",value:function(){var e=o(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.getAccount();case 3:return e.next=5,m(5e3);case 5:e.next=0;break;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getAccount",value:function(){var e=o(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.accountCallBuilder.call();case 3:t=e.sent,this.ingest(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"ingest",value:function(){var e=o(r.mark(function e(t){var n,o,i=this;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(o in this.account=t,n=function(e){var n=g.ingest(t.balances[e]),r=n.asset;-1===i.assets.indexOf(r)?(i.assets.push(r),i.balances.push(n),r.watch(i,"total",function(){return r.compute("share")}),r.getInfo()):-1===i.balances.indexOf(n)&&i.balances.push(n)},t.balances)n(o);if(!this.new){e.next=11;break}return delete this.new,e.next=7,b.refreshPrices();case 7:return this.offers=w.forPortfolio(this),e.next=10,this.offers.stream();case 10:this.trigger("open");case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}],[{key:"accountCallBuilder",value:function(e){return d.resolve.server().accounts().accountId(e)}}]),t}(),b.define("share","value",function(){return y.portfolio&&this.value/y.portfolio.total})},85:function(e,t,n){var r=n(3),o=n(8),i=n(7),a=n(11),s=n(10),c=n(9),u=n(54),l=n(0),f=n(13),d=e.exports=function(e){"use strict";function t(e){var n;return r(this,t),(n=o(this,i(t).call(this))).address=e,n.alias=u.all[e],n.name=l.shorter(n.alias||n.address),t.all[e]=a(n),n.assets={},n}return c(t,f),s(t,null,[{key:"resolve",value:function(e){return t.all[e]||new t(e)}}]),t}();d.all={},d.known={"USD:GDUKMGUGDZQK6YHYA5Z6AY2G4XDSZPSZ3SW5UN3ARVMO6QSRDWP5YLEX":"USD","WSD:GDSVWEA7XV6M5XNLODVTPCGMAJTNBLZBXOFNQD3BNPNYALEYBNT6CE2V":"USD","USD:GDSRCV5VTM3U7Y3L6DFRP3PEGBNQMGOWSRTGSBWX6Z3H6C7JHRI4XFJP":"USD","USD:GBUYUAI75XXWDZEKLY66CFYKQPET5JR4EENXZBUZ3YXZ7DS56Z4OKOFU":"USD","CNY:GAREELUB43IRHWEASCFBLKHURCGMHE5IF6XSE7EXDLACYHGRHM43RFOX":"CNY","XCN:GCNY5OXYSY4FKHOPT2SPOQZAOEIGXB5LBYW3HVU3OWSTQITS65M5RCNY":"CNY","BCNY:GBCNYBHAAPDSU3UIHXXQTHYZVSBJBI4YUNWXMKJBCPDHTVYR75G6NFHD":"CNY","EURT:GAP5LETOV6YIE62YAM56STDANPRDO7ZFDBGSNHJQIYGGKSMOZAHOOS2S":"EUR","SLT:GCKA6K5PCQ6PNF5RQBF7PQDJWRHO6UOGFMRLK3DYHDOI244V47XKQ4GP":null,"MOBI:GA6HCMBLTZS5VYYBCATRBRZ3BZJMAFUDKYYF6AH6MVCMGWMRDNSWJPIH":null,"SHX:GDSTRSHXHGJ7ZIVRBXEYE5Q74XUVCUSEKEBR7UCHEUUEK72N7I7KJ6JH":null,"RMT:GDEGOXPCHXWFYY234D2YZSPEJ24BX42ESJNVHY5H7TWWQSYRN5ZKZE3N":null,"TERN:GDGQDVO6XPFSY4NMX75A7AOVYCF5JYGW2SHCJJNWCQWIDGOZB53DGP6C":null,"PEDI:GBVUDZLMHTLMZANLZB6P4S4RYF52MVWTYVYXTQ2EJBPBX4DZI2SDOLLY":null,"GRAT:GAJ7V3EMD3FRWAPBEJAP7EC4223XI5EACDZ46RFMY5DYOMCIMWEFR5II":null,"REPO:GCZNF24HPMYTV6NOEHI7Q5RJFFUI23JKUKY3H3XTQAFBQIBOHD5OXG3B":null,"BTC:GATEMHCCKCY67ZUCKTROYN24ZYT5GK4EQZ65JJLDHKHRUZI3EUEKMTCH":null,"BTC:GAUTUYY2THLF7SGITDFMXJVYH3LHDSMGEAKSBU267M2K7A3W543CKUEF":null,"BTC:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P":null,"BTC:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5":null,"ETH:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P":null,"ETH:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5":null,"ETH:GBETHKBL5TCUTQ3JPDIYOZ5RDARTMHMEKIO2QZQ7IOZ4YC5XV3C2IKYU":null,"ETH:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR":null,"LTC:GC5LOR3BK6KIOK7GKAUD5EGHQCMFOGHJTC7I3ELB66PTDFXORC2VM5LP":null,"LTC:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5":null,"LTC:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P":null,"XRP:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5":null,"XRP:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P":null,"KIN:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR":null,"BAT:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR":null,"ZRX:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR":null,"BCH:GAEGOS7I6TYZSVHPSN76RSPIVL3SELATXZWLFO4DIAFYJF7MPAHFE7H4":null,"STEEM:GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM":null,"SBD:GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM":null,"LINK:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR":null}},86:function(e,t,n){var r=n(11),o=n(38),i=n(4),a=n(5),s=n(3),c=n(10),u=n(8),l=n(7),f=n(9),d=n(35),h=n(87),p=n(32),m=n(28),v=n(13),b=n(0).setHiddenProperty,g=n(0).day,y=n(42),w=n(62),k=function(e){"use strict";function t(){return s(this,t),u(this,l(t).apply(this,arguments))}return f(t,p),c(t,[{key:"stream",value:function(){var e=a(i.mark(function e(){var t,n=this,r=arguments;return i.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:15e3,e.abrupt("return",this.get().then(function(){return setTimeout(function(){return n.stream()},t)}));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=a(i.mark(function e(){var t;return i.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h(this.callBuilder,{limit:200});case 3:t=e.sent,this.ingest(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"ingest",value:function(e){this.forEach(function(e){return e.alive=!1});var t=e.map(function(e){return T.ingest(e)}).filter(function(e){return e});this.splice.apply(this,[0,0].concat(o(t))),this.clean()}},{key:"clean",value:function(){for(var e=this.length-1;e>-1;e--){var t=this[e];t.alive||(this.splice(e,1),t.destroy())}}}],[{key:"forPortfolio",value:function(e){var n=t.forAccount(e.accountId);return b(n,"portfolio",e),n}},{key:"forAccount",value:function(e){var n=new t;return b(n,"accountId",e),b(n,"callBuilder",t.callBuilder(e)),n}},{key:"callBuilder",value:function(e){return d.resolve.server().offers("accounts",e)}}]),t}(),T=function(e){"use strict";function t(e){var n;s(this,t),(n=u(this,l(t).call(this))).intern=O(e),t.table[n.intern]=r(n);var o=y.resolve("XLM"),i=e.buying.asset_code?e.buying:e.selling;return n.balance=w.resolve(i.asset_code,i.asset_issuer),n.asset=n.balance.asset,n.side=e.buying.asset_code?"buy":"sell",n.define("price","rawPrice","sell"===n.side?function(){return o.price*n.rawPrice}:function(){return o.price/n.rawPrice}),n.watch(o,"price",function(){return n.compute("price")}),n.update(e),n.balance.offers.push(r(n)),n.asset.offers.push(r(n)),n.listen("destroy",function(){delete t.table[n.intern],n.balance.offers.splice(n.balance.offers.indexOf(r(n)),1),n.asset.offers.splice(n.asset.offers.indexOf(r(n)),1)}),n}return f(t,v),c(t,null,[{key:"resolve",value:function(e){return t.table[O(e)]}},{key:"ingest",value:function(e){var n=t.resolve(e);if(!n)return new t(e);n.update(e)}}]),c(t,[{key:"update",value:function(e){Object.assign(this,e),this.alive=!0,this.rawPrice=e.price,this.compute("price"),this.rawAmount=e.amount,"buy"===this.side&&(this.amount=m(this.rawAmount*this.rawPrice,7)),this.date=g(this.last_modified_time),this.outdated=this.date!==g()}}]),t}();function O(e){return"".concat(e.id,"-").concat(e.last_modified_ledger)}T.table={},e.exports=k},88:function(e,t){t.isOverflowing=function(e){return e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth}},89:function(e,t,n){var r=n(10),o=n(3),i=n(8),a=n(7),s=n(11),c=n(9),u=n(30),l=n(28),f=n(43),d=n(6).__,h=n(35).CosmicLink,p=n(51),m=n(12),v=function(e){"use strict";function t(e){var n;o(this,t),(n=i(this,a(t).call(this,"\n<section>\n  <h2>".concat(d("Activity"),"</h2>\n  %selector\n  %view\n</section>\n    ")))).portfolio=e;var r=new f;return r.project("view",s(n)),r.add("offers",d("Open Orders"),new t.Offers(e),"select"),n}return c(t,u),t}();v.Offers=function(e){"use strict";function t(e){var n;return o(this,t),(n=i(this,a(t).call(this,"\n<section>\n  <table>\n    <tr>\n      <th>".concat(d("Date"),"</th>\n      <th>").concat(d("Asset"),"</th>\n      <th>").concat(d("Direction"),"</th>\n      <th>").concat(d("Amount"),"</th>\n      <th>").concat(d("Price"),' (%globalCurrency)</th>\n    </tr>\n    %formatOffer:offers...\n    <tr><td colspan="5" align="center" onclick=%cancelOffers>\n      <h3>').concat(d("Cancel All"),'</h3>\n    </td></tr>\n  </table>\n</section>\n\n<p class="note">\n  ').concat(d("All orders are passed against Stellar Lumens (XLM)."),"\n  ").concat(d("For your comfort, prices are displayed in their %%globalCurrency equivalent."),"\n  ").concat(d("However, those converted values will change according to XLM price movement."),"\n</p>\n    ")))).portfolio=e,n.offers=e.offers,n.globalCurrency=m.currency,n}return c(t,u),r(t,[{key:"formatOffer",value:function(e){return new v.Offer(e)}},{key:"cancelOffers",value:function(){var e=this;if(this.offers.length){var t={memo:"Equilibre.io",network:"public",maxTime:"+5",source:this.portfolio.accountId},n=new h(t);this.offers.forEach(function(e){n.addOperation("manageOffer",{offerId:e.id,amount:0})}),new p(n.uri).listen("destroy",function(){e.portfolio.getAccount(),e.portfolio.offers.get()})}}}]),t}(),v.Offer=function(e){"use strict";function t(e){var n;return o(this,t),(n=i(this,a(t).call(this,'\n<tr>\n  <td>%formatDate:last_modified_time</td>\n  <td>\n    <img src=%image alt="">\n    <span>%name / %anchor</span>\n  </td>\n  <td>%side</td>\n  <td align="right">%nice:amount</td>\n  <td align="right">%nice:price</td>\n</tr>\n    '))).offer=e,e.project(["last_modified_time","amount","price"],s(n)),n.name=e.asset.code,n.side="buy"===e.side?d("Buy"):d("Sell"),n.anchor=e.balance.anchor.name,e.asset.link("image",s(n)),n}return c(t,u),r(t,[{key:"nice",value:function(e){return l(e)}},{key:"formatDate",value:function(e){return(e?new Date(e):new Date).toLocaleDateString()}}]),t}(),e.exports=v},90:function(e,t,n){var r=n(3),o=n(10),i=n(8),a=n(7),s=n(11),c=n(9),u=n(63),l=n(91);n(92);var f=n(30),d=n(28),h=n(43),p=n(6).__,m=n(93),v=n(12),b=n(60),g=function(e){"use strict";function t(e){var n;return r(this,t),(n=i(this,a(t).call(this,"\n<section><h2>".concat(p("Portfolio"),': %total %currency</h2>\n  %summary\n  %chart\n\n  <p class="note" align="center">\n    ').concat(p("Anchor prices are from Stellar DEX")," /\n    ").concat(p("Global prices are from %%coingecko when available."),"\n    </p>\n\n</section>")))).portfolio=e,e.project("total",s(n),function(e){return d(e,2)}),n.currency=v.currency,n.summary=new t.Summary(s(n)),n.coingecko=new f('<a target="_blank" rel="noopener" href="https://coingecko.com">coingecko</a>'),n}return c(t,f),o(t,[{key:"select",value:function(e){this.chart&&this.chart.destroy(),e&&e.globalPrice&&e.code!==v.currency?this.chart=new t.Chart(e):this.chart=null}}]),t}();function y(e){return{name:e.name,code:e.code,asset:e,y:+d(e.value,2),amount:d(e.amount),price:d(e.price),percentage:e.percentage}}g.Summary=function(e){"use strict";function t(e){var n;r(this,t);var o=new h;return n=i(this,a(t).call(this,"%nav <section>%view</section>",o)),o.add("table",p("Table"),new g.Table(e)),o.add("graph",p("Graph"),function(){return new g.Graph(e)}),o.listen("select",function(e){return localStorage["PortfolioSummary.tab"]=e}),o.select(localStorage["PortfolioSummary.tab"]||"table"),n}return c(t,f),t}(),g.Table=function(e){"use strict";function t(e){var n;return r(this,t),(n=i(this,a(t).call(this,"\n<table>\n  <tr>\n    <th>".concat(p("Name"),"</th>\n    <th>").concat(p("Anchor"),"</th>\n    <th>").concat(p("Amount"),"</th>\n    <th>").concat(p("Price"),"</th>\n    <th>").concat(p("Value"),"</th>\n  </tr>\n  %assetsGui...\n</table>\n")))).parent=e,n.assetsGui=e.portfolio.assets.mirror(function(e){var t=new m(e);return t.domNode.onclick=function(){return n.select(t)},t}),n.watch(e.portfolio,"total",function(){return n.sort()}),n}return c(t,f),o(t,[{key:"sort",value:function(){this.assetsGui.sort(function(e,t){return t.asset.value-e.asset.value})}},{key:"select",value:function(e){this.selected&&(this.selected.domNode.className="",this.selected.simpleView()),this.selected===e?(this.parent.select(),this.selected=null):(this.parent.select(e.asset),e.domNode.className="selected",this.selected=e,e.detailledView())}}]),t}(),g.Graph=function(e){"use strict";function t(e){var n;return r(this,t),(n=i(this,a(t).call(this,'<div -ref=%container align="center"></div>'))).parent=e,n.listen("destroy",function(){return n.chart&&n.chart.destroy()}),n.watch(e.portfolio,"total",function(){setTimeout(function(){return n.makePie()},1)}),n}return c(t,f),o(t,[{key:"makePie",value:function(){var e=this;this.chart&&this.chart.destroy(),this.chart=u.chart(this.container,{title:"",legend:{enabled:!1},chart:{type:"pie"},tooltip:{pointFormat:"\n".concat(p("Amount"),": {point.amount} {point.code}<br>\n").concat(p("Price"),": {point.price} ").concat(v.currency,"<br>\n<b>").concat(p("Value"),": {point.y} ").concat(v.currency,"</b>\n")},plotOptions:{pie:{dataLabels:{format:"{point.amount} {point.code}<br>({point.percentage:.0f}%)"},point:{events:{select:function(t){return e.parent.select(t.target.options.asset)},legendItemClick:function(){return!1}}}}},series:[{name:p("Amount"),colorByPoint:!0,ignoreHiddenPoint:!0,data:this.parent.portfolio.assets.filter(function(e){return e.value}).map(y).sort(function(e,t){return t.y-e.y})}]})}}]),t}(),g.Chart=function(e){"use strict";function t(e){var n;return r(this,t),(n=i(this,a(t).call(this,"\n      <section><h3>".concat(e.code," ").concat(p("to")," ").concat(v.currency,"</h3>\n        <div -ref=%container><p>").concat(p("Loading..."),"</p></div>\n      </section>\n    ")))).asset=e,n.listen("destroy",function(){return n.chart&&n.chart.destroy()}),b.assetHistory(e).then(function(e){return n.makeChart(e)}),n}return c(t,f),o(t,[{key:"makeChart",value:function(e){this.chart=l.stockChart(this.container,{rangeSelector:{selected:2},chart:{backgroundColor:"#fbfbfd"},yAxis:[{labels:{align:"left"},height:"80%",resize:{enabled:!0}},{labels:{align:"left"},top:"80%",height:"20%",offset:0}],series:[{type:"spline",name:"Price",data:e.map(function(e){return[e.time,+d(e.price)]})},{type:"column",name:"Volume",data:e.map(function(e){return[e.time,e.volume]}),yAxis:1}],credits:{enabled:!1}})}}]),t}(),e.exports=g},92:function(e,t,n){var r=n(63);r.theme={chart:{backgroundColor:"#fbfbfd"},tooltip:{style:{fontSize:"14px"}},credits:{enabled:!1},plotOptions:{pie:{allowPointSelect:!0,animation:!1,cursor:"pointer",dataLabels:{style:{fontSize:"14px"}}}},responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{enabled:!0},plotOptions:{pie:{showInLegend:!0,dataLabels:{format:"{point.percentage:.0f}%",distance:-20}}}}}]},colors:["rgba(231,  76,  60, 0.8)","rgba(230, 126,  34, 0.8)","rgba(242, 202,  39, 0.8)","rgba(46,  204, 112, 0.8)","rgba(52,  152, 219, 0.8)","rgba(155,  89, 182, 0.8)","rgba(231,  76,  60, 0.6)","rgba(230, 126,  34, 0.6)","rgba(242, 202,  39, 0.6)","rgba(46,  204, 112, 0.6)","rgba(52,  152, 219, 0.6)","rgba(155,  89, 182, 0.6)","rgba(231,  76,  60, 0.4)","rgba(230, 126,  34, 0.4)","rgba(242, 202,  39, 0.4)","rgba(46,  204, 112, 0.4)","rgba(52,  152, 219, 0.4)","rgba(155,  89, 182, 0.4)"]},r.setOptions(r.theme)},93:function(e,t,n){var r=n(3),o=n(10),i=n(8),a=n(7),s=n(11),c=n(9),u=n(30),l=n(1),f=n(28),d=n(6).__,h=function(e){"use strict";function t(e){var n;r(this,t),(n=i(this,a(t).call(this,'\n<tr %style>\n  <td align="left">\n    <img src=%image alt="">\n    <span>%name</span>\n  </td>\n  <td align="left">\n    <div hidden=%simple>%anchors...</div>\n    <div %class>%anchorTotal</div>\n  </td>\n  <td align="right">\n    <div hidden=%simple>%amounts...</div>\n    <div %class>%amountTotal</div>\n  </td>\n  <td align="right">\n    <div hidden=%simple>%prices...</div>\n    <div %class title=%priceDetails>%priceTotal</div>\n  </td>\n  <td align="right">\n    <div hidden=%simple>%values...</div>\n    <div %class>%valueTotal</div>\n  </td>\n</tr>\n    '))).asset=e,n.name=e.code,n.anchors=e.balances.mirror(function(e){return m(e.anchor,"name")}),n.amounts=e.balances.mirror(function(e){return m(e,"amount",f)}),n.prices=e.balances.mirror(function(e){return n=m(t=e,"price",f),t.trap("orderbook",function(){t.orderbook&&t.orderbook.trap(["bestAsk","bestBid","spread%"],function(){n.title=v(t.orderbook)})}),n;var t,n}),n.values=e.balances.mirror(function(e){return m(e,"value",function(e){return f(e,2)})}),e.link("image",s(n)),e.link("amount",s(n),"amountTotal",f),e.link("price",s(n),"priceTotal",f),e.link("value",s(n),"valueTotal",function(e){return f(e,2)}),e.anchors.feed(s(n),"anchorHeader",p);var o=n.asset.orderbook;return n.define("priceDetails","orderbook",function(){return v(o)}),n.watch(o,["bestAsk","bestBid","spread%"],function(){n.compute("priceDetails")}),n.simpleView(),n}return c(t,u),o(t,[{key:"simpleView",value:function(){this.simple=!0,this.class="",this.anchorTotal=this.anchorHeader}},{key:"detailledView",value:function(){this.simple=!1,this.class="footer",this.anchorTotal="Total"}}]),t}();function p(e){return 1===e.length?e[0].name:"".concat(d("Multiple")," (").concat(e.length,")")}function m(e,t,n){var r=l.create("div",null,e[t]);return e.link(t,r,"textContent",n),r}function v(e){return"XLM"===e.base.code?"":"\nBuy: ".concat(f(e.bestBid)," - Sell: ").concat(f(e.bestAsk)," - Spread: ").concat(f(e["spread%"],2),"%\n  ")}e.exports=h},94:function(e,t,n){var r=n(3),o=n(8),i=n(7),a=n(11),s=n(9),c=n(30),u=n(6).__,l=n(12),f=function(e){"use strict";function t(){var e;return r(this,t),e=o(this,i(t).call(this,"\n      <section><h2>".concat(u("Settings"),"</h2>\n        <section><h3>").concat(u("General Settings"),"</h3>\n          <form>\n            <label><span>").concat(u("Language"),':</span>\n              <select value=%language>\n                <option value="us">English</option>\n                <option value="fr">Français</option>\n              </select>\n            </label>\n            <label><span>').concat(u("Currency"),':</span>\n              <select value=%currency>\n                <option value="CNY">CNY</option>\n                <option value="EUR">EUR</option>\n                <option value="USD">USD</option>\n              </select>\n            </label>\n          </form>\n        </section>\n      </section>\n    '))),l.project(["currency","language"],a(e)),e.project(["currency","language"],l),e.listen("change:currency",function(){return location.reload()}),e.listen("change:language",function(){return location.reload()}),e}return s(t,c),t}();e.exports=f},95:function(e,t,n){var r=n(3),o=n(10),i=n(8),a=n(7),s=n(11),c=n(9),u=n(30),l=n(6),f=n(1),d=l.__,h=n(51),p=n(64),m=n(96),v=n(98),b=function(e){"use strict";function t(e){var n;r(this,t),(n=i(this,a(t).call(this,'\n<section class="RebalanceGui">\n  <h2>'.concat(d("Rebalance"),'</h2>\n\n  %table\n\n  %setup\n\n  <section hidden=%hideControls>\n    <form onsubmit="return false" hidden=%hideRebalance>\n      <button onclick=%rebalance disabled=%invalid>').concat(d("Rebalance"),'</button>\n    </form>\n\n    <form onsubmit="return false" hidden=%hideApply>\n      <button onclick=%apply disabled=%invalid>').concat(d("Save"),"</button>\n      <button onclick=%cancel>").concat(d("Cancel"),"</button>\n    </form>\n\n    %toParagraph:error\n  </section>\n\n</section>\n    ")))).portfolio=e;var o="target:".concat(e.account.id),c=localStorage[o];return n.target=m.forPortfolio(e,c),n.target.link("json",localStorage,o,null,{init:!1}),n.table=new t.Table(n.target),n.table.project("selected",s(n)),n.project("selected",n.table),n.trap("selected",function(){n.setup&&n.setup.destroy(),n.selected?(n.setup=new v.Setup(n.selected),n.setup.listen("close",function(){return n.selected=null})):n.setup=null}),n.target.project(["error","modified"],s(n)),n.define("hideControls",["hideRebalance","hideApply"],function(){return n.hideRebalance&&n.hideApply}),n.define("hideRebalance",["selected","modified"],function(){return n.selected||n.modified}),n.define("hideApply",["selected","modified"],function(){return n.selected||!n.modified}),n.define("invalid",["error"],function(){return!!n.error}),n}return c(t,u),o(t,[{key:"toParagraph",value:function(e){if(e)return f.create("p",".error",e)}},{key:"cancel",value:function(){location.reload()}},{key:"apply",value:function(){this.target.json=this.target.toJson(),this.target.modified=!1}},{key:"rebalance",value:function(){var e=this,t=function(e){var t=[];return e.childs.forEach(function(e){e.order&&(t=t.concat(e.order.operations))}),t}(this.target),n=this.portfolio.offers.filter(function(e){return e.outdated}).filter(function(e){return!t.find(function(t){return t.offer.id===e.id})});if(t.forEach(function(e){!e.offer.id&&n.length&&(e.offer.id=n.pop().id)}),!t.length)return!1;var r=p.operationsToCosmicLink(t);(n.forEach(function(e){r.addOperation("manageOffer",{amount:0,offerId:e.id})}),r)&&new h(r.uri).listen("destroy",function(){e.portfolio.getAccount(),e.portfolio.offers.get()})}}]),t}();b.Table=function(e){"use strict";function t(e){var n;return r(this,t),(n=i(this,a(t).call(this,'\n<section class="RebalanceTable">\n  <table>\n    <tr>\n      <th>'.concat(d("Name"),"</th>\n      <th>").concat(d("Goal"),"</th>\n      <th>").concat(d("Divergence"),"</th>\n      <th>").concat(d("Operation"),'</th>\n    </tr>\n\n    %targets...\n\n    <tr hidden=true>\n      <td align="center" colspan="4"><h3>').concat(d("Add Asset"),"</h3></td>\n    </tr>\n  </table>\n</section>\n    ")))).targets=e.childs.mirror(function(e){return n.toTargetGui(e)}),n.selected=void 0,e.listen("update",function(){return n.sortTargets()}),n.sortTargets(),n}return c(t,u),o(t,[{key:"toTargetGui",value:function(e){var t=this,n=new v(e);return n.domNode.onclick=function(){return t.selected=e},n}},{key:"sortTargets",value:function(){this.targets.sort(function(e,t){return e=e.target,"ignore"===(t=t.target).mode&&"ignore"!==e.mode?-1:"ignore"===e.mode&&"ignore"!==t.mode?1:t.value-e.value||e.asset.code.localeCompare(t.asset.code)})}}]),t}(),e.exports=b},96:function(e,t,n){var r=n(38),o=n(3),i=n(10),a=n(8),s=n(7),c=n(11),u=n(9),l=n(32),f=n(28),d=n(13),h=n(42),p=n(64),m=n(97),v=function(e){"use strict";function t(e){var n;return o(this,t),n=a(this,s(t).call(this)),e?(n.asset=e,n.mode="ignore",n.order=p.rebalance(c(n)),e.target=c(n),n.watch(e,"value",function(){return n.compute("valueDiff")})):(n.childs=new l,n.childs.listen("add",function(e){return e.parent=c(n)}),n.childs.listen("change",function(){return n.computeAll()})),n.trap("size",function(){n.size&&(n.size=Math.max(0,n.size),"percentage"===n.mode&&(n.size=Math.min(100,n.size))),n.computeAll()}),n}return u(t,d),i(t,[{key:"root",get:function(){return this.parent?this.parent.root:this}}]),t}();v.define("name",["group","asset"],function(){return this.group||"unknow"===this.asset.type?this.asset.id:this.asset.code}),v.define("valueDiff",["value","asset"],function(){return this.asset&&this.asset.value-this.value}),v.define("valueDiffP","valueDiff",function(){return this.value?this.valueDiff/this.value:null}),v.define("amountDiff",["amount"],function(){return+f(this.amount-this.asset.amount,7)}),v.define("amountDelta",["amountDiff"],function(){return Math.abs(this.amountDiff)}),v.define("share",null,function(){return this.value/this.root.portfolio.total}),v.define("shareDiff",["share"],function(){return this.asset.share-this.share}),v.prototype.computeAll=function(){if(this.parent)this.root.computeAll();else if(this.portfolio&&this.portfolio.total){try{this.error=null,this.value=this.portfolio.total,this.modified=this.hasChanged(),m.apply(this)}catch(e){this.error=e.message,console.error(e)}this.trigger("update")}},v.sortChilds=function(e){return e.childs.slice().sort(function(e,t){return e.name.localeCompare(t.name)})},v.forPortfolio=function(e,t){var n=t?v.fromJson(t):new v;return n.portfolio=e,e.target=n,n.watch(e,"total",function(){return n.computeAll()}),e.assets.forEach(function(e){!n.childs.find(function(t){return e===t.asset})&&e.isSupported&&n.childs.push(new v(e))}),n.childs.forEach(function(t,r){e.assets.find(function(e){return e===t.asset})&&t.asset.isSupported||n.childs.splice(r,1)}),e.assets.listen("add",function(e){e.isValid&&n.childs.push(new v(e))}),e.assets.listen("remove",function(e){var t=n.childs.findIndex(function(t){return t.asset===e});n.childs.splice(t,1)}),n},v.fromJson=function(e){var t=JSON.parse(e),n=v.fromObject(t);return n.json=e,n},v.prototype.toJson=function(e){var t=this.toObject();return JSON.stringify(t,null,e&&2)},v.prototype.hasChanged=function(){return this.toJson()!==(this.json||'{"childs":[]}')},v.fromObject=function(e){"string"==typeof e&&(e={asset:e});var t=e.asset&&h.resolve(e.asset),n=new v(t);if(n.size=e.size,n.mode=e.mode,"equal"===n.mode&&(n.mode="weight"),"skip"===n.mode&&(n.mode="ignore"),n.mode||(n.mode="weight"),null==n.size&&"weight"===n.mode&&(n.size=1),e.childs){var o;n.group=e.group;var i=e.childs.map(function(e){return v.fromObject(e)}),a=i.filter(function(e){return"percentage"===e.mode});a.length&&!i.find(function(e){return"weight"===e.mode})&&100!==a.reduce(function(e,t){return e.size+t},0)&&a.forEach(function(e){return e.mode="weight"}),(o=n.childs).push.apply(o,r(i))}return n},v.prototype.toObject=function(){if("ignore"!==this.mode){var e={mode:this.mode,size:this.size};if("weight"===e.mode&&(delete e.mode,1===e.size&&delete e.size),this.asset)e.asset=this.name,1===Object.keys(e).length&&(e=e.asset);else if(this.childs){e.group=this.group;var t=v.sortChilds(this);e.childs=t.map(function(e){return e.toObject()}).filter(function(e){return e})}return e}},e.exports=v},97:function(e,t,n){var r=t,o=n(28),i=n(6).__,a=n(12);r.apply=function(e){var t=[],n=0,s=0;e.childs.forEach(function(e){var o=e.mode;"weight"===o?(t.push(e),s+=e.size):(r[o](e),n+=e.value)});var c=Math.max(0,e.value-n);t.forEach(function(e){return r.weight(e,c,s)}),function(e,t,n){if(e>t){var r=+o(e-t,2),s=+o(100*r/t,2),c=i("Rebalance setup is over portfolio value by");throw c+=" ".concat(r," ").concat(a.currency," (").concat(s,"%) "),new Error(c)}if(!n&&e<t){var u=+o(t-e,2),l=+o(100*u/t,2),f=i("Rebalance setup is under portfolio value by");throw f+=" ".concat(u," ").concat(a.currency," (").concat(l,"%) "),new Error(f)}}(n,e.value,t.length)},r.amount=function(e){e.amount=e.size,e.value=e.amount*e.asset.price,e.compute("share")},r.ignore=function(e){e.value=e.asset.value,e.amount=e.asset.amount,e.compute("share")},r.percentage=function(e){r.weight(e,e.parent.value,100)},r.weight=function(e,t,n){n?(e.value=e.size*t/n,e.amount=+o(e.value/e.asset.price,7)):e.value=e.amount=0,e.compute("share")}},98:function(e,t,n){var r=n(3),o=n(10),i=n(8),a=n(7),s=n(11),c=n(9),u=n(30),l=n(6),f=n(1),d=n(28),h=l.__,p=function(e){"use strict";function t(e){var n;return r(this,t),(n=i(this,a(t).call(this,'\n<tr class="TargetGui">\n  <td align="left">\n    <img src=%image alt="">\n    <span>%name</span>\n  </td>\n  <td align="right">%command</td>\n  <td align="right">%toPercent:shareDiff</td>\n  <td align="right">%toDiv:description...</td>\n</tr>\n    '))).target=e,n.name=e.name||e.asset&&e.asset.code,n.define("command",null,function(){return n.toCommand(e)}),n.watch(e,["size","mode","share"],function(){return n.compute("command")}),e.asset.project("image",s(n)),e.project("shareDiff",s(n)),e.order&&e.order.project("description",s(n)),n}return c(t,u),o(t,[{key:"toCommand",value:function(e){switch(e.mode){case"ignore":return h("Ignore");case"amount":return"".concat(e.amount," ").concat(e.asset.code);case"weight":return"".concat(e.size," − ").concat(this.toPercent(e.share));case"percentage":return this.toPercent(e.share)}}},{key:"toPercent",value:function(e){return e?d(100*e,2)+"%":"-"}},{key:"toDiv",value:function(e){return f.create("div",null,e)}}]),t}();p.Setup=function(e){"use strict";function t(e){var n;return r(this,t),(n=i(this,a(t).call(this,'\n<section>\n  <form onsubmit="return false">\n\n    <h3>%name</h3>\n    <hr>\n\n    <label><span>'.concat(h("Size"),':</span>\n\n      <input class="half" type="number" step="any" min="0" %max\n        value=%size placeholder=%share onchange=%maybeSwitchMode>\n\n      <select class="half" onchange=%setMode value=%mode>\n        <option value="weight">').concat(h("Weight"),'</option>\n        <option value="percentage">').concat(h("Percentage"),'</option>\n        <option value="amount">').concat(h("Amount"),'</option>\n        <option value="ignore" hidden=%targetIsXlm>').concat(h("Ignore"),'</option>\n      </select>\n\n    </label>\n\n    <hr>\n    <input type="submit" onclick=%close value="').concat(h("Close"),'">\n\n  </form>\n</section>\n    ')))).target=e,n.name=e.asset.name,n.targetIsXlm="stellar"===e.asset.id,e.project("share",s(n),function(e){return d(100*e,2)}),e.project("size",s(n)),n.project("size",e,function(e){return null!=e?Number(e):null}),e.project("mode",s(n)),n.project("mode",e),n}return c(t,u),o(t,[{key:"maybeSwitchMode",value:function(){0===this.size?this.mode="amount":this.size?"ignore"===this.mode&&(this.mode="percentage",this.target.computeAll()):this.mode="ignore"}},{key:"setMode",value:function(){switch(this.mode){case"weight":this.size=1,this.max=null;break;case"percentage":this.size=+d(100*this.target.asset.share,2),this.max=100;break;case"amount":this.size=this.target.asset.amount,this.max=null;break;case"ignore":this.size=null}}},{key:"close",value:function(){this.maybeSwitchMode(),this.trigger("close"),this.destroy()}}]),t}(),e.exports=p},99:function(e,t){e.exports='<section><h2>License</h2>\n  <section><h3>MIT License</h3>\n\n    <p>Copyright (c) 2019 Antoine Bodin &lt;<a\n    href="mailto:mister.ticot@cosmic.plus">mister.ticot@cosmic.plus</a>&gt;</p>\n\n    <p>Permission is hereby granted, free of charge, to any person obtaining a\n    copy of this software and associated documentation files (the "Software"),\n    to deal in the Software without restriction, including without limitation\n    the rights to use, copy, modify, merge, publish, distribute, sublicense,\n    and/or sell copies of the Software, and to permit persons to whom the\n    Software is furnished to do so, subject to the following conditions:</p>\n\n    <p>The above copyright notice and this permission notice shall be included\n    in all copies or substantial portions of the Software.</p>\n\n    <p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n    OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n    IN THE SOFTWARE.</p>\n  </section>\n</section>\n'}}]);
//# sourceMappingURL=app.js.map
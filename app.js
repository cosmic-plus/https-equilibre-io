(window.webpackJsonp=window.webpackJsonp||[]).push([[0],Array(26).concat([function(e,t,n){"use strict";var r,i=n(5),a=n(6),o=n(17),s=n(27),c=n(1),u=n(57),l=n(82),h=n(4).__,f=n(12),d=n(83),p=n(54),m=n(70),v=n(96).isOverflowing,g=n(97),b=n(99),y=n(104),w=n(105),k=new s(n(118)),x=new s(n(119)),A=new s(n(120));function T(){return(T=a(i.mark(function e(){return i.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return M["stellar-public-key"]=null,e.next=3,Promise.all([n.e(4),n.e(1)]).then(n.t.bind(null,135,7)).then(function(e){return e.default});case 3:return r=e.sent,M.info(h("Please open the Stellar App in your Ledger Wallet")),e.prev=5,e.next=8,r.connect();case 8:M["stellar-public-key"]=r.publicKey,O(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),M.error(e.t0);case 15:case"end":return e.stop()}},e,null,[[5,12]])}))).apply(this,arguments)}function O(){return S.apply(this,arguments)}function S(){return(S=a(i.mark(function e(){var t,n;return i.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=M["stellar-public-key"])||M.error(h("Please enter an address.")),r&&r.disconnect(),M.info(h("Connecting to your account...")),l.$set({address:t}),(n=new p).enable(),e.prev=7,e.next=10,d.resolve(t);case 10:f.portfolio=e.sent,M.info("".concat(h("Fetching market data"),"...")),setTimeout(function(){return M.info("".concat(h('Sorry, it takes a while (^.^)"'),"..."))},1e4),setTimeout(function(){return M.info("".concat(h("Almost there"),"..."))},2e4),setTimeout(function(){return M.info("".concat(h("I'm running, I'm running"),"..."))},3e4),f.portfolio.listen("open",function(){E(),n.destroy()}),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(7),n.destroy(),M.error(e.t0);case 22:case"end":return e.stop()}},e,null,[[7,18]])}))).apply(this,arguments)}function E(){var e=f.portfolio,t=location.hash;D.remove("#welcome"),D.remove("#login"),D.remove("#demo"),D.add("#portfolio",h("Portfolio"),new b(e)),D.add("#rebalance",h("Rebalance"),new w(e)),D.add("#activity",h("Activity"),new g(e)),D.add("#settings",h("Settings"),new y),D.add("#logout",h("Logout"),function(){location.replace(location.href.replace(/\?.*$/,"#login"))}),D.fitScreen(),D.listen("select",function(){if(D.selected){var e=D.selected.content;e.reflow&&e.reflow()}}),D.select(t),D.selected||D.select("#portfolio")}var C="GAWO2C52D57XBT7SQL6YB3XPHFLFD2J4Z5RN7HPFZSHXJMXH72HRXNV3";function I(){localStorage["target:".concat(C)]=R,location.href="?address=".concat(C)}var R='{"childs":[{"mode":"percentage","size":12.5,"asset":"BTC"},"CNY",{"mode":"percentage","size":12.5,"asset":"ETH"},"EUR",{"mode":"percentage","size":1.5625,"asset":"FRAS"},{"mode":"percentage","size":1.5625,"asset":"MOBI"},{"mode":"percentage","size":1.5625,"asset":"PEDI"},{"mode":"percentage","size":1.5625,"asset":"REPO"},{"mode":"percentage","size":1.5625,"asset":"RMT"},{"mode":"percentage","size":1.5625,"asset":"SHX"},{"mode":"percentage","size":1.5625,"asset":"SLT"},{"mode":"percentage","size":1.5625,"asset":"TERN"},"USD",{"mode":"percentage","size":12.5,"asset":"XLM"}]}';var P=n(32),N=n(121);P.register(N.fiat,{type:"fiat",isTether:!0}),P.register(N.foreign,{type:"crypto",isTether:!0}),P.register(N.native,{type:"crypto",isTether:!1}),P.resolve(f.currency,{type:"fiat",isTether:!0}),n(68).register(n(122)),n(123);var D=f.tabs=new u({nav:o.header,view:o.main});D.add("#welcome",h("Welcome"),x),D.add("#demo",h("Demo"),I),D.add("#login",h("Login"),o.loginTab),D.add("#license",null,k),D.add("#disclaimer",null,A),D.add("#about",null,x),o.demoLink.onclick=I,c.show(o.loginTab),D.select(location.hash),D.selected||(localStorage["PortfolioSummary.tab"]?D.select("#login"):D.select("#welcome")),D.fitScreen=function(){v(o.header)&&c.replace(D.nav.domNode,D.selector.domNode)},D.fitScreen();var M=new m(o.loginForm,{onsubmit:O});M.dom.loginWithLedger.onclick=function(){return T.apply(this,arguments)},l.address&&(D.select("#login"),M["stellar-public-key"]=l.address,O()),D.listen("select",function(e){location.hash=e,window.scrollTo(0,0)})},,,,,function(e,t,n){"use strict";var r=t;r.positive=function(e){return Math.max(0,e)},r.negative=function(e){return Math.min(0,e)},r.fixed7=function(e){return+Number(e).toFixed(7)},r.clamp=function(e,t,n){return Math.min(Math.max(e,t),n)},r.absoluteMin=function(e,t){return Math.abs(e)<=Math.abs(t)?e:t},r.arrayContains=function(e,t){return-1!==e.indexOf(t)},r.arrayRemove=function(e,t){for(var n=e.length-1;n>=0;n--)e[n]===t&&e.splice(n,1)},r.arrayOnlyInFirst=function(e,t){return e.filter(function(e){return!r.arrayContains(t,e)})},r.arraySum=function(e,t){return t?e.reduce(function(e,n){return e+n[t]},0):e.reduce(function(e,t){return e+t},0)},r.arrayScale=function(e,t,n){var i=r.arraySum(e,n);return i?n?e.map(function(e){return e[n]*t/i}):e.map(function(e){return e*t/i}):e.map(function(){return 0})}},function(e,t,n){"use strict";var r=n(5),i=n(6),a=n(3),o=n(8),s=n(7),c=n(11),u=n(10),l=n(9),h="https://www.xe.com/themes/xe/images/flags/svg/",f=".svg",d=n(33),p=n(13),m=n(89),v=n(67),g=n(31),b=g.fixed7,y=g.arrayContains,w=g.arrayRemove,k=g.arraySum,x=e.exports=function(e){function t(e,n){var r;return a(this,t),r=o(this,s(t).call(this)),n&&Object.assign(c(r),n),r.id=e,t.table[e]=c(r),r.image="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",r.type?(r.code=e,"fiat"===r.type?(t.fiats.push(c(r)),r.image="".concat(h).concat(e.toLowerCase()).concat(f),r.useGlobalPrice=!0):(t.cryptos.push(c(r)),r.type="crypto",(r.isTether||"XLM"===r.id)&&(r.useGlobalPrice=!0))):(r.code=e.replace(/:.*/,""),r.name=r.code,r.type="unknown"),r.anchors=new d,r.balances=new d,r.offers=new d,r.balances.mirror(function(e){r.watch(e,"amount",function(){return r.compute("amount")}),r.watch(e,["buying","selling"],function(){r.compute("liabilities")})}),r.orderbook=v.forAsset(c(r)),r.define("price","globalPrice",function(){return r.globalPrice||r.orderbook.price}),r.watch(r.orderbook,"price",function(){return r.compute("price")}),r}return l(t,p),u(t,null,[{key:"resolve",value:function(e,n){return t.table[e]||new t(e,n)}}]),u(t,[{key:"maybeAddBalance",value:function(e){y(this.balances,e)||(this.balances.push(e),e.orderbook||e.streamPrice())}},{key:"maybeRemoveBalance",value:function(e){w(this.balances,e)}},{key:"getInfo",value:function(){var e=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.name&&"crypto"===this.type){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,m.crypto.info(this);case 4:this.info=e.sent,this.name=this.info.name,this.image=this.info.image.small;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getHistoricPrice",value:function(){var e=i(r.mark(function e(){var t=this;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.historicPrice){e.next=2;break}return e.abrupt("return",this.historicPrice);case 2:return e.next=4,m.assetHistory(this);case 4:if(this.historicPrice=e.sent,this.historicPrice){e.next=7;break}return e.abrupt("return");case 7:return this.trap("price",function(){t.historicPrice[t.historicPrice.length-1].price=t.price}),e.abrupt("return",this.historicPrice);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}();x.define("amount","balances",function(){return this.balances&&b(k(this.balances,"amount"))}),x.define("value",["amount","price"],function(){return 0===this.amount?0:this.amount*this.price}),x.define("liabilities",["balances","price"],function(){if(this.balances){var e=this.balances.reduce(function(e,t){return e+t.buying-t.selling},0);return this.price*e}}),x.define("isSupported",["type","price"],function(){return!("unknown"===this.type&&!this.price)}),x.register=function(e,t){for(var n in e){var r=Object.assign({},t,e[n]);x.resolve(n,r)}},x.getAllInfo=function(){Object.values(x.table).forEach(function(e){return e.getInfo()})},x.refreshPrices=function(){var e=i(r.mark(function e(t){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=7;break}return e.next=3,x.refreshCryptoPrices();case 3:return e.next=5,x.refreshFiatPrices();case 5:e.next=11;break;case 7:return e.next=9,x.refreshCryptoPrices(t.filter(function(e){return"crypto"===e.type}).map(function(e){return e.code}));case 9:return e.next=11,x.refreshFiatPrices(t.filter(function(e){return"fiat"===e.type}).map(function(e){return e.code}));case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),x.refreshCryptoPrices=i(r.mark(function e(){var t,n,i=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=i.length>0&&void 0!==i[0]?i[0]:x.cryptos).length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,m.crypto.prices(t);case 5:n=e.sent,t.forEach(function(e){e.useGlobalPrice&&(e.globalPrice=n[e.code])});case 7:case"end":return e.stop()}},e)})),x.refreshFiatPrices=i(r.mark(function e(){var t,n,i=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=i.length>0&&void 0!==i[0]?i[0]:x.fiats).length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,m.fiat.prices(t);case 5:n=e.sent,t.forEach(function(e){e.useGlobalPrice&&(e.globalPrice=n[e.code])});case 7:case"end":return e.stop()}},e)})),x.table={},x.cryptos=[],x.fiats=[],setInterval(x.refreshCryptoPrices,6e4),setInterval(x.refreshFiatPrices,36e5),console.log(x.table)},,,,,,,,,,,,function(e,t,n){"use strict";var r=n(3),i=n(8),a=n(7),o=n(11),s=n(10),c=n(9),u=this,l=n(33),h=n(13),f=n(68),d=n(32),p=n(67),m=n(12),v=n(31),g=v.fixed7,b=v.positive,y=v.negative,w=v.arrayRemove,k=function(e){function t(e){var n;r(this,t);var s=e.code,c=e.issuer;return(n=i(this,a(t).call(this))).code=s,n.anchor=f.resolve(c||"stellar.org"),n.id=t.makeId(s,c),t.table[n.id]=o(n),n.code in n.anchor.assets?(n.asset=n.anchor.assets[n.code],n.known=!0):(n.asset=d.resolve(n.id),n.known=!1),n.update(e),n.offers=new l,n}return c(t,h),s(t,null,[{key:"resolve",value:function(e,n){var r=t.makeId(e,n);return t.table[r]||new t({code:e,issuer:n})}},{key:"ingest",value:function(e){var n=t.recordToParams(e),r=t.resolve(n.code,n.issuer);return r.update(n),r.hasTrustline=!0,r}}]),s(t,[{key:"update",value:function(e){var t=e.amount,n=e.buying,r=e.selling;this.amount=t||0,this.buying=n||0,this.selling=r||0}},{key:"streamPrice",value:function(){this.orderbook||("XLM"===this.id?this.asset.project("price",this):(this.orderbook=p.forBalance(this,d.resolve("XLM")),this.orderbook.project("price",this),this.asset.orderbook.addChild(this.orderbook)))}}]),t}();k.table={},k.trap("hasTrustline",function(){u.hasTrustline&&w(u.asset.target.opening,u.anchor.pubkey)}),k.define("isActive",["action","hasTrustline"],function(){return this.hasTrustline?"closing"!==this.action:"opening"===this.action}),k.define("value",["amount","price"],function(){return 0===this.amount?0:this.amount*this.price}),k.define("targetMin",["targetAmount"],function(){return g(this.targetAmount*(1-m.balanceTargetDeviation))}),k.define("targetMax",["targetAmount"],function(){return g(this.targetAmount*(1+m.balanceTargetDeviation))}),k.define("targetMinDiff",["amount","targetMin"],function(){return g(this.targetMin-this.amount)}),k.define("targetMaxDiff",["amount","targetMax"],function(){return g(this.targetMax-this.amount)}),k.define("sizeMin",["targetMinDiff"],function(){return y(this.targetMinDiff)}),k.define("sizeMax",["targetMaxDiff"],function(){return b(this.targetMaxDiff)}),k.define("underMin",["targetMinDiff"],function(){return y(-this.targetMinDiff)}),k.define("overMax",["targetMaxDiff"],function(){return b(-this.targetMaxDiff)}),k.makeId=function(e,t){if(t)return"".concat(e,":").concat(t);if("XLM"===e)return"XLM";throw new Error("Missing issuer for ".concat(e,"."))},k.fromRecord=function(e){var t=k.recordToParams(e);return new k(t)},k.recordToParams=function(e){var t=Object.create(e);return t.code="native"===e.asset_type?"XLM":e.asset_code,t.issuer=e.asset_issuer,t.amount=+e.balance,t.buying=+e.buying_liabilities,t.selling=+e.selling_liabilities,t},e.exports=k},,,,,,,,,,function(e,t,n){"use strict";var r=n(5),i=n(6),a=n(3),o=n(10),s=n(1),c=n(0).timeout,u=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,e),this.domNode=s.create("div",{className:"ClickWall",onclick:function(){return t.click()},hidden:!0}),Object.assign(this.domNode.style,e.style),document.body.insertBefore(this.domNode,document.body.firstChild),this.onclick=n.onclick,this.scrollbar=n.scrollbar,this.opacity=n.opacity,this.delay=n.delay||e.delay}return o(e,[{key:"click",value:function(){this.isEnabled&&this.onclick&&this.onclick()}},{key:"enable",value:function(){var e=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("hide"===this.scrollbar&&(this.htmlOverflow=document.documentElement.style.overflow,this.bodyOverflow=document.body.style.overflow,document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden"),s.show(this.domNode),!this.opacity){e.next=5;break}return e.next=5,this.setOpacity(this.opacity);case 5:this.isEnabled=!0;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"disable",value:function(){var e=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("hide"===this.scrollbar&&(document.documentElement.style.overflow=this.htmlOverflow,document.body.style.overflow=this.bodyOverflow),this.isEnabled=!1,!this.opacity){e.next=5;break}return e.next=5,this.setOpacity(0);case 5:s.hide(this.domNode);case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.disable();case 2:s.destroy(this.domNode);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setOpacity",value:function(){var e=i(r.mark(function e(){var t,n=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:this.opacity,e.next=3,c(0);case 3:return Object.assign(this.domNode.style,{transition:"background ".concat(this.delay,"ms"),background:"rgba(0, 0, 0, ".concat(t,")")}),e.abrupt("return",c(this.delay));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}();u.delay=500,u.style={position:"fixed",zIndex:999,top:0,width:"100%",height:"100%"},e.exports=u},function(e,t,n){"use strict";var r=n(3),i=n(10),a=n(8),o=n(7),s=n(11),c=n(9),u=n(1),l=n(19),h=n(4).__,f=n(54),d=function(e){function t(e){var n;return r(this,t),n=a(this,o(t).call(this)),t.current&&t.current.close(),t.current=s(n),n.domNode=u.create("iframe",{title:"Signing Frame",className:"animated",src:e,sandbox:"allow-same-origin allow-scripts allow-forms allow-popups",hidden:!0}),Object.assign(n.domNode.style,t.style),u.append(document.body,n.domNode),n.show(),n}return c(t,l),i(t,[{key:"show",value:function(){var e=this;if(this.domNode.hidden)return this.domNode.style.animationName="slideInRight",u.show(t.close,this.domNode),t.shadow.enable().then(function(){t.shadow.onclick=function(){return e.close()},t.close.onclick=function(){return e.close()},e.trigger("show")})}},{key:"hide",value:function(){var e=this;if(!this.domNode.hidden)return u.hide(t.close),this.domNode.style.animationName="slideOutRight",t.shadow.disable().then(function(){u.hide(e.domNode),e.trigger("hide")})}},{key:"close",value:function(){var e=this;t.current=null,this.hide().then(function(){u.destroy(e.domNode),e.trigger("close"),e.destroy()})}}]),t}();window.addEventListener("message",function(e){var t=d.current&&d.current.domNode.contentWindow;if(e.source===t)switch(e.data){case"show":d.current.show();break;case"hide":d.current.hide();break;case"close":d.current.close()}}),d.style={position:"fixed",zIndex:1e3,right:0,top:0,width:"30em",maxWidth:"100%",height:"100vh",border:"0.1em solid hsl(240, 10%, 75%)",background:"hsl(240, 40%, 98%)",backgroundImage:"url('./images/cosmic-link.svg')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"12em 12em",padding:0},d.close=u.create("span",{hidden:!0},"Ã— ".concat(h("Close"))),Object.assign(d.close.style,{position:"fixed",zIndex:1001,top:"0.1em",right:"0.1em",color:"hsl(0, 0%, 40%)",fontSize:"0.9em",fontWeight:"bold",cursor:"pointer",background:"hsl(0, 0%, 95%)",borderBottomLeftRadius:"0.1em",padding:"0.1em 0.3em"}),document.body.insertBefore(d.close,document.body.firstChild),d.shadow=new f({scrollbar:"hide",opacity:.3,delay:400}),e.exports=d},function(e,t,n){"use strict";var r=n(45);r.theme={chart:{backgroundColor:"#fefefe",style:{fontFamily:"'Source Sans Pro', arial, sans-serif",color:"#111"}},tooltip:{style:{fontSize:"14px"}},credits:{enabled:!1},plotOptions:{pie:{allowPointSelect:!0,animation:!1,cursor:"pointer",dataLabels:{style:{fontSize:"14px"}}}}},r.setOptions(r.theme),r.pieColors=["rgba(231,  76,  60, 0.8)","rgba(230, 126,  34, 0.8)","rgba(242, 202,  39, 0.8)","rgba(46,  204, 112, 0.8)","rgba(52,  152, 219, 0.8)","rgba(155,  89, 182, 0.8)","rgba(231,  76,  60, 0.6)","rgba(230, 126,  34, 0.6)","rgba(242, 202,  39, 0.6)","rgba(46,  204, 112, 0.6)","rgba(52,  152, 219, 0.6)","rgba(155,  89, 182, 0.6)","rgba(231,  76,  60, 0.4)","rgba(230, 126,  34, 0.4)","rgba(242, 202,  39, 0.4)","rgba(46,  204, 112, 0.4)","rgba(52,  152, 219, 0.4)","rgba(155,  89, 182, 0.4)"],r.pieResponsive={rules:[{condition:{maxWidth:500},chartOptions:{legend:{enabled:!0},plotOptions:{pie:{showInLegend:!0,dataLabels:{format:"{point.percentage:.0f}%",distance:-20}}}}}]}},,,,,,,,,,function(e,t,n){"use strict";var r=n(90),i=n(3),a=n(8),o=n(7),s=n(9),c=n(58),u=n(12),l=function(e){function t(){return i(this,t),a(this,o(t).apply(this,arguments))}return s(t,e),t}(c(Array));l.setCache=function(e,t){var n=JSON.stringify(r({},u.currency,t));localStorage["history:".concat(e)]=n},l.getCache=function(e){var t=localStorage["history:".concat(e)];if(t)return JSON.parse(t)[u.currency]},l.cut=function(e,t){var n=e.length-t;n>0&&e.splice(0,n)},l.latest=function(e){return e[e.length-1]},l.join=function(e,t){var n=t[0].time,r=e.findIndex(function(e){return e.time===n});return e.slice(0,r).concat(t)},l.oneDay=864e5,l.today=function(){return l.roundTime(new Date)},l.roundTime=function(e){var t=new Date(e);return t.setUTCHours(0,0,0,0),+t},l.time=function(e){return+new Date(e)},l.missingDays=function(e){return l.numberToDays(l.today()-l.latest(e).time)},l.numberToDays=function(e){return e/l.oneDay},e.exports=l},function(e,t,n){"use strict";var r=n(5),i=n(6),a=n(3),o=n(8),s=n(7),c=n(10),u=n(9),l=n(35),h=n(13),f=n(28),d=n(0).timeout,p=n(4).__,m=n(31).fixed7,v=e.exports=function(e){function t(e){var n;return a(this,t),n=o(this,s(t).call(this)),e.balance?(n.type="native",n.balance=e.balance,n.base=e.balance.asset,n.quote=e.quote,n.name="".concat(n.base.code,"/").concat(n.quote.code),n.offersCallBuilder=t.offersCallBuilder(n.balance),n.watch(n.quote,"price",function(){return n.updateOffersPrices()})):e.asset&&(n.type="agregated",n.base=e.asset,n.name="".concat(n.base.code," (").concat(p("Agregated"),")"),n.childs=[]),n.watch(n.base,"globalPrice",function(){return n.compute("price")}),n}return u(t,h),c(t,null,[{key:"forBalance",value:function(e,n){if(e.asset!==n){var r=new t({balance:e,quote:n});return r.streamOffers(),r}}},{key:"forAsset",value:function(e){return new t({asset:e})}}]),c(t,[{key:"streamOffers",value:function(){var e=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.getOffers();case 3:return e.next=5,d(15e3);case 5:e.next=0;break;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getOffers",value:function(){var e=i(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.offersCallBuilder.limit(200).call();case 3:t=e.sent,this.ingest(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"ingest",value:function(e){g(this.bids,e.bids)||(this.bids=b(e.bids,this.quote,this.balance,"bids")),g(this.asks,e.asks)||(this.asks=b(e.asks,this.quote,this.balance,"asks"))}},{key:"updateOffersPrices",value:function(){this.bids&&this.set("bids",y(this.bids,this.quote)),this.asks&&this.set("asks",y(this.asks,this.quote))}},{key:"mergeOffers",value:function(e){if(this.childs.length<2)this.set(e,this.childs[0]&&this.childs[0][e]);else{var t=this.childs.reduce(function(t,n){return n[e]?t.concat(n[e]):t},[]);if(t.length){var n="bids"===e?function(e,t){return t.price-e.price}:function(e,t){return e.price-t.price},r=0,i=0,a=0;this.set(e,t.sort(n).map(function(e){var t=Object.assign({},e);return t.volume=r+=m(e.amount*e.price),t.baseVolume=i+=+e.amount,t.quoteVolume=a+=+e.quoteAmount,t}))}else this[e]=null}}},{key:"addChild",value:function(e){var t=this;this.childs.push(e),this.watch(e,"bids",function(){return t.mergeOffers("bids")}),this.watch(e,"asks",function(){return t.mergeOffers("asks")})}}],[{key:"offersCallBuilder",value:function(e){var t=new f.Asset(e.code,e.anchor.pubkey),n=f.Asset.native();return l.resolve.server().orderbook(t,n)}}]),t}();function g(e,t){if(!e)return!1;if(e.length!==t.length)return!1;for(var n in e.length){if(e[n].amount!==t[n].amount)return!1;if(e[n].price!==t[n].price)return!1}return!0}function b(e,t,n,r){return e.forEach(function(e){e.volume=void 0,e.baseVolume=void 0,e.basePrice=+e.price,e.quoteAmount=+e.amount,e.quoteVolume=void 0,e.balance=n,e.side=r}),y(e,t)}function y(e,t){var n=0,r=0,i=0;return e.forEach(function(e){"asks"===e.side?e.quoteAmount=m(e.amount*e.basePrice):e.amount=m(e.quoteAmount/e.basePrice),e.price=m(e.basePrice*t.price),e.volume=n+=m(e.amount*e.price),e.baseVolume=i+=+e.amount,e.quoteVolume=r+=+e.quoteAmount}),e}v.define("bestBid","bids",function(){return this.bids&&this.bids[0]&&this.bids[0].price}),v.define("bestAsk","asks",function(){return this.asks&&this.asks[0]&&this.asks[0].price}),v.define("price",["bestBid","bestAsk"],function(){return this.base.globalPrice?(this.bestBid+this.bestAsk)/2:this.marketPrice()}),v.define("spread",["bestBid","bestAsk"],function(){return this.bestAsk-this.bestBid}),v.define("spread%",["spread","bestAsk"],function(){return 100*this.spread/this.bestAsk}),v.prototype.isFetched=function(){return this.childs?this.childs.reduce(function(e,t){return e&&t.isFetched()},!0):null!=this.asks&&null!=this.bids},v.prototype.findOffer=function(e,t){var n,r=this[e],i=this.childs?this.childs.length:1,a={};for(var o in r){var s=r[o];if(!t||t(s)){var c=s.balance.anchor.pubkey;if(a[c]||(a[c]=!0,n=s),Object.keys(a).length===i)break}}return n},v.prototype.findAsk=function(e){return this.findOffer("asks",e)},v.prototype.findBid=function(e){return this.findOffer("bids",e)},v.prototype.marketPrice=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bids",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=this.findOffer(e,function(e){return e.quoteVolume>t});return n?n.price:0}},function(e,t,n){"use strict";var r=n(3),i=n(8),a=n(7),o=n(11),s=n(10),c=n(9),u=n(60),l=n(0),h=n(13),f=n(32),d=function(e){function t(e,n){var s;return r(this,t),s=i(this,a(t).call(this)),n&&Object.assign(o(s),n),t.table[e]=o(s),s.pubkey=e,s.alias=u.all[e],s.name=l.shorter(s.alias||s.pubkey),s.assets={},s.emit&&s.emit.forEach(function(e){"string"!=typeof e?s.addAsset(e[0],e[1]):s.addAsset(e)}),s}return c(t,h),s(t,null,[{key:"resolve",value:function(e,n){return t.table[e]||new t(e,n)}}]),s(t,[{key:"addAsset",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;this.assets[t]=f.resolve(e),this.assets[t].anchors.push(this)}}]),t}();d.table={},d.register=function(e){for(var t in e)d.resolve(t,e[t])},d.prototype.tetherCode=function(e){for(var t in this.emit){var n=this.emit[t];if(n===e)return e;if(Array.isArray(n)&&n[0]===e)return n[1]}},e.exports=d},,function(e,t,n){"use strict";var r=n(38),i=n(3),a=n(10),o=n(8),s=n(7),c=n(11),u=n(9),l=n(13),h=n(0).setHiddenProperty,f=n(94),d=n(95),p=n(71),m=function(e){function t(){var e;i(this,t),e=o(this,s(t).call(this));for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return r.length&&"FORM"===r[0].tagName?(h(c(e),"domNode",r[0]),r[1]&&Object.assign(e.domNode,r[1])):h(c(e),"domNode",p.element.apply(p,["form"].concat(r))),e.domNode.addEventListener("submit",function(){e.domNode.getAttribute("method")||event.preventDefault(),e.trigger("submit")}),t.bindInputs(c(e),e.domNode),h(c(e),"dom",d(e.domNode)),e.dom.status||(e.dom.status=[t.status()],p.append(e.domNode,e.dom.status[0])),e}return u(t,l),a(t,[{key:"submit",value:function(){this.domNode.submit()}},{key:"reset",value:function(){this.domNode.reset()}},{key:"report",value:function(e){var t=this.dom.status[0];if(t){t.className=e;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];p.rewrite.apply(p,[t].concat(r))}}},{key:"info",value:function(e){this.report("info",e,t.spinner())}},{key:"error",value:function(e){throw this.report("error",e.message||e),e instanceof Error?e:new Error(e)}}]),t}();function v(e,t){e.name&&f(t,e.name,e)}m.listen("change",function(e){return e.report(null)}),m.bindInputs=function(e,t){p.walk(t,v,e)},m.enable=function(e,t){e.disabled=!1,Object.assign(e,t)},m.disable=function(e,t){e.enabled=!0,Object.assign(e,t)},m.hide=p.hide,m.show=p.show,m.element=p.element,m.status=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return m.element("p",{alias:"status"},e)},m.spinner=function(){return m.element("span",{className:"spinner"})},m.label=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.element.apply(m,["label"].concat(t))},m.button=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.length||(n=[e.value]),m.element.apply(m,["button",e].concat(r(n)))},m.control=function(e,t){var n=Object.assign({required:!0},t);return m.element(e,n)},m.textarea=function(e){return m.control("textarea",e)},m.selector=function(e){var t,n=m.control("select",e);if(n.values&&p.append.apply(p,[n].concat(r((t=n.values)instanceof Array?t.map(function(e){return p.element("option",{value:e},e)}):Object.keys(t).map(function(e){return p.element("option",{value:e},t[e])})))),n.placeholder){var i=p.element("option",{value:"",disabled:!0,selected:!0,hidden:!0},n.placeholder);p.unshift(n,i),null!=e.selectedIndex&&e.selectedIndex++}return e.selectedIndex?n.selectedIndex=e.selectedIndex:e.value&&(n.value=e.value),n},m.input=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=m.control("input",t);return n.type=e,n};["checkbox","color","date","email","file","hidden","image","month","number","password","radio","range","tel","text","time","url","week"].forEach(function(e){return m[e]=function(t){return m.input(e,t)}}),m.datetime=function(e){return m.input("datetime-local",e)},e.exports=m},function(e,t,n){"use strict";var r=Object.create(n(1));e.exports=r,r.element=function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return i[0]&&i[0].constructor===Object&&void 0===i[0].domNode&&(t=i.shift()),r.create.apply(r,[e,t].concat(i))},r.walk=function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];t.apply(void 0,[e].concat(i)),e.childNodes.forEach(function(e){return r.walk.apply(r,[e,t].concat(i))})},r.unshift=function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t++)e.insertBefore(t+1<1||arguments.length<=t+1?void 0:arguments[t+1],e.childNodes[t])}},,,,,,,,,,,,function(e,t,n){"use strict";var r=n(5),i=n(6),a=n(3),o=n(8),s=n(7),c=n(11),u=n(10),l=n(9),h=n(47),f=n(35),d=n(33),p=n(13),m=n(0).timeout,v=n(4).__,g=n(32),b=n(44),y=n(12),w=n(91),k=n(92),x=n(31),A=x.arrayContains,T=x.arrayRemove,O=x.arraySum,S=x.arrayOnlyInFirst,E=function(e){function t(e){var n;return a(this,t),n=o(this,s(t).call(this)),console.log(c(n)),n.accountId=e,n.assets=new d,n.balances=new d,n.accountCallBuilder=t.accountCallBuilder(e),n.define("total","assets",function(){var e=n.assets.filter(function(e){return e.isSupported});return O(e,"value")}),n.assets.mirror(function(e){return n.watch(e,["value","isSupported"],function(){return n.compute("total")})}),n.new=!0,n}return l(t,p),u(t,null,[{key:"resolve",value:function(){var e=i(r.mark(function e(n){var i,a;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:return e.next=4,f.resolve.address(n);case 4:if(!(i=e.sent).memo){e.next=7;break}throw new Error(v("Invalid federated address: shared account."));case 7:return e.next=9,f.resolve.isAccountEmpty(i.account_id);case 9:if(!e.sent){e.next=11;break}throw new Error(v("Empty account"));case 11:return a=new t(i.account_id),f.config.source=a.address=n,a.streamAccount(),e.abrupt("return",a);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),u(t,[{key:"streamAccount",value:function(){var e=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.getAccount();case 3:return e.next=5,m(5e3);case 5:e.next=0;break;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getAccount",value:function(){var e=i(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.accountCallBuilder.call();case 3:t=e.sent,this.ingest(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"ingest",value:function(){var e=i(r.mark(function e(t){var n,i;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n in this.account=t,t.balances)i=b.ingest(t.balances[n]),this.maybeAddBalance(i);if(!this.new){e.next=11;break}return delete this.new,e.next=6,g.refreshPrices();case 6:return this.offers=w.forPortfolio(this),e.next=9,this.offers.stream();case 9:this.trigger("open"),g.getAllInfo();case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"maybeAddBalance",value:function(e){A(this.balances,e)||(this.balances.push(e),e.asset.maybeAddBalance(e)),this.maybeAddAsset(e.asset)}},{key:"maybeAddAsset",value:function(e){A(this.assets,e)||(this.assets.push(e),e.watch(this,"total",function(){return e.compute("share")}),e.getInfo())}},{key:"maybeRemoveBalance",value:function(e){T(this.balances,e),e.asset.maybeRemoveBalance(e),this.maybeRemoveAsset(e.asset)}},{key:"maybeRemoveAsset",value:function(e){e.balances.length||T(this.assets,e)}}],[{key:"accountCallBuilder",value:function(e){return f.resolve.server().accounts().accountId(e)}}]),t}();function C(){return I.apply(this,arguments)}function I(){return(I=i(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.resolve.horizon(),e.prev=1,e.next=4,h.get(t);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),new Error(v("Can't connect to the Stellar blockchain"));case 9:case"end":return e.stop()}},e,null,[[1,6]])}))).apply(this,arguments)}E.prototype.availableAssets=function(){var e=Object.values(g.table);return S(e,this.assets)},E.prototype.getHistory=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.history){e.next=4;break}return e.next=3,k(this);case 3:this.history=e.sent;case 4:return e.abrupt("return",this.history);case 5:case"end":return e.stop()}},e,this)})),g.define("share","value",function(){return y.portfolio&&this.value/y.portfolio.total}),e.exports=E},,,,,,function(e,t,n){"use strict";var r=n(5),i=n(6),a=t,o=n(47),s=n(29),c=n(12),u=n(66);function l(e,t){return"crypto"===e.type?a.crypto.history(e,t):"fiat"===e.type?a.fiat.history(e,t):void 0}function h(e,t){return o.get("https://api.coingecko.com/api/v3/".concat(e),{params:t})}function f(e,t){return d.apply(this,arguments)}function d(){return(d=i(r.mark(function e(t,n){var i,a=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(i=a.length>2&&void 0!==a[2]?a[2]:{}).base=c.currency,"string"==typeof n?i.symbols=n:("EUR"===c.currency&&(n=n.filter(function(e){return"EUR"!==e})),i.symbols=n.join(",")),i.source="equilibre.io",e.abrupt("return",o.get("https://api.exchangeratesapi.io/".concat(t),{params:i}).then(function(e){return"EUR"!==c.currency||e.data.start_at||(e.data.rates.EUR=1),e}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}a.assetHistory=function(){var e=i(r.mark(function e(t){var n,i,a,o,s,c=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]?c[1]:1e3,delete localStorage["prices.".concat(t.code)],!(i=u.getCache(t.id))){e.next=8;break}if(a=u.missingDays(i)){e.next=7;break}return e.abrupt("return",i);case 7:i.length&&(n=a+3);case 8:return e.next=10,l(t,n);case 10:if(o=e.sent){e.next=13;break}return e.abrupt("return");case 13:return s=i?u.join(i,o):o,u.cut(s,1e3),u.setCache(t.id,s),e.abrupt("return",s);case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.crypto={},a.crypto.list=i(r.mark(function e(){var t,n;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("coins/list");case 2:return t=e.sent,n={},t.data.forEach(function(e){var t=e.symbol.toUpperCase();n[t]={apiId:e.id,name:e.name}}),e.abrupt("return",n);case 6:case"end":return e.stop()}},e)})),a.crypto.stellarNative=i(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("exchanges/stellar_term");case 2:return t=e.sent,e.abrupt("return",t.data.tickers.map(function(e){return e.coin_id}).filter(function(e){return e}));case 4:case"end":return e.stop()}},e)})),a.crypto.info=function(){var e=i(r.mark(function e(t){var n;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h("coins/".concat(t.apiId),{localization:!1,tickers:!1,market_data:!1,community_data:!1,developer_data:!1,sparkline:!1});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.crypto.prices=function(){var e=i(r.mark(function e(t){var n,i,a,o;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(function(e){return e.apiId}).join(","),i=c.currency.toLowerCase(),e.next=4,h("simple/price",{ids:n,vs_currencies:i});case 4:return a=e.sent,o={},t.forEach(function(e){var t=a.data[e.apiId];t&&(o[e.code]=t[i])}),e.abrupt("return",o);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.crypto.history=function(){var e=i(r.mark(function e(t){var n,i,a,o,l=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:1e3,e.next=3,h("coins/".concat(t.apiId,"/market_chart"),{vs_currency:c.currency,days:Math.max(n,100)});case 3:return i=e.sent,a=i.data.prices.map(function(e,t){return{time:e[0],price:e[1],volume:+s(i.data.total_volumes[t][1]/e[1])}}),o=u.today(),a[a.length-2].time===o?a.length=a.length-1:u.latest(a).time=o,n<100&&u.cut(a,n),e.abrupt("return",a);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fiat={},a.fiat.prices=function(){var e=i(r.mark(function e(t){var n,i,a,o;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(function(e){return e.code}),e.next=3,f("latest",n);case 3:for(o in i=e.sent,a=i.data.rates)a[o]=s(1/a[o],8);return e.abrupt("return",a);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.fiat.history=function(){var e=i(r.mark(function e(t){var n,i,a,o,l,h,d=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:1e3,i=(new Date).toISOString().slice(0,10),(a=new Date(i)).setDate(a.getDate()-n),o=a.toISOString().slice(0,10),"EUR"!==c.currency||"EUR"!==t.id){e.next=7;break}return e.abrupt("return",[{time:u.today(),price:1}]);case 7:return e.next=9,f("history",t.code,{start_at:o,end_at:i});case 9:return l=e.sent,h=Object.keys(l.data.rates).sort().map(function(e){return{time:u.time(e),price:+s(1/l.data.rates[e][t.code],8)}}),u.latest(h).time!==u.today()&&h.push({time:u.today(),price:u.latest(h).price}),e.abrupt("return",h);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},,function(e,t,n){"use strict";var r=n(11),i=n(38),a=n(5),o=n(6),s=n(3),c=n(10),u=n(8),l=n(7),h=n(9),f=n(35),d=n(69),p=n(33),m=n(13),v=n(0).setHiddenProperty,g=n(0).day,b=n(32),y=n(44),w=n(31).fixed7,k=function(e){function t(){return s(this,t),u(this,l(t).apply(this,arguments))}return h(t,p),c(t,[{key:"stream",value:function(){var e=o(a.mark(function e(){var t,n=this,r=arguments;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:15e3,e.abrupt("return",this.get().then(function(){return setTimeout(function(){return n.stream()},t)}));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=o(a.mark(function e(){var t;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d(this.callBuilder,{limit:200});case 3:t=e.sent,this.ingest(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"ingest",value:function(e){this.forEach(function(e){return e.alive=!1});var t=e.map(function(e){return x.ingest(e)}).filter(function(e){return e});this.splice.apply(this,[0,0].concat(i(t))),this.clean()}},{key:"clean",value:function(){for(var e=this.length-1;e>-1;e--){var t=this[e];t.alive||(this.splice(e,1),t.destroy())}}}],[{key:"forPortfolio",value:function(e){var n=t.forAccount(e.accountId);return v(n,"portfolio",e),n}},{key:"forAccount",value:function(e){var n=new t;return v(n,"accountId",e),v(n,"callBuilder",t.callBuilder(e)),n}},{key:"callBuilder",value:function(e){return f.resolve.server().offers("accounts",e)}}]),t}();k.prototype.listOutdated=function(){return this.filter(function(e){return e.outdated})};var x=function(e){function t(e){var n;s(this,t),(n=u(this,l(t).call(this))).intern=A(e),t.table[n.intern]=r(n);var i=b.resolve("XLM"),a=e.buying.asset_code?e.buying:e.selling;return n.balance=y.resolve(a.asset_code,a.asset_issuer),n.asset=n.balance.asset,n.side=e.buying.asset_code?"buy":"sell",n.define("price","rawPrice","sell"===n.side?function(){return i.price*n.rawPrice}:function(){return i.price/n.rawPrice}),n.watch(i,"price",function(){return n.compute("price")}),n.update(e),n.balance.offers.push(r(n)),n.asset.offers.push(r(n)),n.listen("destroy",function(){delete t.table[n.intern],n.balance.offers.splice(n.balance.offers.indexOf(r(n)),1),n.asset.offers.splice(n.asset.offers.indexOf(r(n)),1)}),n}return h(t,m),c(t,null,[{key:"resolve",value:function(e){return t.table[A(e)]}},{key:"ingest",value:function(e){var n=t.resolve(e);if(!n)return new t(e);n.update(e)}}]),c(t,[{key:"update",value:function(e){Object.assign(this,e),this.alive=!0,this.rawPrice=e.price,this.compute("price"),this.rawAmount=e.amount,"buy"===this.side&&(this.amount=w(this.rawAmount*this.rawPrice)),this.date=g(this.last_modified_time),this.outdated=this.date!==g()}}]),t}();function A(e){return"".concat(e.id,"-").concat(e.last_modified_ledger)}x.table={},e.exports=k},function(e,t,n){"use strict";var r=n(5),i=n(6),a=n(32),o=n(93),s=n(31).arraySum;function c(e){var t={};e.forEach(function(e){Object.keys(e.asset).forEach(function(e){return t[e]=!0})});var n=Object.keys(t).map(a.resolve);return n.forEach(function(e){return e.hasBeenHeld=!0}),n}function u(e){return l.apply(this,arguments)}function l(){return(l=i(r.mark(function e(t){var n,i;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={},i=t.map(function(e){return e.getHistoricPrice()}),e.next=4,Promise.all(i);case 4:return t.forEach(function(e){e.historicPrice&&(n[e.id]=e.historicPrice)}),e.abrupt("return",n);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(e,t){for(var n in t){var r=t[n],i=r.findIndex(function(t){return t.time>e});i>1?t[n]=r.slice(i-1):-1===i&&(t[n]=r.slice(-1))}}function f(e,t){for(var n in e.price={},e.value={},e.total=0,e.asset)e.price[n]=t[n]?t[n][0].price:0,e.value[n]=e.asset[n]*e.price[n],e.total+=e.value[n];e.filtered={};var r=[];for(var i in e.value){var a=e.value[i]/e.total;a&&(e.filtered[i]=e.value[i],a<.03&&r.push(i))}r.length>1&&(e.filtered.others=s(r.map(function(t){return e.value[t]})),r.forEach(function(t){return delete e.filtered[t]}))}e.exports=function(){var e=i(r.mark(function e(t){var n,i,a;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(t);case 2:return n=e.sent,i=c(n),e.next=6,u(i);case 6:return a=e.sent,n.forEach(function(e){h(e.time,a),f(e,a)}),console.log(n),e.abrupt("return",n);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";var r=n(5),i=n(6),a=n(35),o=n(69),s=n(32),c=n(44),u=n(66),l=n(31).fixed7;function h(e){return f.apply(this,arguments)}function f(){return(f=i(r.mark(function e(t){var n,i,s,c,l=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:100,i={time:u.today(),asset:{},balance:{}},t.balances.forEach(function(e){m(i,e,+e.amount)}),s=[i],c=Date.now()-u.oneDay*n,e.next=7,r=t.accountId,f=void 0,p=void 0,v=void 0,g=void 0,f=(h={filter:function(e){return d(s,e)},breaker:function(){return s[0].time<c}}).filter,p=h.breaker,v=a.resolve.server(),g=v.effects().forAccount(r).order("desc"),o(g,{filter:f,breaker:p});case 7:return u.cut(s,n),e.abrupt("return",s);case 9:case"end":return e.stop()}var r,h,f,p,v,g},e)}))).apply(this,arguments)}function d(e,t){for(var n=e[0],r=u.roundTime(t.created_at)-u.oneDay;r!==n.time;)(n={time:n.time-u.oneDay,asset:Object.assign({},n.asset),balance:Object.assign({},n.balance)}).time===w&&k(n),e.unshift(n);var i=p[t.type];i&&i(n,t)}e.exports=function(){var e=i(r.mark(function e(t){var n,i,a,o,s,c=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=c.length>1&&void 0!==c[1]?c[1]:1e3,!(i=u.getCache(t.account.id))){e.next=7;break}if(a=u.missingDays(i)){e.next=6;break}return e.abrupt("return",i);case 6:i.length&&(n=a+1);case 7:return e.next=9,h(t,n);case 9:if(o=e.sent){e.next=12;break}return e.abrupt("return");case 12:return s=i?u.join(i,o):o,u.cut(s,1e3),u.setCache(t.account.id,s),e.abrupt("return",s);case 16:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();var p={};function m(e,t,n){v(e.balance,t.id,n);var r=x(t,e);v(e.asset,r.id,n)}function v(e,t,n){e[t]||(e[t]=0),e[t]=Math.max(0,l(e[t]+n))}function g(e,t){var n=t?"".concat(t,"_asset_code"):"asset_code",r=t?"".concat(t,"_asset_issuer"):"asset_issuer";return e[n]?c.resolve(e[n],e[r]):c.resolve("XLM")}p.trade=function(e,t){m(e,g(t,"bought"),-t.bought_amount),m(e,g(t,"sold"),+t.sold_amount)},p.account_credited=function(e,t){m(e,g(t),-t.amount)},p.account_debited=function(e,t){m(e,g(t),+t.amount)},p.trustline_removed=function(e,t){m(e,g(t),0)},p.trustline_created=function(e,t){var n=g(t);0!==e.balance[n.id]&&console.error("Balances mismatch: ",e.balance[n.id],t),delete e.balance[n.id];var r=x(n,e);0===e.asset[r.id]&&delete e.asset[r.id]},p.account_created=function(e){e.balance.XLM=0,e.asset.XLM=0};var b="GBSTRH4QOTWNSVA6E4HFERETX4ZLSR3CIUBLK7AXYII277PFJC4BBYOG",y="GBSTRUSD7IRX73RQZBL3RQUH6KS3O4NYFY3QCALDLZD77XMZOPWAVTUK",w=15565824e5;function k(e){for(var t in e.asset){var n=t.substr(-56);if(n===b||n===y){var r=t.split(":")[0];v(e.asset,r,e.asset[t]),delete e.asset[t]}}}function x(e,t){if(e.asset.id.length<60)return e.asset;if(t.time>w)return e.asset;switch(e.anchor.pubkey){case b:case y:return s.table[e.code]||e.asset}return e.asset}},function(e,t,n){"use strict";var r=n(13);e.exports=function(e,t,n,r){var a=i[n.tagName];a?a(e,t,n,r):e[t]=n[r||"value"]};var i={};function a(e,t,n,i,a){i.addEventListener(e,function(){t[n]=i[a],i.setCustomValidity("")}),t instanceof r&&t.link(n,i,a,null,{init:!1})}i.SELECT=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"value";e[t]=n[r],-1!==i.SELECT.interactive.indexOf(r)&&a("change",e,t,n,r)},i.SELECT.interactive=["selectedIndex","selectedOptions","value"],i.TEXTAREA=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"value";e[t]=n[r],"value"===r&&a("input",e,t,n,r)},i.INPUT=function(e,t,n,r){e[t]=n[r],"radio"===n.type?i.radio.apply(i,arguments):"checkbox"===n.type?i.checkbox.apply(i,arguments):r&&"value"!==r||a("input",e,t,n,r||"value")},i.radio=function(e,t,n){var r=function(){n.checked&&(e[t]=n.value)};n.addEventListener("change",r),r()},i.checkBox=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"checked";e[t]=n[r],"checked"===r&&a("change",e,t,n,r)}},function(e,t,n){"use strict";var r=n(0).timeout,i=n(71);function a(e,t){!function(e,t){e.className?(t[e.className]||(t[e.className]=[]),t[e.className].push(e)):e.alias?(t[e.alias]=e,delete t[e.alias]):e.name?t[e.name]=e:e.id&&(t[e.id]=e)}(e,t),function(e){if(!e.label||"OPTION"===e.tagName)return;var t=i.element("label",{for:e}),n=i.element("span",e.label);i.replace(e,t),i.append(t,n,e),delete e.label}(e),function(e){var t=e.validate;if(!t||!e.hasProperty("oninput"))return;e.addEventListener("input",function(){e.setCustomValidity(""),r(0).then(function(){return function(e,t){try{t(e.value)}catch(t){e.setCustomValidity(t.message),e.reportValidity(),console.error(t)}}(e,t)})}),delete e.validate}(e)}e.exports=function(e){var t={};return i.walk(e,a,t),t}},function(e,t,n){"use strict";t.isOverflowing=function(e){return e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth}},function(e,t,n){"use strict";var r=n(3),i=n(8),a=n(7),o=n(9),s=n(27),c=n(4).__,u=n(98),l=n(12);e.exports=function(e){function t(e){var n;return r(this,t),(n=i(this,a(t).call(this,'\n<section class="ActivityGui">\n  <h2>'.concat(c("Activity"),'</h2>\n\n  %table\n\n  <p class="note">\n    ').concat(c("All orders are passed against Stellar Lumens (XLM)."),"\n    ").concat(c("For your comfort, prices are displayed in their %%globalCurrency equivalent."),"\n    ").concat(c("However, those converted values will change according to XLM price movement."),"\n  </p>\n\n</section>\n    ")))).portfolio=e,n.table=new u(e),n.globalCurrency=l.currency,n}return o(t,s),t}()},function(e,t,n){"use strict";var r=n(11),i=n(3),a=n(10),o=n(8),s=n(7),c=n(9),u=n(27),l=n(29),h=n(35).CosmicLink,f=n(4).__,d=n(55),p=n(12);e.exports=function(e){function t(e){var n;return i(this,t),(n=o(this,s(t).call(this,'\n<section class="ActiveOffersTable">\n  <table>\n    <tr>\n      <th class="name">'.concat(f("Name"),'</th>\n      <th align="left">').concat(f("Anchor"),'</th>\n      <th align="left">').concat(f("Direction"),'</th>\n      <th align="right">').concat(f("Amount"),'</th>\n      <th align="right">').concat(f("Price"),' (%globalCurrency)</th>\n    </tr>\n    %toOfferRow:offers...\n    <tr><td colspan="5" align="center" onclick=%cancelOffers>\n      <h3>').concat(f("Cancel All"),"</h3>\n    </td></tr>\n  </table>\n</section>\n    ")))).portfolio=e,n.offers=e.offers,n.globalCurrency=p.currency,n}return c(t,u),a(t,[{key:"toOfferRow",value:function(e){return new m(e)}},{key:"cancelOffers",value:function(){var e=this;if(this.offers.length){var t={memo:"Equilibre.io",network:"public",maxTime:"+5",source:this.portfolio.accountId},n=new h(t);this.offers.forEach(function(e){n.addOperation("manageOffer",{offerId:e.id,amount:0})}),new d(n.uri).listen("destroy",function(){e.portfolio.getAccount(),e.portfolio.offers.get()})}}}]),t}();var m=function(e){function t(e){var n;return i(this,t),(n=o(this,s(t).call(this,'\n<tr>\n  <td>\n    <img src=%image alt="">\n    <span>%name</span>\n  </td>\n  <td>%anchor</td>\n  <td>%side</td>\n  <td align="right">%nice:amount</td>\n  <td align="right">%nice:price</td>\n</tr>\n    '))).offer=e,e.project(["amount","price"],r(n)),n.name=e.balance.code,n.side="buy"===e.side?f("Buy"):f("Sell"),n.anchor=e.balance.anchor.name,e.asset.link("image",r(n)),n}return c(t,u),a(t,[{key:"nice",value:function(e){return l(e)}}]),t}()},function(e,t,n){"use strict";var r=n(3),i=n(10),a=n(8),o=n(7),s=n(11),c=n(9),u=n(27),l=n(29),h=n(57),f=n(4).__,d=n(100),p=n(101),m=n(102),v=n(103),g=n(12);e.exports=function(e){function t(e){var n;r(this,t),(n=a(this,o(t).call(this,"\n<section><h2>".concat(f("Portfolio"),': %total %currency</h2>\n\n  %nav\n  <section>%view</section>\n\n  %priceChart\n\n  <p class="note">\n    ').concat(f("Anchor prices are from Stellar DEX")," /\n    ").concat(f("Global prices are from %%coingecko when available."),"\n  </p>\n\n</section>")))).portfolio=e,e.project("total",s(n),function(e){return l(e,2)}),n.currency=g.currency,n.coingecko=new u('<a target="_blank" rel="noopener" href="https://coingecko.com">coingecko</a>'),n.table=new v(e),n.project("selected",n.table),n.table.project("selected",s(n)),n.pieChart=new p(e),n.project("selected",n.pieChart),n.pieChart.project("selected",s(n)),n.trap("selected",function(){return n.maybeDrawPriceChart()}),n.historyChart=new m(e);var i=n.overview=new h;return i.add("table",f("Balances"),n.table),i.add("chart",f("Repartition"),n.pieChart),i.add("history",f("History"),n.historyChart),i.project(["nav","view"],s(n)),i.listen("select",function(){return n.reflow()}),i.listen("select",function(e){return localStorage["PortfolioSummary.tab"]=e}),i.select(localStorage["PortfolioSummary.tab"]),i.selected||i.select("table"),n}return c(t,u),i(t,[{key:"reflow",value:function(){if(this.overview.selected){var e=this.overview.selected.content;e.reflow&&e.reflow()}}},{key:"maybeDrawPriceChart",value:function(){this.priceChart&&this.priceChart.destroy();var e=this.selected;e&&(e.isTether||e.apiId)&&e.code!==g.currency?this.priceChart=new d(e):this.priceChart=null}}]),t}()},function(e,t,n){"use strict";var r=n(3),i=n(10),a=n(8),o=n(7),s=n(9),c=n(45);n(56);var u=n(27),l=n(29),h=n(4).__,f=n(12);e.exports=function(e){function t(e){var n;return r(this,t),(n=a(this,o(t).call(this,"\n      <section><h3>".concat(e.code," ").concat(h("to")," ").concat(f.currency,"</h3>\n        <div -ref=%container><p>").concat(h("Loading..."),"</p></div>\n      </section>\n    ")))).asset=e,e.getHistoricPrice().then(function(e){return n.drawChart(e)}),n.listen("destroy",function(){return n.chart&&n.chart.destroy()}),n}return s(t,u),i(t,[{key:"drawChart",value:function(e){this.chart=c.stockChart(this.container,{rangeSelector:{selected:2},yAxis:[{labels:{align:"left"},height:"80%",resize:{enabled:!0}},{labels:{align:"left"},top:"80%",height:"20%",offset:0}],series:[{type:"spline",name:"Price",data:e.map(function(e){return[e.time,+l(e.price)]})},{type:"column",name:"Volume",data:e.map(function(e){return[e.time,e.volume]}),yAxis:1}]})}}]),t}()},function(e,t,n){"use strict";var r=n(3),i=n(10),a=n(8),o=n(7),s=n(9),c=n(45);n(56);var u=n(27),l=n(29),h=n(4).__,f=n(12);function d(e){return{name:e.name,code:e.code,asset:e,y:+l(e.value,2),amount:l(e.amount),price:l(e.price),percentage:e.percentage}}e.exports=function(e){function t(e){var n;return r(this,t),(n=a(this,o(t).call(this,'<div -ref=%container align="center"></div>'))).portfolio=e,n.watch(n.portfolio,"total",function(){return n.draw()}),n.listen("destroy",function(){return n.chart&&n.chart.destroy()}),n}return s(t,u),i(t,[{key:"reflow",value:function(){this.chart&&this.chart.reflow()}},{key:"draw",value:function(){var e=this;this.chart&&this.chart.destroy(),this.chart=c.chart(this.container,{colors:c.pieColors,responsive:c.pieResponsive,title:"",legend:{enabled:!1},chart:{type:"pie"},tooltip:{pointFormat:"\n".concat(h("Amount"),": {point.amount} {point.code}<br>\n").concat(h("Price"),": {point.price} ").concat(f.currency,"<br>\n<b>").concat(h("Value"),": {point.y} ").concat(f.currency,"</b>\n")},plotOptions:{pie:{dataLabels:{format:"{point.amount} {point.code}<br>({point.percentage:.0f}%)"},point:{events:{select:function(t){return e.selected=t.target.options.asset},legendItemClick:function(){return!1}}}}},series:[{name:h("Amount"),colorByPoint:!0,ignoreHiddenPoint:!0,data:this.portfolio.assets.filter(function(e){return e.value}).map(d).sort(function(e,t){return t.y-e.y})}]})}}]),t}()},function(e,t,n){"use strict";var r=n(3),i=n(10),a=n(8),o=n(7),s=n(9),c=n(45);n(56);var u=n(27),l=n(29),h=n(4).__,f=n(32),d=n(12);e.exports=function(e){function t(e){var n;return r(this,t),(n=a(this,o(t).call(this,'\n<div class="PortfolioHistoryChart">\n  <h3>Computing Portfolio History...<span class="spinner"></span></h3>\n</div>\n    '))).portfolio=e,n.portfolio.getHistory().then(function(e){return n.drawChart(e)}),n.listen("destroy",function(){return n.chart&&n.chart.destroy()}),n}return s(t,u),i(t,[{key:"reflow",value:function(){var e=this;this.chart&&(this.hasBeenReflown||setTimeout(function(){return e.chart.update({rangeSelector:{enabled:!0}})}),this.chart.reflow()),this.hasBeenReflown=!0}},{key:"drawChart",value:function(e){var t=this.historyToSeries(e);this.chart=c.stockChart(this.domNode,{chart:{type:"area"},rangeSelector:{selected:2},navigator:{series:{data:e.map(function(e){return[e.time,+l(e.total)||null]})}},tooltip:{shared:!0,split:!1,pointFormat:'\n<span style="color:{point.color}">â—</span>\n{series.name}: {point.percentage:.0f}%\n<br>',footerFormat:"<b>Total: {point.total} ".concat(d.currency,"</b>")},yAxis:[{labels:{align:"left",formatter:function(){return"".concat(this.value," ").concat(d.currency)}},resize:{enabled:!0}}],plotOptions:{series:{},area:{stacking:"normal",connectNulls:!0,lineWidth:0,states:{hover:{enabled:!1},inactive:{enabled:!1}}}},series:t,colors:c.pieColors}),this.hasBeenReflown||this.chart.update({rangeSelector:{enabled:!1}})}},{key:"historyToSeries",value:function(e){var t=[],n=Object.values(f.table).filter(function(e){return e.hasBeenHeld});return n.sort(function(e,t){return t.value-e.value}),n.forEach(function(n){var r=!0,i=e.map(function(e){var t=+l(e.filtered[n.id],2)||null;return t&&(r=!1),[e.time,t]});r||t.push({name:n.id,data:i})}),t.push({name:h("Others"),color:"#DDD",data:e.map(function(e){return[e.time,+l(e.filtered.others,2)]})}),t}}]),t}()},function(e,t,n){"use strict";var r=n(11),i=n(3),a=n(10),o=n(8),s=n(7),c=n(9),u=n(27),l=n(1),h=n(29),f=n(4).__;e.exports=function(e){function t(e){var n;return i(this,t),(n=o(this,s(t).call(this,'\n<table class="PortfolioTable">\n  <tr>\n    <th class="name">'.concat(f("Name"),'</th>\n    <th align="left">').concat(f("Anchor"),'</th>\n    <th align="right">').concat(f("Amount"),'</th>\n    <th align="right">').concat(f("Price"),'</th>\n    <th align="right">').concat(f("Value"),"</th>\n  </tr>\n  %rows...\n</table>\n")))).portfolio=e,n.rows=e.assets.mirror(function(e){return n.toAssetRow(e)}),n.watch(e,"total",function(){return n.sort()}),n.trap("selected",function(){return n.onselect(n.selected)}),n}return c(t,u),a(t,[{key:"toAssetRow",value:function(e){var t=this,n=new d(e);return n.domNode.onclick=function(){t.selected===n.asset?t.selected=null:t.selected=n.asset},n}},{key:"sort",value:function(){this.rows.sort(function(e,t){return t.asset.value-e.asset.value})}},{key:"onselect",value:function(e){this.selectedRow&&this.selectedRow.simpleView(),this.selectedRow=this.rows.find(function(t){return t.asset===e}),this.selectedRow&&this.selectedRow.detailledView()}}]),t}();var d=function(e){function t(e){var n;i(this,t),(n=o(this,s(t).call(this,'\n<tr %class>\n  <td align="left">\n    <img src=%image alt="">\n    <span>%name</span>\n  </td>\n  <td align="left">\n    <div hidden=%simple>%anchors...</div>\n    <div class=%mode>%anchorTotal</div>\n  </td>\n  <td align="right">\n    <div hidden=%simple>%amounts...</div>\n    <div class=%mode>%amountTotal</div>\n  </td>\n  <td align="right">\n    <div hidden=%simple>%prices...</div>\n    <div class=%mode title=%priceDetails>%priceTotal</div>\n  </td>\n  <td align="right">\n    <div hidden=%simple>%values...</div>\n    <div class=%mode>%valueTotal</div>\n  </td>\n</tr>\n    '))).asset=e,n.name=e.code,n.anchors=e.balances.mirror(function(e){return m(e.anchor,"name")}),n.amounts=e.balances.mirror(function(e){return m(e,"amount",h)}),n.prices=e.balances.mirror(function(e){return n=m(t=e,"price",h),t.trap("orderbook",function(){t.orderbook&&t.orderbook.trap(["bestAsk","bestBid","spread%"],function(){n.title=v(t.orderbook)})}),n;var t,n}),n.values=e.balances.mirror(function(e){return m(e,"value",function(e){return h(e,2)})}),e.link("image",r(n)),e.link("amount",r(n),"amountTotal",h),e.link("price",r(n),"priceTotal",h),e.link("value",r(n),"valueTotal",function(e){return h(e,2)}),e.balances.feed(r(n),"anchorHeader",p);var a=n.asset.orderbook;return n.define("priceDetails","orderbook",function(){return v(a)}),n.watch(a,["bestAsk","bestBid","spread%"],function(){n.compute("priceDetails")}),n.simpleView(),n}return c(t,u),a(t,[{key:"simpleView",value:function(){this.simple=!0,this.class="",this.mode="",this.anchorTotal=this.anchorHeader}},{key:"detailledView",value:function(){this.simple=!1,this.class="selected",this.mode="footer",this.anchorTotal="Total"}}]),t}();function p(e){return 1===e.length?e[0].anchor.name:"".concat(f("multiple")," (").concat(e.length,")")}function m(e,t,n){var r=l.create("div",null,e[t]);return e.link(t,r,"textContent",n),r}function v(e){return"XLM"===e.base.code?"":"\nBuy: ".concat(h(e.bestBid)," - Sell: ").concat(h(e.bestAsk)," - Spread: ").concat(h(e["spread%"],2),"%\n  ")}},function(e,t,n){"use strict";var r=n(11),i=n(3),a=n(8),o=n(7),s=n(9),c=n(27),u=n(4).__,l=n(70),h=n(12),f={us:"English",fr:"FranÃ§ais"},d=["AUD","BRL","CAD","CHF","CNY","CZK","DKK","EUR","GBP","HKD","HUF","IDR","ILS","INR","JPY","KRW","MXN","MYR","NOK","NZD","PHP","PLN","RUB","SEK","SGD","THB","TRY","USD","ZAR"],p=function(e){function t(){var e;return i(this,t),(e=a(this,o(t).call(this,"\n      <section><h2>".concat(u("Settings"),"</h2>\n        <section><h3>").concat(u("General Settings"),"</h3>\n          <hr>\n          %general\n        </section>\n      </section>\n    ")))).general=new m(h),e}return s(t,c),t}(),m=function(e){function t(e){var n;return i(this,t),n=a(this,o(t).call(this,l.selector({label:u("Language"),name:"language",values:f}),l.selector({label:u("Currency"),name:"currency",values:d}))),e.project(["currency","language"],r(n)),n.project(["currency","language"],e),n.listen("change",function(){return location.reload()}),n}return s(t,l),t}();e.exports=p},function(e,t,n){"use strict";var r=n(3),i=n(8),a=n(7),o=n(11),s=n(9),c=n(27),u=n(4).__,l=n(106),h=n(109),f=n(112),d=n(113);e.exports=function(e){function t(e){var n;r(this,t),(n=i(this,a(t).call(this,'\n<section class="RebalanceGui">\n  <h2>'.concat(u("Rebalance"),"</h2>\n\n  %table\n\n  %controls\n\n</section>\n    ")))).portfolio=e;var s="target:".concat(e.account.id),c=localStorage[s];return n.target=l.forPortfolio(e,c),n.target.link("json",localStorage,s,null,{init:!1}),n.target.json=n.target.toJson(),n.table=new d(n.target),n.table.project("selected",o(n)),n.project("selected",n.table),n.trap("selected",function(){n.controls&&n.controls.destroy(),n.selected?(n.controls=new h(n.selected),n.controls.listen("close",function(){return n.selected=null})):n.controls=new f(n.target)}),n}return s(t,c),t}()},function(e,t,n){"use strict";var r=n(38),i=n(3),a=n(10),o=n(8),s=n(7),c=n(11),u=n(9),l=n(33),h=n(13),f=n(32),d=n(44),p=n(107),m=n(108),v=n(31),g=v.arrayContains,b=v.arrayRemove,y=v.arraySum,w=v.fixed7,k=v.positive,x=function(e){function t(e){var n;return i(this,t),n=o(this,s(t).call(this)),e?(n.asset=e,n.mode="ignore",n.order=p.rebalance(c(n)),e.target=c(n),n.watch(e,"value",function(){return n.compute("valueDiff")}),n.watch(e,"price",function(){!n.asset.amount&&n.size&&n.computeAll()}),n.opening=[],n.closing=[],"XLM"===e.id&&(n.mode="weight",n.size=1)):(n.childs=new l,n.childs.listen("add",function(e){return e.parent=c(n)}),n.childs.listen("change",function(){return n.computeAll()})),n.trap("size",function(){n.size&&(n.size=k(n.size),"percentage"===n.mode&&(n.size=Math.min(100,n.size))),n.computeAll()}),n}return u(t,h),a(t,[{key:"root",get:function(){return this.parent?this.parent.root:this}}]),t}();x.define("name",["group","asset"],function(){return this.group||this.asset.id}),x.define("modified",["json"],function(){return this.hasChanged()}),x.define("valueDiff",["value","asset"],function(){return this.asset&&this.asset.value-this.value}),x.define("valueDiffP","valueDiff",function(){return this.value?this.valueDiff/this.value:null}),x.define("amountDiff",["amount"],function(){return w(this.amount-this.asset.amount)}),x.define("amountDelta",["amountDiff"],function(){return Math.abs(this.amountDiff)}),x.define("share",null,function(){return this.value/this.root.portfolio.total}),x.define("shareDiff",["share"],function(){return this.asset.share-this.share}),x.prototype.computeAll=function(){if(this.parent)this.root.computeAll();else if(this.portfolio&&this.portfolio.total){try{this.error=null,this.value=this.portfolio.total,this.compute("modified"),m.apply(this)}catch(e){this.error=e.message,console.error(e)}this.trigger("update")}},x.prototype.addAsset=function(e){if(!this.childs)throw new Error("Target is not a group: ",t);if(e.target)throw new Error("Asset already has a target: ",e);var t=new x(e);return t.parent=this,e.anchors.forEach(function(e){return t.addAnchor(e)}),this.childs.push(t),t.mode="weight",t.size=1,t},x.prototype.addAnchor=function(e){var t=e.tetherCode(this.asset.code),n=e.pubkey,r=d.resolve(t,n);"closing"===r.action?(b(this.closing,n),r.action=null):(this.root.portfolio.maybeAddBalance(r),this.opening.push(n),r.action="opening"),this.root.compute("modified"),this.order.refresh()},x.prototype.removeAnchor=function(e){var t=e.tetherCode(this.asset.code),n=e.pubkey,r=d.resolve(t,n);"opening"===r.action?(this.root.portfolio.maybeRemoveBalance(r),b(this.opening,n),r.action=null):(this.closing.push(n),r.action="closing"),this.root.compute("modified"),this.order.refresh()},x.sortChilds=function(e){return e.childs.slice().sort(function(e,t){return e.name.localeCompare(t.name)})},x.forPortfolio=function(e,t){var n=t?x.fromJson(t):new x;return n.portfolio=e,e.target=n,n.watch(e,"total",function(){return n.computeAll()}),e.assets.forEach(function(e){!n.childs.find(function(t){return e===t.asset})&&e.isSupported&&n.childs.push(new x(e))}),n.childs.forEach(function(t,r){e.assets.find(function(e){return e===t.asset})&&t.asset.isSupported||n.childs.splice(r,1)}),e.assets.listen("add",function(e){e.isValid&&n.childs.push(new x(e))}),e.assets.listen("remove",function(e){var t=n.childs.findIndex(function(t){return t.asset===e});n.childs.splice(t,1)}),n},x.fromJson=function(e){var t=JSON.parse(e),n=x.fromObject(t);return n.json=e,n},x.prototype.toJson=function(e){var t=this.toObject();return JSON.stringify(t,null,e&&2)},x.prototype.hasChanged=function(){return this.toJson()!==(this.json||'{"childs":[]}')},x.fromObject=function(e){"string"==typeof e&&(e={asset:e});var t=e.asset&&f.resolve(e.asset),n=new x(t);if(n.size=e.size,n.mode=e.mode,"equal"===n.mode&&(n.mode="weight"),"skip"===n.mode&&(n.mode="ignore"),n.asset&&"XLM"===n.asset.id&&"ignore"===n.mode&&(n.mode="weight",n.size=1),n.mode||(n.mode="weight"),null==n.size&&"weight"===n.mode&&(n.size=1),e.childs){var i;n.group=e.group;var a=e.childs.map(function(e){return x.fromObject(e)}),o=a.filter(function(e){return"percentage"===e.mode});o.length&&!a.find(function(e){return"weight"===e.mode})&&100!==y(o,"size")&&o.forEach(function(e){return e.mode="weight"}),(i=n.childs).push.apply(i,r(a))}else{var s=n.asset.balances;e.opening&&(n.opening=e.opening),e.closing&&(n.closing=e.closing),s.forEach(function(e){var t=e.anchor.pubkey;g(n.closing,t)?e.action="closing":b(n.opening,t)}),n.closing.forEach(function(e){s.find(function(t){return t.anchor.pubkey===e})||b(n.closing,e)}),s.length||(t.target=null)}return n},x.prototype.toObject=function(){if("ignore"!==this.mode){var e={mode:this.mode,size:this.size};if("weight"===e.mode&&(delete e.mode,1===e.size&&delete e.size),this.asset)e.asset=this.name,this.opening.length&&(e.opening=this.opening),this.closing.length&&(e.closing=this.closing),1===Object.keys(e).length&&(e=e.asset);else if(this.childs){e.group=this.group;var t=x.sortChilds(this);e.childs=t.map(function(e){return e.toObject()}).filter(function(e){return e})}return e}},x.prototype.toCosmicLink=function(){if(this!==this.root)throw new Error("Only root target can be converted to CosmicLink");var e=this.toOperations(),t=p.operationsToCosmicLink(e),n=this.portfolio.offers.listOutdated();return t.tdesc.operations.forEach(function(e){n.length&&(e.offerId=n.pop().id)}),n.forEach(function(e){t.addOperation("manageOffer",{offerId:e.id,amount:0})}),this.portfolio.balances.filter(function(e){return e.asset.target}).forEach(function(e){(function(e){return"remove"!==e.asset.target.mode&&"opening"===e.action})(e)&&(t.tdesc.operations.unshift({}),t.setOperation(0,"changeTrust",{asset:e.id})),function(e){return!!e.hasTrustline&&(0===e.amount&&"closing"===e.action||"remove"===e.asset.target.mode&&0===e.asset.amount)}(e)&&(t.tdesc.operations.unshift({}),t.setOperation(0,"changeTrust",{asset:e.id,limit:0}))}),t.tdesc.operations.length?t:null},x.prototype.toOperations=function(){var e;return this.childs?(e=[]).concat.apply(e,r(this.childs.map(function(e){return e.toOperations()}))):this.order?this.order.operations:[]},e.exports=x},function(e,t,n){"use strict";var r=n(59),i=n(38),a=n(3),o=n(8),s=n(7),c=n(10),u=n(9),l=n(35).CosmicLink,h=n(33),f=n(29),d=n(13),p=n(4).__,m=n(12),v=n(31),g=v.positive,b=v.negative,y=v.fixed7,w=v.clamp,k=v.absoluteMin,x=v.arraySum,A=v.arrayScale,T=e.exports=function(e){function t(e,n){var r;a(this,t),(r=o(this,s(t).call(this))).type=e,r.method=t.type[r.type],r.operations=new h,r.orderbook=n;for(var i=arguments.length,c=new Array(i>2?i-2:0),u=2;u<i;u++)c[u-2]=arguments[u];return r.parameters=c,r.operations.listen("update",function(){r.compute(["cosmicLink","description"])}),r.refresh(),r}return u(t,d),c(t,null,[{key:"rebalance",value:function(e){if("XLM"!==e.asset.code){var n=new t("balance",e.asset.orderbook,e);return n.watch(e,"amount",function(){return n.refresh()}),n.watch(e.asset.orderbook,["bids","asks"],function(){return n.refresh()}),e.asset.offers.listen("change",function(){return n.refresh()},n),n}}}]),c(t,[{key:"refresh",value:function(){this.operations.splice(0,this.operations.length),this.operations.trigger("update"),this.method.apply(this,[this].concat(i(this.parameters))),this.trigger("refresh")}},{key:"getOperation",value:function(e,t){var n="".concat(e.balance.anchor.name,":").concat(t?e.price:"take"),r=this.operations.find(function(e){return e.id===n});if(r)return r;var i={id:n};return this.operations.push(i),i}},{key:"addOperation",value:function(e,t){var n=this.getOperation(e,t>0);this.setOperation(n,e,Number(t)||n.amount)}},{key:"setOperation",value:function(e,t,n){e.amount=y(n),e.cost=n*t.price,e.offer=t,this.operations.trigger("update")}}]),t}();function O(e){return e.amount>0&&"bids"===e.offer.side||e.amount<0&&"asks"===e.offer.side?"buy":"sell"}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.asset.orderbook,r="quantity"===e.mode||0===e.amount,i=n.asks[0].basePrice;if(r||!(Math.abs(t*i)<m.minOfferValue)){var a=function(e,t){return function(e){return t>=e.balance.sizeMin&&t<=e.balance.sizeMax&&e.baseVolume>Math.abs(t)*m.skipMarginalOffers}}(0,t);T.type.limit(e.order,t,{orderbook:n,filter:a})}}function E(e,t){var n=e.asset.balances,r=0,i=n.map(function(){return 0});if(b(t)){var a=n.map(function(e){return"closing"===e.action?-e.amount:0});r=C(i,a,t)}var o=g(t)?"underMin":"overMax";if(r!==t){var s=n.map(function(e){return"closing"!==e.action?e[o]:0});r=C(i,s,t-r)}if(r!==t){var c=g(t)?"sizeMax":"sizeMin",u=n.map(function(e){return e[c]-e[o]});C(i,u,t-r)}n.forEach(function(t,n){var r=y(i[n]);S(e,r,t.orderbook)})}function C(e,t,n){var r=x(t),i=k(n,r);return A(t,i).forEach(function(t,n){return e[n]+=t}),x(e)}T.define("description","operations",function(){return T.operationsToDescription(this.operations)}),T.operationsToCosmicLink=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=new l({memo:"Equilibre.io",maxTime:"+5",source:m.portfolio.accountId});return e.forEach(function(e){t.addOperation("manageOffer",function(e){var t,n=e.offer,r=n.balance.code+":"+n.balance.anchor.pubkey;t="buy"===O(e)?{buying:r,selling:"XLM",amount:y(e.amount*n.price_r.n/n.price_r.d),price:{n:n.price_r.d,d:n.price_r.n}}:{buying:"XLM",selling:r,amount:e.amount,price:n.price_r};return t.offerId=e.offer.id,t}(e))}),t},T.operationsToDescription=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];return e.forEach(function(e){"buy"===O(e)?t.push("\n".concat(p("Buy")," ").concat(f(e.amount)," ").concat(e.offer.balance.code," ").concat(p("at")," ").concat(f(e.offer.price)," ").concat(m.currency,"\n      ")):t.push("\n".concat(p("Sell")," ").concat(f(e.amount)," ").concat(e.offer.balance.code," ").concat(p("at")," ").concat(f(e.offer.price)," ").concat(m.currency,"\n      "))}),t},T.type={},T.type.market=function(e,t){if(t){var n=t>0?"asks":"bids",r=Math.abs(t),i=e.orderbook.findOffer(n,function(e){return e.baseVolume>r});e.addOperation(i,r)}},T.type.limit=function(e,t,n){var r=n.orderbook,i=n.filter;if(t){var a=t>0?"bids":"asks",o=(r||e.orderbook).findOffer(a,i);o&&e.addOperation(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.spreadTightening,n=Object.assign({},e),r=t*e.balance.asset.orderbook["spread%"]/100;"bids"===e.side?n.price=e.price*(1+r):n.price=e.price*(1-r);e.balance.asset.globalPrice&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.maxSpread/2,n=e.balance.asset.price,r=e.balance.orderbook.price;if("bids"===e.side){var i=Math.min(r,n*(1-t));e.price=w(e.price,i,n)}else{var a=Math.max(r,n*(1+t));e.price=w(e.price,n,a)}}(n);return function(e){var t=e.balance.orderbook.quote;for(e.price_r={n:f(1e10*e.price,0),d:f(1e10*t.price,0)};e.price_r.n>999999999||e.price_r.d>999999999;)e.price_r.n=f(e.price_r.n/10,0),e.price_r.d=f(e.price_r.d/10,0)}(n),n}(o),Math.abs(t))}},T.type.balance=function(e,t){var n=t.asset,r=n.orderbook;if(null!=t.amount&&0!==t.amountDelta)if(r.isFetched()){if(n.liabilities)if(n.offers.filter(function(e){return!e.outdated}).length)return void(e.description=[p("Rebalancing...")]);!function(e){var t=[];if(e.asset.balances.forEach(function(e){null!=e.orderbook.price&&e.isActive?t.push(e):e.targetAmount=null}),!t.length)return;if(1===t.length)return t[0].targetAmount=e.amount;var n=y(e.amount/t.length);t.forEach(function(e){return e.targetAmount=n})}(t),!function(e){var t=e.asset.balances;return!(x(t,"underMin")&&x(t,"overMax"))}(t)?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.amountDiff,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m.anchorsRebalanceRiskMax,r=e.asset.balances,i=-x(r,"underMin"),a=x(r,"overMax"),o=Math.max(i-g(t),a+b(t)),s=Math.abs(e.valueDiffP),c=e.amount*g(n-s),u=Math.min(o,c),l=y(u+g(t)),h=y(u-b(t));E(e,l),E(e,-h)}(t,t.amountDiff):!function(e,t){return!!e.asset.balances.filter(function(e){return e.sizeMin<=t&&t<=e.sizeMax}).length}(t,t.amountDiff)?E(t,t.amountDiff):S(t,t.amountDiff)}else e.description=[p("Fetching orderbook...")]};var I=function(e){T[e]||(T[e]=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r(T,[e].concat(n))})};for(var R in T.type)I(R)},function(e,t,n){"use strict";var r=t,i=n(29),a=n(4).__,o=n(12),s=n(31),c=s.fixed7,u=s.positive;r.apply=function(e){var t=[],n=0,s=0;e.childs.forEach(function(e){var i=e.mode;"weight"===i?(t.push(e),s+=e.size):(r[i](e),n+=e.value)});var c=u(e.value-n);t.forEach(function(e){return r.weight(e,c,s)}),function(e,t,n){if(e>t){var r=+i(e-t,2),s=+i(100*r/t,2),c=a("Rebalance setup is over portfolio value by");throw c+=" ".concat(r," ").concat(o.currency," (").concat(s,"%) "),new Error(c)}if(!n&&e<t){var u=+i(t-e,2),l=+i(100*u/t,2),h=a("Rebalance setup is under portfolio value by");throw h+=" ".concat(u," ").concat(o.currency," (").concat(l,"%) "),new Error(h)}}(n,e.value,t.length)},r.amount=function(e){e.amount=e.size,e.value=e.amount*e.asset.price,e.compute("share")},r.ignore=function(e){e.value=e.asset.value,e.amount=e.asset.amount,e.compute("share")},r.remove=function(e){e.amount=0,e.value=0,e.compute("share")},r.percentage=function(e){r.weight(e,e.parent.value,100)},r.weight=function(e,t,n){n?(e.value=e.size*t/n,e.amount=c(e.value/e.asset.price)):e.value=e.amount=0,e.compute("share")}},function(e,t,n){"use strict";var r=n(3),i=n(10),a=n(8),o=n(7),s=n(9),c=n(27),u=n(4).__,l=n(110),h=n(111);e.exports=function(e){function t(e){var n;return r(this,t),(n=a(this,o(t).call(this,'\n<section class="TargetSetup">\n  <form onsubmit="return false">\n\n    <h3>%name</h3>\n    <hr>\n\n    %sizeSetup\n    %anchorsSetup\n\n    <hr>\n    <input type="submit" onclick=%close value="'.concat(u("Close"),'">\n\n  </form>\n</section>\n    ')))).target=e,n.name=e.asset.name,n.sizeSetup=new h(e),n.target.asset.anchors.length>1&&(n.anchorsSetup=new l(e)),n}return s(t,c),i(t,[{key:"close",value:function(){this.sizeSetup.maybeSwitchMode(),this.trigger("close"),this.destroy()}}]),t}()},function(e,t,n){"use strict";var r=n(3),i=n(10),a=n(8),o=n(7),s=n(9),c=n(27),u=n(4).__;e.exports=function(e){function t(e){var n;return r(this,t),(n=a(this,o(t).call(this,'\n<fieldset class="TargetSetupAnchors">\n  <legend>'.concat(u("Anchor"),":</legend>\n  %toAnchorCheckbox:anchors...\n</fieldset>\n  ")))).target=e,n.anchors=e.asset.anchors,n}return s(t,c),i(t,[{key:"toAnchorCheckbox",value:function(e){var t=this;return new l(e,{getState:function(){return function(e,t){var n=e.asset.balances.find(function(e){return e.anchor===t});return n&&n.isActive}(t.target,e)},callback:this.switchAnchor.bind(this)})}},{key:"switchAnchor",value:function(e,t){t?this.target.addAnchor(e):this.target.asset.balances.reduce(function(e,t){return t.isActive?e+1:e},0)>1&&this.target.removeAnchor(e)}}]),t}();var l=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t);var s=i.getState,c=i.callback;return(n=a(this,o(t).call(this,'\n<span class="AnchorCheckbox half">\n  <input -ref=%checkbox type="checkbox" %checked>\n  <label -ref=%label %onclick>%name</label>\n</span>\n'))).name=e.name,n.checked=s(),n.onclick=function(){c(e,!n.checked),n.checked=s()},n}return s(t,c),t}()},function(e,t,n){"use strict";var r=n(3),i=n(10),a=n(8),o=n(7),s=n(11),c=n(9),u=n(27),l=n(29),h=n(4).__;e.exports=function(e){function t(e){var n;return r(this,t),(n=a(this,o(t).call(this,'\n<fieldset class="TargetSetupSize">\n  <legend>'.concat(h("Size"),':</legend>\n\n  <input class="half" type="number" step="any" min="0" %max value=%size\n    placeholder=%share onchange=%maybeSwitchMode>\n\n  <select class="half" onchange=%setMode value=%mode>\n    <option value="weight">').concat(h("Weight"),'</option>\n    <option value="percentage">').concat(h("Percentage"),'</option>\n    <option value="amount">').concat(h("Amount"),'</option>\n    <option value="ignore" hidden=%targetIsXlm>').concat(h("Ignore"),'</option>\n    <option value="remove" hidden=%targetIsXlm>').concat(h("Remove"),"</option>\n  </select>\n\n</fieldset>\n    ")))).target=e,n.targetIsXlm="XLM"===e.asset.id,e.project("share",s(n),function(e){return l(100*e,2)}),e.project("size",s(n)),n.project("size",e,function(e){return null!=e?Number(e):null}),e.project("mode",s(n)),n.project("mode",e),n}return c(t,u),i(t,[{key:"maybeSwitchMode",value:function(){0===this.size?this.mode="amount":this.size?"ignore"!==this.mode&&"remove"!==this.mode||(this.mode="percentage",this.target.computeAll()):"remove"!==this.mode&&(this.mode="ignore")}},{key:"setMode",value:function(){switch(this.mode){case"weight":this.size=1,this.max=null;break;case"percentage":this.size=+l(100*this.target.asset.share,2),this.max=100;break;case"amount":this.size=this.target.asset.amount,this.max=null;break;case"ignore":case"remove":this.target.set("size",null)}}}]),t}()},function(e,t,n){"use strict";var r=n(3),i=n(10),a=n(8),o=n(7),s=n(11),c=n(9),u=n(27),l=n(1),h=n(4).__,f=n(55);e.exports=function(e){function t(e){var n;return r(this,t),(n=a(this,o(t).call(this,'\n<section class="TargetControls">\n  <form onsubmit="return false" hidden=%hideRebalance>\n    <button onclick=%rebalance disabled=%invalid>'.concat(h("Rebalance"),'</button>\n  </form>\n\n  <form onsubmit="return false" hidden=%hideSave>\n    <button onclick=%save disabled=%invalid>').concat(h("Save"),"</button>\n    <button onclick=%cancel>").concat(h("Cancel"),"</button>\n  </form>\n\n  %toParagraph:error\n</section>\n    ")))).target=e,e.project(["error","modified"],s(n)),n.define("hideRebalance",["modified"],function(){return n.modified}),n.define("hideSave",["modified"],function(){return!n.modified}),n.define("invalid",["error"],function(){return!!n.error}),n}return c(t,u),i(t,[{key:"toParagraph",value:function(e){if(e)return l.create("p",".error",e)}},{key:"cancel",value:function(){location.reload()}},{key:"save",value:function(){this.target.json=this.target.toJson()}},{key:"rebalance",value:function(){var e=this,t=this.target.toCosmicLink();t&&new f(t.uri).listen("destroy",function(){e.target.portfolio.getAccount(),e.target.portfolio.offers.get()})}}]),t}()},function(e,t,n){"use strict";var r=n(11),i=n(5),a=n(6),o=n(3),s=n(10),c=n(8),u=n(7),l=n(9),h=n(27),f=n(1),d=n(29),p=n(4).__,m=n(114);e.exports=function(e){function t(e){var n;return o(this,t),(n=c(this,u(t).call(this,'\n<section class="TargetsTable">\n  <table>\n    <tr>\n      <th class="name">'.concat(p("Name"),'</th>\n      <th align="right">').concat(p("Goal"),'</th>\n      <th align="right">').concat(p("Divergence"),'</th>\n      <th align="right">').concat(p("Operation"),'</th>\n    </tr>\n\n    %targets...\n\n    <tr><td colspan="4" align="center" onclick=%addAsset>\n      <h3>').concat(p("Add Asset"),"</h3>\n    </td></tr>\n\n  </table>\n</section>\n    ")))).target=e,n.targets=e.childs.mirror(function(e){return n.toTargetRow(e)}),n.selected=void 0,e.listen("update",function(){return n.sortTargets()}),n.sortTargets(),n}return l(t,h),s(t,[{key:"toTargetRow",value:function(e){var t=this,n=new v(e);return n.domNode.onclick=function(){return t.selected=e},n}},{key:"sortTargets",value:function(){this.targets.sort(function(e,t){return e=e.target,"ignore"===(t=t.target).mode&&"ignore"!==e.mode?-1:"ignore"===e.mode&&"ignore"!==t.mode?1:"remove"===t.mode&&"remove"!==e.mode?-1:"remove"===e.mode&&"remove"!==t.mode?1:t.value-e.value||e.asset.code.localeCompare(t.asset.code)})}},{key:"addAsset",value:function(){var e=a(i.mark(function e(){var t,n,r,a;return i.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.target.portfolio.availableAssets().filter(function(e){return e.show}),(n=new m(t)).open(),e.next=5,n.answer;case 5:if(r=e.sent){e.next=8;break}return e.abrupt("return");case 8:a=this.target.addAsset(r),this.selected=a;case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}();var v=function(e){function t(e){var n;return o(this,t),(n=c(this,u(t).call(this,'\n<tr class="TargetRow">\n  <td align="left">\n    <img src=%image alt="">\n    <span>%name</span>\n  </td>\n  <td align="right">%command</td>\n  <td align="right">%toPercent:shareDiff</td>\n  <td align="right">%toDiv:description...</td>\n</tr>\n    '))).target=e,n.name=e.asset.code,n.define("command",null,function(){return n.toCommand(e)}),n.watch(e,["size","mode","share"],function(){return n.compute("command")}),e.asset.project("image",r(n)),e.project("shareDiff",r(n)),e.order&&e.order.project("description",r(n)),n}return l(t,h),s(t,[{key:"toCommand",value:function(e){switch(e.mode){case"ignore":return p("Ignore");case"remove":return p("Remove");case"amount":return"".concat(e.amount," ").concat(e.asset.code);case"weight":return"".concat(e.size," âˆ’ ").concat(this.toPercent(e.share));case"percentage":return this.toPercent(e.share)}}},{key:"toPercent",value:function(e){return e?d(100*e,2)+"%":"-"}},{key:"toDiv",value:function(e){return f.create("div",null,e)}}]),t}()},function(e,t,n){"use strict";var r=n(3),i=n(8),a=n(7),o=n(9),s=n(4).__,c=n(115),u=n(116),l=n(117);e.exports=function(e){function t(e){var n;r(this,t),n=i(this,a(t).call(this));var o=new c(e);return n.content=new u(o),n.content.actions=[[s("OK"),function(){return n.returns(o.selected)},"submit"],[s("Cancel"),function(){return n.returns(null)}]],n.content.listen("close",function(){return n.returns(null)}),n.answer=new Promise(function(e){return n.returns=e}),n.answer.then(function(){n.close(),n.destroy()}),n}return o(t,l),t}()},function(e,t,n){"use strict";var r=n(3),i=n(10),a=n(8),o=n(7),s=n(9),c=n(27),u=n(33),l=n(4).__;e.exports=function(e){function t(e){var n;r(this,t),(n=a(this,o(t).call(this,'\n<div class="AssetSelector">\n  %groups...\n</div>\n    '))).groups=new u;var i=e.filter(function(e){return"fiat"===e.type}),s=e.filter(function(e){return"crypto"===e.type&&e.isTether}),c=e.filter(function(e){return"crypto"===e.type&&!e.isTether});return n.addGroup(l("Fiat Tethers"),i),n.addGroup(l("Crypto Tethers"),s),n.addGroup(l("Native Assets"),c),n}return s(t,c),i(t,[{key:"addGroup",value:function(e,t){var n=this;if(t.length){var r=new h(e,t,function(e){return n.selected=e});this.groups.push(r)}}}]),t}();var h=function(e){function t(e,n,i){var s;return r(this,t),(s=a(this,o(t).call(this,'\n<fieldset class="AssetGroup">\n  <legend>%name</legend>\n  %toAssetRadio:assets...\n</fieldset>\n    '))).name=e,s.assets=n,s.onselect=i,s}return s(t,c),i(t,[{key:"toAssetRadio",value:function(e){var t=this;return new f(e,function(){return t.onselect(e)})}}]),t}(),f=function(e){function t(e,n){var i;return r(this,t),(i=a(this,o(t).call(this,'\n<span class="AssetRadio half">\n  <input -ref=%radio type="radio" name="asset-selector-group" %onchange>\n  <label -ref=%label for=%radio>\n    <img src=%image>\n    %name\n  </label>\n</span>\n    '))).name=e.name,i.image=e.image,i.onchange=function(){return i.radio.checked&&n()},i.label.for=i.radio,i.label.onclick=function(){return i.radio.click()},i}return s(t,c),t}()},function(e,t,n){"use strict";var r=n(46),i=n(3),a=n(10),o=n(8),s=n(7),c=n(9),u=n(27),l=n(1);e.exports=function(e){function t(){var e;i(this,t),e=o(this,s(t).call(this,'\n<form class="Dialog" onsubmit="return false">\n\n  %content...\n\n  <div class="DialogControls">\n    %toButton:actions...\n  </div>\n</form>\n    '));for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e.content=r,e}return c(t,u),a(t,[{key:"toButton",value:function(e){var t=r(e,3),n=t[0],i=t[1],a=t[2],o=void 0===a?"button":a;return l.create("button",{type:o,onclick:i},n)}}]),t}()},function(e,t,n){"use strict";var r=n(5),i=n(6),a=n(3),o=n(10),s=n(8),c=n(7),u=n(9),l=n(27),h=n(54),f=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return a(this,t),e=s(this,c(t).call(this,'\n<div class="Modal" %style %hidden>%content</div>\n    ')),Object.assign(e.style,t.style),e.hidden=!0,e.content=n.content,e.trap(t.styleParams,function(t){return e.style[t.key]=t.value}),t.styleParams.forEach(function(t){return e[t]=n[t]}),document.body.insertBefore(e.domNode,document.body.firstChild),e}return u(t,l),o(t,[{key:"setPosition",value:function(){var e={x:0,y:0};this.left||this.right||(this.style.left="50%",e.x="-50%"),this.top||this.bottom||(this.style.bottom="50%",e.y="50%"),this.style.transform="translate(".concat(e.x,", ").concat(e.y,")")}},{key:"open",value:function(){var e=i(r.mark(function e(){var n=this;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.clickWall.enable(),this.hidden=!1,this.setPosition(),e.next=5,t.shadow.enable();case 5:t.shadow.onclick=function(){return n.close()},t.clickWall.disable(),this.trigger("open");case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){var e=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.clickWall.enable(),this.hidden=!0,e.next=4,t.shadow.disable();case 4:t.clickWall.disable(),this.trigger("close");case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),t}();f.styleParams=["height","width","top","right","bottom","left","padding"],f.style={zIndex:1e3,position:"fixed"},f.shadow=new h({scrollbar:"hide",opacity:.3,delay:300}),f.clickWall=new h,f.clickWall.domNode.style.zIndex="2000",e.exports=f},function(e,t){e.exports='<section><h2>License</h2>\n  <section><h3>MIT License</h3>\n\n    <p>Copyright (c) 2019 Antoine Bodin &lt;<a\n    href="mailto:mister.ticot@cosmic.plus">mister.ticot@cosmic.plus</a>&gt;</p>\n\n    <p>Permission is hereby granted, free of charge, to any person obtaining a\n    copy of this software and associated documentation files (the "Software"),\n    to deal in the Software without restriction, including without limitation\n    the rights to use, copy, modify, merge, publish, distribute, sublicense,\n    and/or sell copies of the Software, and to permit persons to whom the\n    Software is furnished to do so, subject to the following conditions:</p>\n\n    <p>The above copyright notice and this permission notice shall be included\n    in all copies or substantial portions of the Software.</p>\n\n    <p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n    OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n    IN THE SOFTWARE.</p>\n  </section>\n</section>\n'},function(e,t){e.exports='<section>\n  <h2>What is Equilibre.io?</h2>\n\n  <section class="landing">\n    <h3>A Portfolio Balancer for Stellar</h3>\n\n    <div>\n\n    <p>\n      Equilibre.io is a portfolio balancer for Stellar. In other words, it is\n      a software which helps you to spread your funds across various\n      currencies and crypto assets.\n    </p>\n\n    <p>\n      I initially created it to protect my funds against a possible bear market.\n      As it proved reliable, I decided to make it publicly available.\n    </p>\n\n    <p>\n      Equilibre.io is merely a sophisticated front-end for the Stellar\n      Decentralized exchange: your account, holdings & operations live on the\n      blockchain.\n    </p>\n\n    <p>\n      It works a bit like a multi-currency bank account. Except there\'s no bank.\n      And you are the only one in control.\n    </p>\n\n    </div>\n  </section>\n\n  <section class="landing">\n    <h3>A Risk Management Solution</h3>\n\n    <div>\n    <p>\n      Equilibre.io can help you to implement what is known as a "balanced\n      investment strategy". Basically, the idea is that balancing funds over\n      multiple assets will average a portfolio performance & mitigate the risks.\n    </p>\n\n    <p>\n      Here\'s how it works: we choose a number of assets we want to be exposed\n      to, and we attribute a share of the portfolio to each of them (e.g: 20%\n      each). Then, we "rebalance" the portfolio on a regular basis. This means\n      that we pass trades that bring back each asset to its allocated share.\n    </p>\n\n    <p>\n      It is important to understand that Equilibre.io is not an automated\n      trading bot, nor a magic-free-money scheme. It is a product made for\n      people who can decide on their own strategy & who understand the risks\n      they are taking.\n    </p>\n    </div>\n  </section>\n\n  <section class="landing">\n    <h3>A Fancy Account Viewer</h3>\n\n    <div>\n    <p>\n      Equilibre.io offers a live view of the latest blockchain state. It is also\n      in sync with the latest market data & displays values and historical data\n      in your national currency.\n    <p>\n\n    <p>\n      It is one of the few applications (if not the only one) that can retrieves\n      the complete history of any Stellar account, and pack that data into a\n      fancy chart.\n    </p>\n    </div>\n  </section>\n\n  <section class="landing">\n    <h3>A Sophisticated Trading Engine</h3>\n\n    <div>\n    <p>\n      Equilibre.io is, first of all, a collection of fine-tuned trading\n      algorithms.  Since a year, I\'ve crash-tested them in every way I could\n      imagine and packed what worked the best in an easy-to-use interface.\n    <p>\n\n    <p>\n      It can transform templates such as "I want 50% of my portfolio in BTC and\n      50% in XLM" into a transaction that passes the required orders. Forget\n      about trust lines, order books and price picking: all that stuff is dealt\n      with in the background.\n    <p>\n\n    <p>\n      The trading engine has a defensive behavior: it prioritizes not losing\n      money over taking risks to make a profit.\n    </p>\n    </div>\n  </section>\n\n\n  <section class="landing">\n    <h3>A New Security Standard for the Years to Come</h3>\n\n    <div>\n    <p>\n      Equilibre.io strictly enforce cryptography good practices: I certainly\n      don\'t want to know about your private key, nor to obtain any kind of\n      control over your account. <em>â€œWho can protect a house full of gold and\n      jewels?â€</em>\n    </p>\n\n    <p>\n      When you want to rebalance your portfolio, Equilibre.io generates a\n      transaction request that you can sign using your own wallet. This is\n      possible thanks to protocols known as CosmicLink &Â SEP-0007.\n    </p>\n\n    <p>\n      Those protocols turn any compatible Stellar wallet into something like\n      Metamask for Ethereum. At that time, only a few services are compatibles.\n      However, a number of wallets announced their intention to support\n      transactions requests in the future, including Keybase, Lobster, and\n      Stargazer.\n    <p>\n    </div>\n  </section>\n\n  <section class="landing">\n    <h3>A Free Software, as in Freedom</h3>\n\n    <div>\n    <p>\n      I think that the free software cooperative mindset can go a long way in\n      improving a project such as Stellar. That\'s why I released Equilibre.io in\n      the public domain. Here are some of the benefits of it:\n    </p>\n\n    <p>\n      Auditability: The software can be proven to contain no malware and no\n      tracker. It can be audited for flaws & proven safe.\n    </p>\n\n    <p>\n      Forkability: Any feature implemented by the software becomes <em>de\n      facto</em> available to every other developer. For example, the code I\n      wrote to support Ledger Wallets is <a\n      href="https://www.npmjs.com/package/@cosmic-plus/ledger-wallet"\n      target="_blank" rel="noopener">freely available to all</a>.\n    </p>\n    </div>\n  </section>\n\n</section>\n'},function(e,t){e.exports="<section>\n  <h2>Legal Disclaimer</h2>\n\n  <section>\n    <h3>Risks Related to the Use of Equilibre.io</h3>\n\n    <p>\n      The Application author will not be responsible for any losses, damages or\n      claims arising from any event related to its use, including but not\n      limited to:\n    </p>\n\n    <p>âˆ’ Mistakes made by the users of the Application.</p>\n\n    <p>âˆ’ Software problems of the Application and/or any\n    related software or service.</p>\n\n    <p>âˆ’ Technical failures in the hardware of the users.</p>\n\n    <p>âˆ’ Security problems experienced by the users.</p>\n\n    <p>âˆ’ Actions or inactions of third parties and/or events experienced by\n    third parties.</p>\n  </section>\n\n  <section>\n    <h3>Not an Exchange</h3>\n\n    <p>\n      The Application is not an exchange. It is an independent front-end for the\n      Stellar Decentralized Exchange. The Application doesn't have any control\n      over the user's account, assets that can be bought or sell or the exchange\n      as a whole.\n    </p>\n\n    <p>\n      The assets made available through the Application have been selected on\n      the sole basis of the thickness and the daily volumes of their order book.\n      Their availability in the Application doesn't constitute a guarantee of\n      any sort. In particular, no research has been conducted about their\n      fundamentals or their compliance with national laws that may apply\n      to them or to the users.\n    </p>\n\n    <p>\n      The Application doesn't pass any transaction on behalf of the users. The\n      users are solely responsible for the transactions that they are signing\n      and sending to the blockchain.\n    </p>\n  </section>\n\n  <section>\n    <h3>No Guarantee of Profit</h3>\n\n    <p>\n      Past performance may not be indicative of future results. Different types\n      of investments involve varying degrees of risk, and there can be no\n      assurance that the future performance of any specific investment,\n      investment strategy, or product will be profitable, equal any\n      corresponding indicated historical performance level(s), or be suitable\n      for your portfolio.\n   </p>\n\n    <p>\n      The Application doesn't provide investment advice, financial advice,\n      trading advice, or any other sort of advice, and none of the Application\n      content should be treated as such. The users are responsible to conduct\n      their own diligence and consult their financial advisory before making\n      investment decisions.\n    </p>\n  </section>\n\n  <section>\n    <h3>Compliance With Tax Obligations</h3>\n\n    <p>\n      The users of the Application are solely responsible to determinate what,\n      if any, taxes apply to their transactions. The author of the Application\n      is NOT responsible for determining the taxes that apply to transactions.\n    </p>\n    \n    <p>\n      Some countries are taxing investments on a per-transaction basis, which\n      can heavily affect the performance of strategies involving high quantities\n      of micro-transactions.\n    </p>\n  </section>\n\n</section>\n\n"},function(e){e.exports={fiat:{USD:{show:!0,name:"US Dollar"},CNY:{show:!0,name:"Renminbi"},EUR:{name:"Euro"}},foreign:{BTC:{show:!0,apiId:"bitcoin"},ETH:{show:!0,apiId:"ethereum"},XRP:{show:!0,apiId:"ripple"},LTC:{show:!0,apiId:"litecoin"},KIN:{show:!0,apiId:"kin"},BAT:{apiId:"basic-attention-token"},BCH:{apiId:"bitcoin-cash"},LINK:{apiId:"chainlink"},MTL:{apiId:"metal"},OMG:{apiId:"omisego"},REP:{apiId:"augur"},SALT:{apiId:"salt"},ZRX:{apiId:"0x"}},native:{XLM:{show:!0,apiId:"stellar"},FRAS:{show:!0,apiId:"frasindo-rent"},MOBI:{show:!0,apiId:"mobius"},PEDI:{show:!0,apiId:"pedity"},REPO:{show:!0,apiId:"repo"},RMT:{show:!0,apiId:"sureremit"},SHX:{show:!0,apiId:"stronghold-token"},SLT:{show:!0,apiId:"smartlands"},TERN:{show:!0,apiId:"ternio"}}}},function(e){e.exports={GAP5LETOV6YIE62YAM56STDANPRDO7ZFDBGSNHJQIYGGKSMOZAHOOS2S:{alias:"tempo.eu.com",emit:[["EUR","EURT"]]},GAREELUB43IRHWEASCFBLKHURCGMHE5IF6XSE7EXDLACYHGRHM43RFOX:{alias:"ripplefox.com",emit:["CNY"]},GCNY5OXYSY4FKHOPT2SPOQZAOEIGXB5LBYW3HVU3OWSTQITS65M5RCNY:{alias:"fchain.io",emit:[["CNY","XCN"]]},GDSRCV5VTM3U7Y3L6DFRP3PEGBNQMGOWSRTGSBWX6Z3H6C7JHRI4XFJP:{alias:"x.token.io",emit:["USD"]},GDSVWEA7XV6M5XNLODVTPCGMAJTNBLZBXOFNQD3BNPNYALEYBNT6CE2V:{alias:"thewwallet.com",emit:[["USD","WSD"]]},GDUKMGUGDZQK6YHYA5Z6AY2G4XDSZPSZ3SW5UN3ARVMO6QSRDWP5YLEX:{alias:"anchorusd.com",emit:["USD"]},GAEGOS7I6TYZSVHPSN76RSPIVL3SELATXZWLFO4DIAFYJF7MPAHFE7H4:{alias:"apay.io",emit:["BCH"]},GATEMHCCKCY67ZUCKTROYN24ZYT5GK4EQZ65JJLDHKHRUZI3EUEKMTCH:{alias:"naobtc.com",emit:["BTC"]},GAUTUYY2THLF7SGITDFMXJVYH3LHDSMGEAKSBU267M2K7A3W543CKUEF:{alias:"apay.io",emit:["BTC"]},GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR:{alias:"apay.io",emit:["BAT","ETH","KIN","LINK","MTL","OMG","REP","SALT","ZRX"]},GBETHKBL5TCUTQ3JPDIYOZ5RDARTMHMEKIO2QZQ7IOZ4YC5XV3C2IKYU:{alias:"fchain.io",emit:["ETH"]},GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5:{alias:"stellarport.io",emit:["BTC","ETH","XRP","LTC"]},GC5LOR3BK6KIOK7GKAUD5EGHQCMFOGHJTC7I3ELB66PTDFXORC2VM5LP:{alias:"apay.io",emit:["LTC"]},GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P:{alias:"interstellar.exchange",emit:["BTC","ETH","XRP","LTC"]},GC75WHUIMU7LV6WURMCA5GGF2S5FWFOK7K5VLR2WGRKWKZQAJQEBM53M:{emit:["FRAS"]},GCKA6K5PCQ6PNF5RQBF7PQDJWRHO6UOGFMRLK3DYHDOI244V47XKQ4GP:{emit:["SLT"]},GA6HCMBLTZS5VYYBCATRBRZ3BZJMAFUDKYYF6AH6MVCMGWMRDNSWJPIH:{emit:["MOBI"]},GDSTRSHXHGJ7ZIVRBXEYE5Q74XUVCUSEKEBR7UCHEUUEK72N7I7KJ6JH:{emit:["SHX"]},GDEGOXPCHXWFYY234D2YZSPEJ24BX42ESJNVHY5H7TWWQSYRN5ZKZE3N:{emit:["RMT"]},GDGQDVO6XPFSY4NMX75A7AOVYCF5JYGW2SHCJJNWCQWIDGOZB53DGP6C:{emit:["TERN"]},GBVUDZLMHTLMZANLZB6P4S4RYF52MVWTYVYXTQ2EJBPBX4DZI2SDOLLY:{emit:["PEDI"]},GCZNF24HPMYTV6NOEHI7Q5RJFFUI23JKUKY3H3XTQAFBQIBOHD5OXG3B:{emit:["REPO"]}}},function(e,t,n){"use strict";var r=n(3),i=n(8),a=n(7),o=n(9),s=n(27),c=n(1),u=n(4).__,l=n(124),h=n(125),f=n(12),d=new(function(e){function t(e,n){return r(this,t),i(this,a(t).call(this,'\n<footer id="footer" class="scrollable">\n  <div class="nobreak">%icons...</div>\n  %links\n</footer>\n    ',{icons:e,links:n}))}return o(t,s),t}())([new h(n(126),"Keybase","https://keybase.io/team/cosmic_plus"),new h(n(127),"Telegram","https://t.me/cosmic_plus"),new h(n(128),"Reddit","https://reddit.com/r/cosmic_plus"),new h(n(129),"Twitter","https://twitter.com/cosmic_plus"),new h(n(130),"Medium","https://medium.com/cosmic-plus"),new h(n(131),"GitHub","https://github.com/cosmic-plus/webapp-equilibre-io"),new h(n(132),u("Website"),"https://cosmic.plus"),new h(n(133),u("Email"),"mailto:mister.ticot@cosmic.plus"),new h(n(134),"Donate",l)],new s("\n<p>\n  <a onclick=%displayLicense>".concat(u("License"),"</a>\n  âˆ’ <a onclick=%displayDisclaimer>").concat(u("Disclaimer"),"</a>\n  âˆ’ <a onclick=%displayAbout>").concat(u("About"),"</a>\n</p>\n"),{displayLicense:function(){return f.tabs.select("#license")},displayDisclaimer:function(){return f.tabs.select("#disclaimer")},displayAbout:function(){return f.tabs.select("#about")}}));c.append(document.body,d)},function(e,t,n){"use strict";var r=n(35).CosmicLink,i=n(4).__,a=n(55),o="GAWO2C52D57XBT7SQL6YB3XPHFLFD2J4Z5RN7HPFZSHXJMXH72HRXNV3";e.exports=function(){var e=prompt("".concat(i("Equilibre.io runs on donation.")," ").concat(i("Each contribution matters to me.")," ").concat(i("Thank you!"),"\n\n").concat(i("Enter an amount (in Lumens)"),":"));"0"===e||isNaN(+e)?confirm("".concat(i("Not a valid amount"),": ").concat(e)):e&&function(e){var t=i("Donation to Equilibre.io"),n=new r({memo:t,network:"public"}).addOperation("payment",{amount:e,destination:o});new a(n.uri)}(e)}},function(e,t,n){"use strict";var r=n(3),i=n(8),a=n(7),o=n(9),s=n(27),c=function(e){function t(e,n,o){var c;return r(this,t),(c=i(this,a(t).call(this,'<a -ref=%link class="Icon">%image</a>'))).image="string"==typeof e?new s(e):e,c.link.title=n,"function"==typeof o?c.link.onclick=o:"string"==typeof o&&(c.link.href=o,o.match(/^http/)&&(c.link.target="_blank",c.link.rel="noopener")),c}return o(t,s),t}();e.exports=c},,,,,,,,,function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="none" d="M0 0h512v512H0z"/><path d="M211.719 367.797C219.469 379.281 224 393.109 224 408c0 39.734-32.266 72-72 72-39.758 0-72-32.266-72-72 0-23.172 11.148-43.563 28.164-56.734 1.852 5.594 4.336 11.125 8.289 15.906 7.055 8.516 20.336 18.266 43.531 16.344 7.578-.641 15.844-2.547 24.586-5.641 8.875-3.078 18.508-6.5 27.149-10.078zM389.875 32.578c-13.344 3.797-24.156 10.672-38.813 18.328-90 47-196.25 39.25-220 77-27.469 51.672-48.883 89.203-48.945 107.625-.016.063-.055.094-.07.141.586 19.953 19.625 58.438 29.07 75.969 6.789-15.516 17.492-29.219 32.25-40.688 7.414-5.766 13.289-9.922 18.617-13.5-3.016-9.25-6.945-20.016-10.875-28.203 10.742-7.391 26.078-26.484 31.398-40.313 13.227.094 30.25-3.172 44.773-6.938 6.406 6.844 12.977 13.563 21.766 20.016-3.961 14.344-7.07 27.063-23.438 38.359-22.313 15.438-42.734 21.578-69.484 43.109-16.086 12.953-26.07 28.203-30.625 45.641-3.148 12.094 4.734 53.016 58 33.141 10.023-3.75 23.398-8.531 34.875-14.25 23.797-11.813 52.922-40.781 61-44.828 15.234-7.641 49.813-10.656 86.313-35.016 12.531-8.375 22.063-20.688 26.477-33.625 33.242-64.828 60.883-59.656 68.633-72.563C477.734 133.734 423.563 23 389.875 32.578z"/></svg>\n'}])]);
//# sourceMappingURL=app.js.map
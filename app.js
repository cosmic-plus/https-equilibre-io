(window.webpackJsonp=window.webpackJsonp||[]).push([[0],Array(26).concat([function(e,t,n){var r=n(5),i=n(6),o=n(17),a=n(29),s=n(1),c=n(44),u=n(79),l=n(4).__,f=n(13),d=n(80),h=n(89),p=n(64),m=n(92).isOverflowing,v=n(93),g=n(94),b=n(98),y=n(99),k=new a(n(103)),w=new a(n(104));n(105);var T=f.tabs=new c({nav:o.header,view:o.main});T.add("#welcome",l("Welcome"),w),T.add("#login",l("Login"),o.loginForm),T.add("#license",null,k),T.add("#about",null,w),T.select(location.hash),T.selected||T.select("#welcome"),T.fitScreen=function(){m(o.header)&&s.replace(T.nav.domNode,T.selector.domNode)},T.fitScreen();var O,A=new p(o.loginForm,{hidden:!1,onsubmit:E});function S(){return(S=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return A["stellar-public-key"]=null,e.next=3,Promise.all([n.e(4),n.e(1)]).then(n.t.bind(null,117,7)).then(function(e){return e.default});case 3:return O=e.sent,A.info(l("Please open the Stellar App in your Ledger Wallet")),e.prev=5,e.next=8,O.connect();case 8:A["stellar-public-key"]=O.publicKey,E(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),A.error(e.t0);case 15:case"end":return e.stop()}},e,null,[[5,12]])}))).apply(this,arguments)}function E(){return I.apply(this,arguments)}function I(){return(I=i(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(t=A["stellar-public-key"])||A.error(l("Please enter an address.")),O&&O.disconnect(),A.info(l("Connecting to your account...")),u.$set({address:t}),h.enable(),e.prev=6,e.next=9,d.resolve(t);case 9:f.portfolio=e.sent,A.info("".concat(l("Fetching market data"),"...")),setTimeout(function(){return A.info("".concat(l('Sorry, it takes a while (^.^)"'),"..."))},1e4),setTimeout(function(){return A.info("".concat(l("Almost there"),"..."))},2e4),setTimeout(function(){return A.info("".concat(l("I'm running, I'm running"),"..."))},3e4),f.portfolio.listen("open",function(){N(),h.disable()}),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(6),h.disable(),A.error(e.t0);case 21:case"end":return e.stop()}},e,null,[[6,17]])}))).apply(this,arguments)}function N(){var e=f.portfolio,t=location.hash;T.remove("#welcome"),T.remove("#login"),T.add("#portfolio",l("Portfolio"),new g(e)),T.add("#rebalance",l("Rebalance"),new y(e)),T.add("#activity",l("Activity"),new v(e)),T.add("#settings",l("Settings"),new b),T.add("#logout",l("Logout"),function(){location.replace(location.href.replace(/\?.*$/,"#login"))}),T.fitScreen(),T.select(t),T.selected||T.select("#portfolio")}A.dom.loginWithLedger.onclick=function(){return S.apply(this,arguments)},u.address&&(T.select("#login"),A["stellar-public-key"]=u.address,E()),T.listen("select",function(e){location.hash=e,window.scrollTo(0,0)})},,,,,,function(e,t,n){"use strict";var r=t;r.positive=function(e){return Math.max(0,e)},r.negative=function(e){return Math.min(0,e)},r.fixed7=function(e){return+Number(e).toFixed(7)},r.clamp=function(e,t,n){return Math.min(Math.max(e,t),n)},r.absoluteMin=function(e,t){return Math.abs(e)<=Math.abs(t)?e:t},r.arraySum=function(e,t){return t?e.reduce(function(e,n){return e+n[t]},0):e.reduce(function(e,t){return e+t},0)},r.arrayScale=function(e,t,n){var i=r.arraySum(e,n);return n?e.map(function(e){return e[n]*t/i}):e.map(function(e){return e*t/i})}},,,,,,,,,,,function(e,t,n){var r=n(5),i=n(6),o=n(3),a=n(8),s=n(7),c=n(11),u=n(10),l=n(9),f="https://www.xe.com/themes/xe/images/flags/svg/",d=".svg",h=n(33),p=n(12),m=n(13),v=n(61),g=n(62),b=n(32).arraySum,y=e.exports=function(e){"use strict";function t(e){var n;return o(this,t),(n=a(this,s(t).call(this))).id=e,t.table[e]=c(n),n.image="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",t.info[e]?(n.code=e,Object.assign(c(n),t.info[e]),"fiat"===n.type?(t.fiats.push(c(n)),n.image="".concat(f).concat(e.toLowerCase()).concat(d),n.useGlobalPrice=!0):(t.cryptos.push(c(n)),n.type="crypto",(n.isTether||"XLM"===n.id)&&(n.useGlobalPrice=!0))):(n.code=e.replace(/:.*/,""),n.name=n.code,n.type="unknown"),n.anchors=new h,n.balances=new h,n.offers=new h,n.balances.mirror(function(e){n.anchors.push(e.anchor),n.watch(e,"amount",function(){return n.compute("amount")}),n.watch(e,["buying","selling"],function(){n.compute("liabilities")})}),n.orderbook=g.forAsset(c(n)),n.define("price","globalPrice",function(){return n.globalPrice||n.orderbook.price}),n.watch(n.orderbook,"price",function(){return n.compute("price")}),n}return l(t,p),u(t,null,[{key:"resolve",value:function(e){return t.table[e]||new t(e)}}]),u(t,[{key:"getInfo",value:function(){var e=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.name&&"crypto"===this.type){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,v.crypto.info(this);case 4:this.info=e.sent,this.name=this.info.name,this.image=this.info.image.small;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addOrderbook",value:function(e){this.orderbook.addChild(e)}}]),t}();y.define("amount","balances",function(){return this.balances&&b(this.balances,"amount")}),y.define("value",["amount","price"],function(){return 0===this.amount?0:this.amount*this.price}),y.define("liabilities",["balances","price"],function(){if(this.balances){var e=this.balances.reduce(function(e,t){return e+t.buying-t.selling},0);return this.price*e}}),y.define("isSupported",["type","price"],function(){return!("unknown"===this.type&&!this.price)}),y.refreshPrices=function(){var e=i(r.mark(function e(t){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=7;break}return e.next=3,y.refreshCryptoPrices();case 3:return e.next=5,y.refreshFiatPrices();case 5:e.next=11;break;case 7:return e.next=9,y.refreshCryptoPrices(t.filter(function(e){return"crypto"===e.type}).map(function(e){return e.code}));case 9:return e.next=11,y.refreshFiatPrices(t.filter(function(e){return"fiat"===e.type}).map(function(e){return e.code}));case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),y.refreshCryptoPrices=i(r.mark(function e(){var t,n,i=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=i.length>0&&void 0!==i[0]?i[0]:y.cryptos).length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,v.crypto.prices(t);case 5:n=e.sent,t.forEach(function(e){e.useGlobalPrice&&(e.globalPrice=n[e.code])});case 7:case"end":return e.stop()}},e)})),y.refreshFiatPrices=i(r.mark(function e(){var t,n,i=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=i.length>0&&void 0!==i[0]?i[0]:y.fiats).length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,v.fiat.prices(t);case 5:n=e.sent,t.forEach(function(e){e.useGlobalPrice&&(e.globalPrice=n[e.code])});case 7:case"end":return e.stop()}},e)})),y.info={USD:{isTether:!0,type:"fiat",name:"US Dollar"},EUR:{isTether:!0,type:"fiat",name:"Euro"},CNY:{isTether:!0,type:"fiat",name:"Renminbi"},BTC:{isTether:!0,apiId:"bitcoin"},ETH:{isTether:!0,apiId:"ethereum"},XRP:{isTether:!0,apiId:"ripple"},KIN:{isTether:!0,apiId:"kin"},BAT:{isTether:!0,apiId:"basic-attention-token"},ZRX:{isTether:!0,apiId:"0x"},BCH:{isTether:!0,apiId:"bitcoin-cash"},STEEM:{isTether:!0,apiId:"steem"},SBD:{isTether:!0,apiId:"steem-dollar"},LINK:{isTether:!0,apiId:"chainlink"},XLM:{apiId:"stellar"},SLT:{apiId:"smartlands"},MOBI:{apiId:"mobius"},SHX:{apiId:"stronghold-token"},RMT:{apiId:"sureremit"},TERN:{apiId:"ternio"},PEDI:{apiId:"pedity"},GRAT:{apiId:"gratz"},REPO:{apiId:"repo"}},y.table={},y.cryptos=[],y.fiats=[],new y(m.currency),setInterval(y.refreshCryptoPrices,6e4),setInterval(y.refreshFiatPrices,36e5),console.log(y.table)},,,,,,,,,function(e,t,n){var r=n(3),i=n(10),o=n(8),a=n(7),s=n(11),c=n(9),u=n(1),l=n(19),f=n(0).timeout,d=n(4).__,h=function(e){"use strict";function t(e){var n;return r(this,t),n=o(this,a(t).call(this)),t.current&&t.current.close(),t.current=s(n),n.domNode=u.create("iframe",{title:"Signing Frame",className:"animated",src:e,sandbox:"allow-same-origin allow-scripts allow-forms allow-popups",hidden:!0}),Object.assign(n.domNode.style,t.style),u.append(document.body,n.domNode),n.show(),n}return c(t,l),i(t,[{key:"show",value:function(){var e=this;if(this.domNode.hidden)return this.htmlOverflow=document.documentElement.style.overflow,this.bodyOverflow=document.body.style.overflow,document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",u.show(t.shadow,t.close,this.domNode),this.domNode.style.animationName="slideInRight",t.shadow.style.background="rgba(0,0,0,0.3)",f(400).then(function(){t.shadow.onclick=function(){return e.close()},t.close.onclick=function(){return e.close()},e.trigger("show")})}},{key:"hide",value:function(){var e=this;if(!this.domNode.hidden)return document.documentElement.style.overflow=this.htmlOverflow,document.body.style.overflow=this.bodyOverflow,t.shadow.onclick=null,u.hide(t.close),this.domNode.style.animationName="slideOutRight",t.shadow.style.background="transparent",f(400).then(function(){u.hide(t.shadow,t.close,e.domNode),e.trigger("hide")})}},{key:"close",value:function(){var e=this;t.current=null,this.hide().then(function(){u.destroy(e.domNode),e.trigger("close"),e.destroy()})}}]),t}();window.addEventListener("message",function(e){var t=h.current&&h.current.domNode.contentWindow;if(e.source===t)switch(e.data){case"show":h.current.show();break;case"hide":h.current.hide();break;case"close":h.current.close()}}),h.style={position:"fixed",zIndex:998,right:0,top:0,width:"30em",maxWidth:"100%",height:"100vh",border:"0.1em solid hsl(240, 10%, 75%)",background:"hsl(240, 40%, 98%)",backgroundImage:"url('./images/cosmic-link.svg')",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"12em 12em",padding:0},h.close=u.create("span",{hidden:!0},"Ã— ".concat(d("Close"))),Object.assign(h.close.style,{position:"fixed",zIndex:999,top:"0.1em",right:"0.1em",color:"hsl(0, 0%, 40%)",fontSize:"0.9em",fontWeight:"bold",cursor:"pointer",background:"hsl(0, 0%, 95%)",borderBottomLeftRadius:"0.1em",padding:"0.1em 0.3em"}),document.body.insertBefore(h.close,document.body.firstChild),h.shadow=u.create("div",{hidden:!0}),Object.assign(h.shadow.style,{position:"fixed",zIndex:997,top:0,width:"100%",height:"100%",background:"transparent",transition:"background 0.4s"}),document.body.insertBefore(h.shadow,document.body.firstChild),e.exports=h},,,,,,,,,function(e,t,n){var r=n(5),i=n(6),o=t,a=n(45),s=n(30),c=n(0).day,u=n(13);function l(e,t){return a.get("https://api.coingecko.com/api/v3/".concat(e),{params:t})}function f(e,t){return d.apply(this,arguments)}function d(){return(d=i(r.mark(function e(t,n){var i,o=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(i=o.length>2&&void 0!==o[2]?o[2]:{}).base=u.currency,"string"==typeof n?i.symbols=n:("EUR"===u.currency&&(n=n.filter(function(e){return"EUR"!==e})),i.symbols=n.join(",")),i.source="equilibre.io",e.abrupt("return",a.get("https://api.exchangeratesapi.io/".concat(t),{params:i}).then(function(e){return"EUR"!==u.currency||e.data.start_at||(e.data.rates.EUR=1),e}));case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(e,t){localStorage["prices.".concat(e.code)]=JSON.stringify([c(),t])}function p(e){var t=localStorage["prices.".concat(e.code)];if(t){var n=JSON.parse(t);return n[0]===c()?n[1]:void 0}}o.assetHistory=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return"crypto"===e.type?o.crypto.history(e,t):"fiat"===e.type?o.fiat.history(e,t):void 0},o.crypto={},o.crypto.list=i(r.mark(function e(){var t,n;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l("coins/list");case 2:return t=e.sent,n={},t.data.forEach(function(e){var t=e.symbol.toUpperCase();n[t]={apiId:e.id,name:e.name}}),e.abrupt("return",n);case 6:case"end":return e.stop()}},e)})),o.crypto.stellarNative=i(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l("exchanges/stellar_term");case 2:return t=e.sent,e.abrupt("return",t.data.tickers.map(function(e){return e.coin_id}).filter(function(e){return e}));case 4:case"end":return e.stop()}},e)})),o.crypto.info=function(){var e=i(r.mark(function e(t){var n;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l("coins/".concat(t.apiId),{localization:!1,tickers:!1,market_data:!1,community_data:!1,developer_data:!1,sparkline:!1});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),o.crypto.prices=function(){var e=i(r.mark(function e(t){var n,i,o,a;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(function(e){return e.apiId}).join(","),i=u.currency.toLowerCase(),e.next=4,l("simple/price",{ids:n,vs_currencies:i});case 4:return o=e.sent,a={},t.forEach(function(e){var t=o.data[e.apiId];t&&(a[e.code]=t[i])}),e.abrupt("return",a);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),o.crypto.history=function(){var e=i(r.mark(function e(t){var n,i,o,a=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:1e3,e.next=3,l("coins/".concat(t.apiId,"/market_chart"),{vs_currency:u.currency,days:n});case 3:return i=e.sent,o=i.data.prices.map(function(e,t){return{time:e[0],price:e[1],volume:+s(i.data.total_volumes[t][1]/e[1])}}),e.abrupt("return",o);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),o.fiat={},o.fiat.prices=function(){var e=i(r.mark(function e(t){var n,i,o,a;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(function(e){return e.code}),e.next=3,f("latest",n);case 3:for(a in i=e.sent,o=i.data.rates)o[a]=s(1/o[a],8);return e.abrupt("return",o);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),o.fiat.history=function(){var e=i(r.mark(function e(t){var n,i,o,a,c,u,l,d=arguments;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:1e3,!(i=p(t))){e.next=4;break}return e.abrupt("return",i);case 4:return o=(new Date).toISOString().slice(0,10),(a=new Date(o)).setDate(a.getDate()-n),c=a.toISOString().slice(0,10),e.next=10,f("history",t.code,{start_at:c,end_at:o});case 10:return u=e.sent,l=Object.keys(u.data.rates).sort().map(function(e){return{time:new Date(e).getTime(),price:+s(1/u.data.rates[e][t.code],8)}}),h(t,l),e.abrupt("return",l);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},function(e,t,n){var r=n(5),i=n(6),o=n(3),a=n(8),s=n(7),c=n(10),u=n(9),l=n(37),f=n(12),d=n(27),h=n(0).timeout,p=n(4).__,m=n(32).fixed7,v=e.exports=function(e){"use strict";function t(e){var n;return o(this,t),n=a(this,s(t).call(this)),e.balance?(n.type="native",n.balance=e.balance,n.base=e.balance.asset,n.quote=e.quote,n.name="".concat(n.base.code,"/").concat(n.quote.code),n.offersCallBuilder=t.offersCallBuilder(n.balance),n.watch(n.quote,"price",function(){return n.updateOffersPrices()})):e.asset&&(n.type="agregated",n.base=e.asset,n.name="".concat(n.base.code," (").concat(p("Agregated"),")"),n.childs=[]),n.watch(n.base,"globalPrice",function(){return n.compute("price")}),n}return u(t,f),c(t,null,[{key:"forBalance",value:function(e,n){if(e.asset!==n){var r=new t({balance:e,quote:n});return r.streamOffers(),e.orderbook=r,e.asset.addOrderbook(r),r}}},{key:"forAsset",value:function(e){return new t({asset:e})}}]),c(t,[{key:"streamOffers",value:function(){var e=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.getOffers();case 3:return e.next=5,h(15e3);case 5:e.next=0;break;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getOffers",value:function(){var e=i(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.offersCallBuilder.call();case 3:t=e.sent,this.ingest(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"ingest",value:function(e){g(this.bids,e.bids)||(this.bids=b(e.bids,this.quote,this.balance,"bids")),g(this.asks,e.asks)||(this.asks=b(e.asks,this.quote,this.balance,"asks"))}},{key:"updateOffersPrices",value:function(){this.bids&&this.set("bids",y(this.bids,this.quote)),this.asks&&this.set("asks",y(this.asks,this.quote))}},{key:"mergeOffers",value:function(e){if(this.childs.length<2)this.set(e,this.childs[0]&&this.childs[0][e]);else{var t=this.childs.reduce(function(t,n){return n[e]?t.concat(n[e]):t},[]);if(t.length){var n="bids"===e?function(e,t){return t.price-e.price}:function(e,t){return e.price-t.price},r=0,i=0,o=0;this.set(e,t.sort(n).map(function(e){var t=Object.assign({},e);return t.volume=r+=m(e.amount*e.price),t.baseVolume=i+=+e.amount,t.quoteVolume=o+=+e.quoteAmount,t}))}else this[e]=null}}},{key:"addChild",value:function(e){var t=this;this.childs.push(e),this.watch(e,"bids",function(){return t.mergeOffers("bids")}),this.watch(e,"asks",function(){return t.mergeOffers("asks")})}}],[{key:"offersCallBuilder",value:function(e){var t=new d.Asset(e.code,e.anchor.address),n=d.Asset.native();return l.resolve.server().orderbook(t,n)}}]),t}();function g(e,t){if(!e)return!1;if(e.length!==t.length)return!1;for(var n in e.length){if(e[n].amount!==t[n].amount)return!1;if(e[n].price!==t[n].price)return!1}return!0}function b(e,t,n,r){return e.forEach(function(e){e.volume=void 0,e.baseVolume=void 0,e.basePrice=+e.price,e.quoteAmount=+e.amount,e.quoteVolume=void 0,e.balance=n,e.side=r}),y(e,t)}function y(e,t){var n=0,r=0,i=0;return e.forEach(function(e){"asks"===e.side?e.quoteAmount=m(e.amount*e.basePrice):e.amount=m(e.quoteAmount/e.basePrice),e.price=m(e.basePrice*t.price),e.volume=n+=m(e.amount*e.price),e.baseVolume=i+=+e.amount,e.quoteVolume=r+=+e.quoteAmount}),e}v.define("bestBid","bids",function(){return this.bids&&this.bids[0]&&this.bids[0].price}),v.define("bestAsk","asks",function(){return this.asks&&this.asks[0]&&this.asks[0].price}),v.define("price",["bestBid","bestAsk"],function(){return this.base.globalPrice?(this.bestBid+this.bestAsk)/2:this.marketPrice()}),v.define("spread",["bestBid","bestAsk"],function(){return this.bestAsk-this.bestBid}),v.define("spread%",["spread","bestAsk"],function(){return 100*this.spread/this.bestAsk}),v.prototype.findOffer=function(e,t){var n,r=this[e],i=this.childs?this.childs.length:1,o={};for(var a in r){var s=r[a];if(!t||t(s)){var c=s.balance.anchor.address;if(o[c]||(o[c]=!0,n=s),Object.keys(o).length===i)break}}return n},v.prototype.findAsk=function(e){return this.findOffer("asks",e)},v.prototype.findBid=function(e){return this.findOffer("bids",e)},v.prototype.marketPrice=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bids",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,n=this.findOffer(e,function(e){return e.quoteVolume>t});return n?n.price:0}},function(e,t,n){var r=n(3),i=n(8),o=n(7),a=n(11),s=n(10),c=n(9),u=n(33),l=n(12),f=n(86),d=n(43),h=n(62),p=n(13),m=n(32),v=m.fixed7,g=m.positive,b=m.negative,y=e.exports=function(e){"use strict";function t(e){var n;return r(this,t),(n=i(this,o(t).call(this))).id=k(e),n.code=e.asset_code||"XLM",n.anchor=f.resolve(e.asset_issuer||"stellar.org"),t.table[n.id]=a(n),"XLM"===n.id||n.id in f.known?(n.asset=d.resolve(f.known[n.id]||n.code),n.known=!0):(n.asset=d.resolve(n.id),n.known=!1),n.amount=+e.balance,n.buying=+e.buying_liabilities,n.offers=new u,n.selling=+e.selling_liabilities,n.asset.balances.push(a(n)),"XLM"===n.code?n.asset.project("price",a(n)):(n.orderbook=h.forBalance(a(n),d.resolve("XLM")),n.orderbook.project("price",a(n))),n}return c(t,l),s(t,null,[{key:"resolve",value:function(e,n){var r=e?"".concat(e,":").concat(n):"XLM";return t.table[r]}},{key:"ingest",value:function(e){var n=k(e),r=t.table[n];return r?(r.amount=+e.balance,r.buying=+e.buying_liabilities,r.selling=+e.selling_liabilities,r):new t(e,n)}}]),t}();function k(e){return e.asset_code?"".concat(e.asset_code,":").concat(e.asset_issuer):"XLM"}y.table={},y.define("value",["amount","price"],function(){return 0===this.amount?0:this.amount*this.price}),y.define("targetMin",["targetAmount"],function(){return v(this.targetAmount*(1-p.balanceTargetDeviation))}),y.define("targetMax",["targetAmount"],function(){return v(this.targetAmount*(1+p.balanceTargetDeviation))}),y.define("targetMinDiff",["amount","targetMin"],function(){return v(this.targetMin-this.amount)}),y.define("targetMaxDiff",["amount","targetMax"],function(){return v(this.targetMax-this.amount)}),y.define("sizeMin",["targetMinDiff"],function(){return b(this.targetMinDiff)}),y.define("sizeMax",["targetMaxDiff"],function(){return g(this.targetMaxDiff)}),y.define("underMin",["targetMinDiff"],function(){return b(-this.targetMinDiff)}),y.define("overMax",["targetMaxDiff"],function(){return g(-this.targetMaxDiff)})},function(e,t,n){var r=n(36),i=n(3),o=n(10),a=n(8),s=n(7),c=n(11),u=n(9),l=n(12),f=n(0).setHiddenProperty,d=n(90),h=n(91),p=n(65),m=function(e){"use strict";function t(){var e;i(this,t),e=a(this,s(t).call(this));for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return r.length&&"FORM"===r[0].tagName?(f(c(e),"domNode",r[0]),r[1]&&Object.assign(e.domNode,r[1])):f(c(e),"domNode",p.element.apply(p,["form"].concat(r))),e.domNode.addEventListener("submit",function(){e.domNode.getAttribute("method")||event.preventDefault(),e.trigger("submit")}),t.bindInputs(c(e),e.domNode),f(c(e),"dom",h(e.domNode)),e.dom.status||(e.dom.status=[t.status()],p.append(e.domNode,e.dom.status[0])),e}return u(t,l),o(t,[{key:"submit",value:function(){this.domNode.submit()}},{key:"reset",value:function(){this.domNode.reset()}},{key:"report",value:function(e){var t=this.dom.status[0];if(t){t.className=e;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];p.rewrite.apply(p,[t].concat(r))}}},{key:"info",value:function(e){this.report("info",e,t.spinner())}},{key:"error",value:function(e){throw this.report("error",e.message||e),e instanceof Error?e:new Error(e)}}]),t}();function v(e,t){e.name&&d(t,e.name,e)}m.listen("change",function(e){return e.report(null)}),m.bindInputs=function(e,t){p.walk(t,v,e)},m.enable=function(e,t){e.disabled=!1,Object.assign(e,t)},m.disable=function(e,t){e.enabled=!0,Object.assign(e,t)},m.hide=p.hide,m.show=p.show,m.element=p.element,m.status=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return m.element("p",{alias:"status"},e)},m.spinner=function(){return m.element("span",{className:"spinner"})},m.label=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.element.apply(m,["label"].concat(t))},m.button=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.length||(n=[e.value]),m.element.apply(m,["button",e].concat(r(n)))},m.control=function(e,t){var n=Object.assign({required:!0},t);return m.element(e,n)},m.textarea=function(e){return m.control("textarea",e)},m.selector=function(e){var t,n=m.control("select",e);if(n.values&&p.append.apply(p,[n].concat(r((t=n.values)instanceof Array?t.map(function(e){return p.element("option",{value:e},e)}):Object.keys(t).map(function(e){return p.element("option",{value:e},t[e])})))),n.placeholder){var i=p.element("option",{value:"",disabled:!0,selected:!0,hidden:!0},n.placeholder);p.unshift(n,i),null!=e.selectedIndex&&e.selectedIndex++}return e.selectedIndex?n.selectedIndex=e.selectedIndex:e.value&&(n.value=e.value),n},m.input=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=m.control("input",t);return n.type=e,n};["checkbox","color","date","email","file","hidden","image","month","number","password","radio","range","tel","text","time","url","week"].forEach(function(e){return m[e]=function(t){return m.input(e,t)}}),m.datetime=function(e){return m.input("datetime-local",e)},e.exports=m},function(e,t,n){var r=Object.create(n(1));e.exports=r,r.element=function(e){for(var t,n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return i[0]&&i[0].constructor===Object&&void 0===i[0].domNode&&(t=i.shift()),r.create.apply(r,[e,t].concat(i))},r.walk=function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];t.apply(void 0,[e].concat(i)),e.childNodes.forEach(function(e){return r.walk.apply(r,[e,t].concat(i))})},r.unshift=function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t++)e.insertBefore(t+1<1||arguments.length<=t+1?void 0:arguments[t+1],e.childNodes[t])}},,function(e,t,n){var r=n(54),i=n(36),o=n(3),a=n(8),s=n(7),c=n(10),u=n(9),l=n(37).CosmicLink,f=n(33),d=n(30),h=n(12),p=n(4).__,m=n(13),v=n(32),g=v.positive,b=v.negative,y=v.fixed7,k=v.clamp,w=v.absoluteMin,T=v.arraySum,O=v.arrayScale,A=e.exports=function(e){"use strict";function t(e,n){var r;o(this,t),(r=a(this,s(t).call(this))).type=e,r.method=t.type[r.type],r.operations=new f,r.orderbook=n;for(var i=arguments.length,c=new Array(i>2?i-2:0),u=2;u<i;u++)c[u-2]=arguments[u];return r.parameters=c,r.operations.listen("update",function(){r.compute(["cosmicLink","description"])}),r.refresh(),r}return u(t,h),c(t,null,[{key:"rebalance",value:function(e){if("XLM"!==e.asset.code){var n=new t("balance",e.asset.orderbook,e);return n.watch(e,"amount",function(){return n.refresh()}),n.watch(e.asset.orderbook,["bids","asks"],function(){return n.refresh()}),e.asset.offers.listen("change",function(){return n.refresh()},n),n}}}]),c(t,[{key:"refresh",value:function(){this.operations.splice(0,this.operations.length),this.operations.trigger("update"),this.method.apply(this,[this].concat(i(this.parameters))),this.trigger("refresh")}},{key:"getOperation",value:function(e,t){var n="".concat(e.balance.anchor.name,":").concat(t?e.price:"take"),r=this.operations.find(function(e){return e.id===n});if(r)return r;var i={id:n};return this.operations.push(i),i}},{key:"addOperation",value:function(e,t){var n=this.getOperation(e,t>0);this.setOperation(n,e,Number(t)||n.amount)}},{key:"setOperation",value:function(e,t,n){e.amount=y(n),e.cost=n*t.price,e.offer=t,this.operations.trigger("update")}}]),t}();function S(e){return e.amount>0&&"bids"===e.offer.side||e.amount<0&&"asks"===e.offer.side?"buy":"sell"}function E(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.asset.orderbook,r=function(e,t){var n=Math.abs(t),r="quantity"===e.mode||0===e.amount;return function(e){return t>=e.balance.sizeMin&&t<=e.balance.sizeMax&&e.baseVolume>n*m.skipMarginalOffers&&(r||n*e.basePrice>m.minOfferValue)}}(e,t);A.type.limit(e.order,t,{orderbook:n,filter:r})}function I(e,t){var n=e.asset.balances,r=g(t)?"underMin":"overMax",i=T(n,r),o=w(t,i),a=O(n,o,r);if(o!==t){var s=g(t)?"sizeMax":"sizeMin",c=t-i,u=n.map(function(e){return e[s]-e[r]});O(u,c).forEach(function(e,t){return a[t]+=e})}n.forEach(function(t,n){var r=y(a[n]);E(e,r,t.orderbook)})}A.define("cosmicLink","operations",function(){return A.operationsToCosmicLink(this.operations)}),A.define("description","operations",function(){return A.operationsToDescription(this.operations)}),A.operationsToCosmicLink=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=new l({memo:"Equilibre.io",maxTime:"+5",source:m.portfolio.accountId});return e.forEach(function(e){t.addOperation("manageOffer",function(e){var t,n=e.offer,r=n.balance.code+":"+n.balance.anchor.address;t="buy"===S(e)?{buying:r,selling:"XLM",amount:y(e.amount*n.price_r.n/n.price_r.d),price:{n:n.price_r.d,d:n.price_r.n}}:{buying:"XLM",selling:r,amount:e.amount,price:n.price_r};return t.offerId=e.offer.id,t}(e))}),t},A.operationsToDescription=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=[];return e.forEach(function(e){"buy"===S(e)?t.push("\n".concat(p("Buy")," ").concat(d(e.amount)," ").concat(e.offer.balance.code," ").concat(p("at")," ").concat(d(e.offer.price)," ").concat(m.currency,"\n      ")):t.push("\n".concat(p("Sell")," ").concat(d(e.amount)," ").concat(e.offer.balance.code," ").concat(p("at")," ").concat(d(e.offer.price)," ").concat(m.currency,"\n      "))}),t},A.type={},A.type.market=function(e,t){if(t){var n=t>0?"asks":"bids",r=Math.abs(t),i=e.orderbook.findOffer(n,function(e){return e.baseVolume>r});e.addOperation(i,r)}},A.type.limit=function(e,t,n){var r=n.orderbook,i=n.filter;if(t){var o=t>0?"bids":"asks",a=(r||e.orderbook).findOffer(o,i);a&&e.addOperation(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.spreadTightening,n=Object.assign({},e),r=t*e.balance.asset.orderbook["spread%"]/100;"bids"===e.side?n.price=e.price*(1+r):n.price=e.price*(1-r);e.balance.asset.globalPrice&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.maxSpread/2,n=e.balance.asset.price;"bids"===e.side?e.price=k(e.price,n*(1-t),n):e.price=k(e.price,n,n*(1+t))}(n);return function(e){var t=e.balance.orderbook.quote;for(e.price_r={n:d(1e10*e.price,0),d:d(1e10*t.price,0)};e.price_r.n>999999999||e.price_r.d>999999999;)e.price_r.n=d(e.price_r.n/10,0),e.price_r.d=d(e.price_r.d/10,0)}(n),n}(a),Math.abs(t))}},A.type.balance=function(e,t){var n=t.asset,r=n.orderbook;if(null!=t.amount&&0!==t.amountDelta)if(r.bestBid&&r.bestAsk){if(n.liabilities)if(n.offers.filter(function(e){return!e.outdated}).length)return void(e.description=[p("Rebalancing...")]);!function(e){var t=[];if(e.asset.balances.forEach(function(e){null!=e.orderbook.price?t.push(e):e.targetAmount=null}),!t.length)return;if(1===t.length)return t[0].targetAmount=e.amount;var n=y(e.amount/t.length);t.forEach(function(e){return e.targetAmount=n})}(t),!function(e){var t=e.asset.balances;return!(T(t,"underMin")&&T(t,"overMax"))}(t)?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.amountDiff,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:m.anchorsRebalanceRiskMax,r=e.asset.balances,i=-T(r,"underMin"),o=T(r,"overMax"),a=Math.max(i-g(t),o+b(t)),s=Math.abs(e.valueDiffP),c=e.amount*g(n-s),u=Math.min(a,c),l=y(u+g(t)),f=y(u-b(t));I(e,l),I(e,-f)}(t,t.amountDiff):!function(e,t){return!!e.asset.balances.filter(function(e){return e.sizeMin<=t&&t<=e.sizeMax}).length}(t,t.amountDiff)?I(t,t.amountDiff):E(t,t.amountDiff)}else e.description=[p("Fetching orderbook...")]};var N=function(e){A[e]||(A[e]=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r(A,[e].concat(n))})};for(var x in A.type)N(x)},,,,,,,,,,,,,function(e,t,n){var r=n(5),i=n(6),o=n(3),a=n(8),s=n(7),c=n(11),u=n(10),l=n(9),f=n(45),d=n(37),h=n(33),p=n(12),m=n(0).timeout,v=n(4).__,g=n(43),b=n(63),y=n(13),k=n(87),w=n(32).arraySum;function T(){return O.apply(this,arguments)}function O(){return(O=i(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.resolve.horizon(),e.prev=1,e.next=4,f.get(t);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),new Error(v("Can't connect to the Stellar blockchain"));case 9:case"end":return e.stop()}},e,null,[[1,6]])}))).apply(this,arguments)}e.exports=function(e){"use strict";function t(e){var n;return o(this,t),n=a(this,s(t).call(this)),console.log(c(n)),n.accountId=e,n.assets=new h,n.balances=new h,n.accountCallBuilder=t.accountCallBuilder(e),n.define("total","assets",function(){var e=n.assets.filter(function(e){return e.isSupported});return w(e,"value")}),n.assets.mirror(function(e){return n.watch(e,["value","isSupported"],function(){return n.compute("total")})}),n.new=!0,n}return l(t,p),u(t,null,[{key:"resolve",value:function(){var e=i(r.mark(function e(n){var i,o;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:return e.next=4,d.resolve.address(n);case 4:if(!(i=e.sent).memo){e.next=7;break}throw new Error(v("Invalid federated address: shared account."));case 7:return e.next=9,d.resolve.isAccountEmpty(i.account_id);case 9:if(!e.sent){e.next=11;break}throw new Error(v("Empty account"));case 11:return o=new t(i.account_id),d.config.source=o.address=n,o.streamAccount(),e.abrupt("return",o);case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),u(t,[{key:"streamAccount",value:function(){var e=i(r.mark(function e(){return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,this.getAccount();case 3:return e.next=5,m(5e3);case 5:e.next=0;break;case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getAccount",value:function(){var e=i(r.mark(function e(){var t;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.accountCallBuilder.call();case 3:t=e.sent,this.ingest(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"ingest",value:function(){var e=i(r.mark(function e(t){var n,i,o=this;return r.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(i in this.account=t,n=function(e){var n=b.ingest(t.balances[e]),r=n.asset;-1===o.assets.indexOf(r)?(o.assets.push(r),o.balances.push(n),r.watch(o,"total",function(){return r.compute("share")}),r.getInfo()):-1===o.balances.indexOf(n)&&o.balances.push(n)},t.balances)n(i);if(!this.new){e.next=11;break}return delete this.new,e.next=7,g.refreshPrices();case 7:return this.offers=k.forPortfolio(this),e.next=10,this.offers.stream();case 10:this.trigger("open");case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}],[{key:"accountCallBuilder",value:function(e){return d.resolve.server().accounts().accountId(e)}}]),t}(),g.define("share","value",function(){return y.portfolio&&this.value/y.portfolio.total})},,,,,,function(e,t,n){var r=n(3),i=n(8),o=n(7),a=n(11),s=n(10),c=n(9),u=n(55),l=n(0),f=n(12),d=e.exports=function(e){"use strict";function t(e){var n;return r(this,t),(n=i(this,o(t).call(this))).address=e,n.alias=u.all[e],n.name=l.shorter(n.alias||n.address),t.all[e]=a(n),n.assets={},n}return c(t,f),s(t,null,[{key:"resolve",value:function(e){return t.all[e]||new t(e)}}]),t}();d.all={},d.known={"USD:GDUKMGUGDZQK6YHYA5Z6AY2G4XDSZPSZ3SW5UN3ARVMO6QSRDWP5YLEX":"USD","WSD:GDSVWEA7XV6M5XNLODVTPCGMAJTNBLZBXOFNQD3BNPNYALEYBNT6CE2V":"USD","USD:GDSRCV5VTM3U7Y3L6DFRP3PEGBNQMGOWSRTGSBWX6Z3H6C7JHRI4XFJP":"USD","USD:GBUYUAI75XXWDZEKLY66CFYKQPET5JR4EENXZBUZ3YXZ7DS56Z4OKOFU":"USD","CNY:GAREELUB43IRHWEASCFBLKHURCGMHE5IF6XSE7EXDLACYHGRHM43RFOX":"CNY","XCN:GCNY5OXYSY4FKHOPT2SPOQZAOEIGXB5LBYW3HVU3OWSTQITS65M5RCNY":"CNY","BCNY:GBCNYBHAAPDSU3UIHXXQTHYZVSBJBI4YUNWXMKJBCPDHTVYR75G6NFHD":"CNY","EURT:GAP5LETOV6YIE62YAM56STDANPRDO7ZFDBGSNHJQIYGGKSMOZAHOOS2S":"EUR","SLT:GCKA6K5PCQ6PNF5RQBF7PQDJWRHO6UOGFMRLK3DYHDOI244V47XKQ4GP":null,"MOBI:GA6HCMBLTZS5VYYBCATRBRZ3BZJMAFUDKYYF6AH6MVCMGWMRDNSWJPIH":null,"SHX:GDSTRSHXHGJ7ZIVRBXEYE5Q74XUVCUSEKEBR7UCHEUUEK72N7I7KJ6JH":null,"RMT:GDEGOXPCHXWFYY234D2YZSPEJ24BX42ESJNVHY5H7TWWQSYRN5ZKZE3N":null,"TERN:GDGQDVO6XPFSY4NMX75A7AOVYCF5JYGW2SHCJJNWCQWIDGOZB53DGP6C":null,"PEDI:GBVUDZLMHTLMZANLZB6P4S4RYF52MVWTYVYXTQ2EJBPBX4DZI2SDOLLY":null,"GRAT:GAJ7V3EMD3FRWAPBEJAP7EC4223XI5EACDZ46RFMY5DYOMCIMWEFR5II":null,"REPO:GCZNF24HPMYTV6NOEHI7Q5RJFFUI23JKUKY3H3XTQAFBQIBOHD5OXG3B":null,"BTC:GATEMHCCKCY67ZUCKTROYN24ZYT5GK4EQZ65JJLDHKHRUZI3EUEKMTCH":null,"BTC:GAUTUYY2THLF7SGITDFMXJVYH3LHDSMGEAKSBU267M2K7A3W543CKUEF":null,"BTC:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P":null,"BTC:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5":null,"ETH:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P":null,"ETH:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5":null,"ETH:GBETHKBL5TCUTQ3JPDIYOZ5RDARTMHMEKIO2QZQ7IOZ4YC5XV3C2IKYU":null,"ETH:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR":null,"LTC:GC5LOR3BK6KIOK7GKAUD5EGHQCMFOGHJTC7I3ELB66PTDFXORC2VM5LP":null,"LTC:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5":null,"LTC:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P":null,"XRP:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5":null,"XRP:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P":null,"KIN:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR":null,"BAT:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR":null,"ZRX:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR":null,"BCH:GAEGOS7I6TYZSVHPSN76RSPIVL3SELATXZWLFO4DIAFYJF7MPAHFE7H4":null,"STEEM:GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM":null,"SBD:GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM":null,"LINK:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR":null}},function(e,t,n){var r=n(11),i=n(36),o=n(5),a=n(6),s=n(3),c=n(10),u=n(8),l=n(7),f=n(9),d=n(37),h=n(88),p=n(33),m=n(12),v=n(0).setHiddenProperty,g=n(0).day,b=n(43),y=n(63),k=n(32).fixed7,w=function(e){"use strict";function t(){return s(this,t),u(this,l(t).apply(this,arguments))}return f(t,p),c(t,[{key:"stream",value:function(){var e=a(o.mark(function e(){var t,n=this,r=arguments;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:15e3,e.abrupt("return",this.get().then(function(){return setTimeout(function(){return n.stream()},t)}));case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=a(o.mark(function e(){var t;return o.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h(this.callBuilder,{limit:200});case 3:t=e.sent,this.ingest(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"ingest",value:function(e){this.forEach(function(e){return e.alive=!1});var t=e.map(function(e){return T.ingest(e)}).filter(function(e){return e});this.splice.apply(this,[0,0].concat(i(t))),this.clean()}},{key:"clean",value:function(){for(var e=this.length-1;e>-1;e--){var t=this[e];t.alive||(this.splice(e,1),t.destroy())}}}],[{key:"forPortfolio",value:function(e){var n=t.forAccount(e.accountId);return v(n,"portfolio",e),n}},{key:"forAccount",value:function(e){var n=new t;return v(n,"accountId",e),v(n,"callBuilder",t.callBuilder(e)),n}},{key:"callBuilder",value:function(e){return d.resolve.server().offers("accounts",e)}}]),t}(),T=function(e){"use strict";function t(e){var n;s(this,t),(n=u(this,l(t).call(this))).intern=O(e),t.table[n.intern]=r(n);var i=b.resolve("XLM"),o=e.buying.asset_code?e.buying:e.selling;return n.balance=y.resolve(o.asset_code,o.asset_issuer),n.asset=n.balance.asset,n.side=e.buying.asset_code?"buy":"sell",n.define("price","rawPrice","sell"===n.side?function(){return i.price*n.rawPrice}:function(){return i.price/n.rawPrice}),n.watch(i,"price",function(){return n.compute("price")}),n.update(e),n.balance.offers.push(r(n)),n.asset.offers.push(r(n)),n.listen("destroy",function(){delete t.table[n.intern],n.balance.offers.splice(n.balance.offers.indexOf(r(n)),1),n.asset.offers.splice(n.asset.offers.indexOf(r(n)),1)}),n}return f(t,m),c(t,null,[{key:"resolve",value:function(e){return t.table[O(e)]}},{key:"ingest",value:function(e){var n=t.resolve(e);if(!n)return new t(e);n.update(e)}}]),c(t,[{key:"update",value:function(e){Object.assign(this,e),this.alive=!0,this.rawPrice=e.price,this.compute("price"),this.rawAmount=e.amount,"buy"===this.side&&(this.amount=k(this.rawAmount*this.rawPrice)),this.date=g(this.last_modified_time),this.outdated=this.date!==g()}}]),t}();function O(e){return"".concat(e.id,"-").concat(e.last_modified_ledger)}T.table={},e.exports=w},,function(e,t,n){var r=e.exports,i=n(1),o=i.create("div",{hidden:!0});i.append(document.body,o),Object.assign(o.style,{position:"fixed",zIndex:999,top:0,width:"100%",height:"100%"}),r.enable=function(){return i.show(o)},r.disable=function(){return i.hide(o)}},function(e,t,n){var r=n(12);e.exports=function(e,t,n,r){var o=i[n.tagName];o?o(e,t,n,r):e[t]=n[r||"value"]};var i={};function o(e,t,n,i,o){i.addEventListener(e,function(){t[n]=i[o],i.setCustomValidity("")}),t instanceof r&&t.link(n,i,o,null,{init:!1})}i.SELECT=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"value";e[t]=n[r],-1!==i.SELECT.interactive.indexOf(r)&&o("change",e,t,n,r)},i.SELECT.interactive=["selectedIndex","selectedOptions","value"],i.TEXTAREA=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"value";e[t]=n[r],"value"===r&&o("input",e,t,n,r)},i.INPUT=function(e,t,n,r){e[t]=n[r],"radio"===n.type?i.radio.apply(i,arguments):"checkbox"===n.type?i.checkbox.apply(i,arguments):r&&"value"!==r||o("input",e,t,n,r||"value")},i.radio=function(e,t,n){var r=function(){n.checked&&(e[t]=n.value)};n.addEventListener("change",r),r()},i.checkBox=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"checked";e[t]=n[r],"checked"===r&&o("change",e,t,n,r)}},function(e,t,n){var r=n(0).timeout,i=n(65);function o(e,t){!function(e,t){e.className?(t[e.className]||(t[e.className]=[]),t[e.className].push(e)):e.alias?(t[e.alias]=e,delete t[e.alias]):e.name?t[e.name]=e:e.id&&(t[e.id]=e)}(e,t),function(e){if(!e.label||"OPTION"===e.tagName)return;var t=i.element("label",{for:e}),n=i.element("span",e.label);i.replace(e,t),i.append(t,n,e),delete e.label}(e),function(e){var t=e.validate;if(!t||!e.hasProperty("oninput"))return;e.addEventListener("input",function(){e.setCustomValidity(""),r(0).then(function(){return function(e,t){try{t(e.value)}catch(t){e.setCustomValidity(t.message),e.reportValidity(),console.error(t)}}(e,t)})}),delete e.validate}(e)}e.exports=function(e){var t={};return i.walk(e,o,t),t}},function(e,t){t.isOverflowing=function(e){return e.scrollHeight>e.clientHeight||e.scrollWidth>e.clientWidth}},function(e,t,n){var r=n(10),i=n(3),o=n(8),a=n(7),s=n(11),c=n(9),u=n(29),l=n(30),f=n(44),d=n(4).__,h=n(37).CosmicLink,p=n(52),m=n(13),v=function(e){"use strict";function t(e){var n;i(this,t),(n=o(this,a(t).call(this,"\n<section>\n  <h2>".concat(d("Activity"),"</h2>\n  %selector\n  %view\n</section>\n    ")))).portfolio=e;var r=new f;return r.project("view",s(n)),r.add("offers",d("Open Orders"),new t.Offers(e),"select"),n}return c(t,u),t}();v.Offers=function(e){"use strict";function t(e){var n;return i(this,t),(n=o(this,a(t).call(this,"\n<section>\n  <table>\n    <tr>\n      <th>".concat(d("Date"),"</th>\n      <th>").concat(d("Asset"),"</th>\n      <th>").concat(d("Direction"),"</th>\n      <th>").concat(d("Amount"),"</th>\n      <th>").concat(d("Price"),' (%globalCurrency)</th>\n    </tr>\n    %formatOffer:offers...\n    <tr><td colspan="5" align="center" onclick=%cancelOffers>\n      <h3>').concat(d("Cancel All"),'</h3>\n    </td></tr>\n  </table>\n</section>\n\n<p class="note">\n  ').concat(d("All orders are passed against Stellar Lumens (XLM)."),"\n  ").concat(d("For your comfort, prices are displayed in their %%globalCurrency equivalent."),"\n  ").concat(d("However, those converted values will change according to XLM price movement."),"\n</p>\n    ")))).portfolio=e,n.offers=e.offers,n.globalCurrency=m.currency,n}return c(t,u),r(t,[{key:"formatOffer",value:function(e){return new v.Offer(e)}},{key:"cancelOffers",value:function(){var e=this;if(this.offers.length){var t={memo:"Equilibre.io",network:"public",maxTime:"+5",source:this.portfolio.accountId},n=new h(t);this.offers.forEach(function(e){n.addOperation("manageOffer",{offerId:e.id,amount:0})}),new p(n.uri).listen("destroy",function(){e.portfolio.getAccount(),e.portfolio.offers.get()})}}}]),t}(),v.Offer=function(e){"use strict";function t(e){var n;return i(this,t),(n=o(this,a(t).call(this,'\n<tr>\n  <td>%formatDate:last_modified_time</td>\n  <td>\n    <img src=%image alt="">\n    <span>%name / %anchor</span>\n  </td>\n  <td>%side</td>\n  <td align="right">%nice:amount</td>\n  <td align="right">%nice:price</td>\n</tr>\n    '))).offer=e,e.project(["last_modified_time","amount","price"],s(n)),n.name=e.asset.code,n.side="buy"===e.side?d("Buy"):d("Sell"),n.anchor=e.balance.anchor.name,e.asset.link("image",s(n)),n}return c(t,u),r(t,[{key:"nice",value:function(e){return l(e)}},{key:"formatDate",value:function(e){return(e?new Date(e):new Date).toLocaleDateString()}}]),t}(),e.exports=v},function(e,t,n){var r=n(3),i=n(10),o=n(8),a=n(7),s=n(11),c=n(9),u=n(66),l=n(95);n(96);var f=n(29),d=n(30),h=n(44),p=n(4).__,m=n(97),v=n(13),g=n(61),b=function(e){"use strict";function t(e){var n;return r(this,t),(n=o(this,a(t).call(this,"\n<section><h2>".concat(p("Portfolio"),': %total %currency</h2>\n  %summary\n  %chart\n\n  <p class="note" align="center">\n    ').concat(p("Anchor prices are from Stellar DEX")," /\n    ").concat(p("Global prices are from %%coingecko when available."),"\n    </p>\n\n</section>")))).portfolio=e,e.project("total",s(n),function(e){return d(e,2)}),n.currency=v.currency,n.summary=new t.Summary(s(n)),n.coingecko=new f('<a target="_blank" rel="noopener" href="https://coingecko.com">coingecko</a>'),n}return c(t,f),i(t,[{key:"select",value:function(e){this.chart&&this.chart.destroy(),e&&(e.isTether||e.apiId)&&e.code!==v.currency?this.chart=new t.Chart(e):this.chart=null}}]),t}();function y(e){return{name:e.name,code:e.code,asset:e,y:+d(e.value,2),amount:d(e.amount),price:d(e.price),percentage:e.percentage}}b.Summary=function(e){"use strict";function t(e){var n;r(this,t);var i=new h;return n=o(this,a(t).call(this,"%nav <section>%view</section>",i)),i.add("table",p("Table"),new b.Table(e)),i.add("graph",p("Graph"),function(){return new b.Graph(e)}),i.listen("select",function(e){return localStorage["PortfolioSummary.tab"]=e}),i.select(localStorage["PortfolioSummary.tab"]||"table"),n}return c(t,f),t}(),b.Table=function(e){"use strict";function t(e){var n;return r(this,t),(n=o(this,a(t).call(this,"\n<table>\n  <tr>\n    <th>".concat(p("Name"),"</th>\n    <th>").concat(p("Anchor"),"</th>\n    <th>").concat(p("Amount"),"</th>\n    <th>").concat(p("Price"),"</th>\n    <th>").concat(p("Value"),"</th>\n  </tr>\n  %assetsGui...\n</table>\n")))).parent=e,n.assetsGui=e.portfolio.assets.mirror(function(e){var t=new m(e);return t.domNode.onclick=function(){return n.select(t)},t}),n.watch(e.portfolio,"total",function(){return n.sort()}),n}return c(t,f),i(t,[{key:"sort",value:function(){this.assetsGui.sort(function(e,t){return t.asset.value-e.asset.value})}},{key:"select",value:function(e){this.selected&&(this.selected.domNode.className="",this.selected.simpleView()),this.selected===e?(this.parent.select(),this.selected=null):(this.parent.select(e.asset),e.domNode.className="selected",this.selected=e,e.detailledView())}}]),t}(),b.Graph=function(e){"use strict";function t(e){var n;return r(this,t),(n=o(this,a(t).call(this,'<div -ref=%container align="center"></div>'))).parent=e,n.listen("destroy",function(){return n.chart&&n.chart.destroy()}),n.watch(e.portfolio,"total",function(){setTimeout(function(){return n.makePie()},1)}),n}return c(t,f),i(t,[{key:"makePie",value:function(){var e=this;this.chart&&this.chart.destroy(),this.chart=u.chart(this.container,{title:"",legend:{enabled:!1},chart:{type:"pie"},tooltip:{pointFormat:"\n".concat(p("Amount"),": {point.amount} {point.code}<br>\n").concat(p("Price"),": {point.price} ").concat(v.currency,"<br>\n<b>").concat(p("Value"),": {point.y} ").concat(v.currency,"</b>\n")},plotOptions:{pie:{dataLabels:{format:"{point.amount} {point.code}<br>({point.percentage:.0f}%)"},point:{events:{select:function(t){return e.parent.select(t.target.options.asset)},legendItemClick:function(){return!1}}}}},series:[{name:p("Amount"),colorByPoint:!0,ignoreHiddenPoint:!0,data:this.parent.portfolio.assets.filter(function(e){return e.value}).map(y).sort(function(e,t){return t.y-e.y})}]})}}]),t}(),b.Chart=function(e){"use strict";function t(e){var n;return r(this,t),(n=o(this,a(t).call(this,"\n      <section><h3>".concat(e.code," ").concat(p("to")," ").concat(v.currency,"</h3>\n        <div -ref=%container><p>").concat(p("Loading..."),"</p></div>\n      </section>\n    ")))).asset=e,n.listen("destroy",function(){return n.chart&&n.chart.destroy()}),g.assetHistory(e).then(function(e){return n.makeChart(e)}),n}return c(t,f),i(t,[{key:"makeChart",value:function(e){this.chart=l.stockChart(this.container,{rangeSelector:{selected:2},chart:{backgroundColor:"#fbfbfd"},yAxis:[{labels:{align:"left"},height:"80%",resize:{enabled:!0}},{labels:{align:"left"},top:"80%",height:"20%",offset:0}],series:[{type:"spline",name:"Price",data:e.map(function(e){return[e.time,+d(e.price)]})},{type:"column",name:"Volume",data:e.map(function(e){return[e.time,e.volume]}),yAxis:1}],credits:{enabled:!1}})}}]),t}(),e.exports=b},,function(e,t,n){var r=n(66);r.theme={chart:{backgroundColor:"#fbfbfd"},tooltip:{style:{fontSize:"14px"}},credits:{enabled:!1},plotOptions:{pie:{allowPointSelect:!0,animation:!1,cursor:"pointer",dataLabels:{style:{fontSize:"14px"}}}},responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{enabled:!0},plotOptions:{pie:{showInLegend:!0,dataLabels:{format:"{point.percentage:.0f}%",distance:-20}}}}}]},colors:["rgba(231,  76,  60, 0.8)","rgba(230, 126,  34, 0.8)","rgba(242, 202,  39, 0.8)","rgba(46,  204, 112, 0.8)","rgba(52,  152, 219, 0.8)","rgba(155,  89, 182, 0.8)","rgba(231,  76,  60, 0.6)","rgba(230, 126,  34, 0.6)","rgba(242, 202,  39, 0.6)","rgba(46,  204, 112, 0.6)","rgba(52,  152, 219, 0.6)","rgba(155,  89, 182, 0.6)","rgba(231,  76,  60, 0.4)","rgba(230, 126,  34, 0.4)","rgba(242, 202,  39, 0.4)","rgba(46,  204, 112, 0.4)","rgba(52,  152, 219, 0.4)","rgba(155,  89, 182, 0.4)"]},r.setOptions(r.theme)},function(e,t,n){var r=n(3),i=n(10),o=n(8),a=n(7),s=n(11),c=n(9),u=n(29),l=n(1),f=n(30),d=n(4).__,h=function(e){"use strict";function t(e){var n;r(this,t),(n=o(this,a(t).call(this,'\n<tr %style>\n  <td align="left">\n    <img src=%image alt="">\n    <span>%name</span>\n  </td>\n  <td align="left">\n    <div hidden=%simple>%anchors...</div>\n    <div %class>%anchorTotal</div>\n  </td>\n  <td align="right">\n    <div hidden=%simple>%amounts...</div>\n    <div %class>%amountTotal</div>\n  </td>\n  <td align="right">\n    <div hidden=%simple>%prices...</div>\n    <div %class title=%priceDetails>%priceTotal</div>\n  </td>\n  <td align="right">\n    <div hidden=%simple>%values...</div>\n    <div %class>%valueTotal</div>\n  </td>\n</tr>\n    '))).asset=e,n.name=e.code,n.anchors=e.balances.mirror(function(e){return m(e.anchor,"name")}),n.amounts=e.balances.mirror(function(e){return m(e,"amount",f)}),n.prices=e.balances.mirror(function(e){return n=m(t=e,"price",f),t.trap("orderbook",function(){t.orderbook&&t.orderbook.trap(["bestAsk","bestBid","spread%"],function(){n.title=v(t.orderbook)})}),n;var t,n}),n.values=e.balances.mirror(function(e){return m(e,"value",function(e){return f(e,2)})}),e.link("image",s(n)),e.link("amount",s(n),"amountTotal",f),e.link("price",s(n),"priceTotal",f),e.link("value",s(n),"valueTotal",function(e){return f(e,2)}),e.anchors.feed(s(n),"anchorHeader",p);var i=n.asset.orderbook;return n.define("priceDetails","orderbook",function(){return v(i)}),n.watch(i,["bestAsk","bestBid","spread%"],function(){n.compute("priceDetails")}),n.simpleView(),n}return c(t,u),i(t,[{key:"simpleView",value:function(){this.simple=!0,this.class="",this.anchorTotal=this.anchorHeader}},{key:"detailledView",value:function(){this.simple=!1,this.class="footer",this.anchorTotal="Total"}}]),t}();function p(e){return 1===e.length?e[0].name:"".concat(d("Multiple")," (").concat(e.length,")")}function m(e,t,n){var r=l.create("div",null,e[t]);return e.link(t,r,"textContent",n),r}function v(e){return"XLM"===e.base.code?"":"\nBuy: ".concat(f(e.bestBid)," - Sell: ").concat(f(e.bestAsk)," - Spread: ").concat(f(e["spread%"],2),"%\n  ")}e.exports=h},function(e,t,n){var r=n(11),i=n(3),o=n(8),a=n(7),s=n(9),c=n(29),u=n(4).__,l=n(64),f=n(13),d={us:"English",fr:"FranÃ§ais"},h=["AUD","BGN","BRL","CAD","CHF","CNY","CZK","DKK","EUR","GBP","HKD","HRK","HUF","IDR","ILS","INR","ISK","JPY","KRW","MXN","MYR","NOK","NZD","PHP","PLN","RON","RUB","SEK","SGD","THB","TRY","USD","ZAR"],p=function(e){"use strict";function t(){var e;return i(this,t),(e=o(this,a(t).call(this,"\n      <section><h2>".concat(u("Settings"),"</h2>\n        <section><h3>").concat(u("General Settings"),"</h3>\n          %general\n        </section>\n      </section>\n    ")))).general=new m(f),e}return s(t,c),t}(),m=function(e){"use strict";function t(e){var n;return i(this,t),n=o(this,a(t).call(this,l.selector({label:u("Language"),name:"language",values:d}),l.selector({label:u("Currency"),name:"currency",values:h}))),e.project(["currency","language"],r(n)),n.project(["currency","language"],e),n.listen("change",function(){return location.reload()}),n}return s(t,l),t}();e.exports=p},function(e,t,n){var r=n(3),i=n(10),o=n(8),a=n(7),s=n(11),c=n(9),u=n(29),l=n(4),f=n(1),d=l.__,h=n(52),p=n(67),m=n(100),v=n(102),g=function(e){"use strict";function t(e){var n;r(this,t),(n=o(this,a(t).call(this,'\n<section class="RebalanceGui">\n  <h2>'.concat(d("Rebalance"),'</h2>\n\n  %table\n\n  %setup\n\n  <section hidden=%hideControls>\n    <form onsubmit="return false" hidden=%hideRebalance>\n      <button onclick=%rebalance disabled=%invalid>').concat(d("Rebalance"),'</button>\n    </form>\n\n    <form onsubmit="return false" hidden=%hideApply>\n      <button onclick=%apply disabled=%invalid>').concat(d("Save"),"</button>\n      <button onclick=%cancel>").concat(d("Cancel"),"</button>\n    </form>\n\n    %toParagraph:error\n  </section>\n\n</section>\n    ")))).portfolio=e;var i="target:".concat(e.account.id),c=localStorage[i];return n.target=m.forPortfolio(e,c),n.target.link("json",localStorage,i,null,{init:!1}),n.table=new t.Table(n.target),n.table.project("selected",s(n)),n.project("selected",n.table),n.trap("selected",function(){n.setup&&n.setup.destroy(),n.selected?(n.setup=new v.Setup(n.selected),n.setup.listen("close",function(){return n.selected=null})):n.setup=null}),n.target.project(["error","modified"],s(n)),n.define("hideControls",["hideRebalance","hideApply"],function(){return n.hideRebalance&&n.hideApply}),n.define("hideRebalance",["selected","modified"],function(){return n.selected||n.modified}),n.define("hideApply",["selected","modified"],function(){return n.selected||!n.modified}),n.define("invalid",["error"],function(){return!!n.error}),n}return c(t,u),i(t,[{key:"toParagraph",value:function(e){if(e)return f.create("p",".error",e)}},{key:"cancel",value:function(){location.reload()}},{key:"apply",value:function(){this.target.json=this.target.toJson(),this.target.modified=!1}},{key:"rebalance",value:function(){var e=this,t=function(e){var t=[];return e.childs.forEach(function(e){e.order&&(t=t.concat(e.order.operations))}),t}(this.target),n=this.portfolio.offers.filter(function(e){return e.outdated}).filter(function(e){return!t.find(function(t){return t.offer.id===e.id})});if(t.forEach(function(e){!e.offer.id&&n.length&&(e.offer.id=n.pop().id)}),!t.length)return!1;var r=p.operationsToCosmicLink(t);(n.forEach(function(e){r.addOperation("manageOffer",{amount:0,offerId:e.id})}),r)&&new h(r.uri).listen("destroy",function(){e.portfolio.getAccount(),e.portfolio.offers.get()})}}]),t}();g.Table=function(e){"use strict";function t(e){var n;return r(this,t),(n=o(this,a(t).call(this,'\n<section class="RebalanceTable">\n  <table>\n    <tr>\n      <th>'.concat(d("Name"),"</th>\n      <th>").concat(d("Goal"),"</th>\n      <th>").concat(d("Divergence"),"</th>\n      <th>").concat(d("Operation"),'</th>\n    </tr>\n\n    %targets...\n\n    <tr hidden=true>\n      <td align="center" colspan="4"><h3>').concat(d("Add Asset"),"</h3></td>\n    </tr>\n  </table>\n</section>\n    ")))).targets=e.childs.mirror(function(e){return n.toTargetGui(e)}),n.selected=void 0,e.listen("update",function(){return n.sortTargets()}),n.sortTargets(),n}return c(t,u),i(t,[{key:"toTargetGui",value:function(e){var t=this,n=new v(e);return n.domNode.onclick=function(){return t.selected=e},n}},{key:"sortTargets",value:function(){this.targets.sort(function(e,t){return e=e.target,"ignore"===(t=t.target).mode&&"ignore"!==e.mode?-1:"ignore"===e.mode&&"ignore"!==t.mode?1:t.value-e.value||e.asset.code.localeCompare(t.asset.code)})}}]),t}(),e.exports=g},function(e,t,n){var r=n(36),i=n(3),o=n(10),a=n(8),s=n(7),c=n(11),u=n(9),l=n(33),f=n(12),d=n(43),h=n(67),p=n(101),m=n(32),v=m.arraySum,g=m.fixed7,b=m.positive,y=function(e){"use strict";function t(e){var n;return i(this,t),n=a(this,s(t).call(this)),e?(n.asset=e,n.mode="ignore",n.order=h.rebalance(c(n)),e.target=c(n),n.watch(e,"value",function(){return n.compute("valueDiff")}),"XLM"===e.id&&(n.mode="weight",n.size=1)):(n.childs=new l,n.childs.listen("add",function(e){return e.parent=c(n)}),n.childs.listen("change",function(){return n.computeAll()})),n.trap("size",function(){n.size&&(n.size=b(n.size),"percentage"===n.mode&&(n.size=Math.min(100,n.size))),n.computeAll()}),n}return u(t,f),o(t,[{key:"root",get:function(){return this.parent?this.parent.root:this}}]),t}();y.define("name",["group","asset"],function(){return this.group||this.asset.id}),y.define("valueDiff",["value","asset"],function(){return this.asset&&this.asset.value-this.value}),y.define("valueDiffP","valueDiff",function(){return this.value?this.valueDiff/this.value:null}),y.define("amountDiff",["amount"],function(){return g(this.amount-this.asset.amount)}),y.define("amountDelta",["amountDiff"],function(){return Math.abs(this.amountDiff)}),y.define("share",null,function(){return this.value/this.root.portfolio.total}),y.define("shareDiff",["share"],function(){return this.asset.share-this.share}),y.prototype.computeAll=function(){if(this.parent)this.root.computeAll();else if(this.portfolio&&this.portfolio.total){try{this.error=null,this.value=this.portfolio.total,this.modified=this.hasChanged(),p.apply(this)}catch(e){this.error=e.message,console.error(e)}this.trigger("update")}},y.sortChilds=function(e){return e.childs.slice().sort(function(e,t){return e.name.localeCompare(t.name)})},y.forPortfolio=function(e,t){var n=t?y.fromJson(t):new y;return n.portfolio=e,e.target=n,n.watch(e,"total",function(){return n.computeAll()}),e.assets.forEach(function(e){!n.childs.find(function(t){return e===t.asset})&&e.isSupported&&n.childs.push(new y(e))}),n.childs.forEach(function(t,r){e.assets.find(function(e){return e===t.asset})&&t.asset.isSupported||n.childs.splice(r,1)}),e.assets.listen("add",function(e){e.isValid&&n.childs.push(new y(e))}),e.assets.listen("remove",function(e){var t=n.childs.findIndex(function(t){return t.asset===e});n.childs.splice(t,1)}),n},y.fromJson=function(e){var t=JSON.parse(e),n=y.fromObject(t);return n.json=e,n},y.prototype.toJson=function(e){var t=this.toObject();return JSON.stringify(t,null,e&&2)},y.prototype.hasChanged=function(){return this.toJson()!==(this.json||'{"childs":[]}')},y.fromObject=function(e){"string"==typeof e&&(e={asset:e});var t=e.asset&&d.resolve(e.asset),n=new y(t);if(n.size=e.size,n.mode=e.mode,"equal"===n.mode&&(n.mode="weight"),"skip"===n.mode&&(n.mode="ignore"),n.asset&&"XLM"===n.asset.id&&"ignore"===n.mode&&(n.mode="weight",n.size=1),n.mode||(n.mode="weight"),null==n.size&&"weight"===n.mode&&(n.size=1),e.childs){var i;n.group=e.group;var o=e.childs.map(function(e){return y.fromObject(e)}),a=o.filter(function(e){return"percentage"===e.mode});a.length&&!o.find(function(e){return"weight"===e.mode})&&100!==v(a,"size")&&a.forEach(function(e){return e.mode="weight"}),(i=n.childs).push.apply(i,r(o))}return n},y.prototype.toObject=function(){if("ignore"!==this.mode){var e={mode:this.mode,size:this.size};if("weight"===e.mode&&(delete e.mode,1===e.size&&delete e.size),this.asset)e.asset=this.name,1===Object.keys(e).length&&(e=e.asset);else if(this.childs){e.group=this.group;var t=y.sortChilds(this);e.childs=t.map(function(e){return e.toObject()}).filter(function(e){return e})}return e}},e.exports=y},function(e,t,n){var r=t,i=n(30),o=n(4).__,a=n(13),s=n(32),c=s.fixed7,u=s.positive;r.apply=function(e){var t=[],n=0,s=0;e.childs.forEach(function(e){var i=e.mode;"weight"===i?(t.push(e),s+=e.size):(r[i](e),n+=e.value)});var c=u(e.value-n);t.forEach(function(e){return r.weight(e,c,s)}),function(e,t,n){if(e>t){var r=+i(e-t,2),s=+i(100*r/t,2),c=o("Rebalance setup is over portfolio value by");throw c+=" ".concat(r," ").concat(a.currency," (").concat(s,"%) "),new Error(c)}if(!n&&e<t){var u=+i(t-e,2),l=+i(100*u/t,2),f=o("Rebalance setup is under portfolio value by");throw f+=" ".concat(u," ").concat(a.currency," (").concat(l,"%) "),new Error(f)}}(n,e.value,t.length)},r.amount=function(e){e.amount=e.size,e.value=e.amount*e.asset.price,e.compute("share")},r.ignore=function(e){e.value=e.asset.value,e.amount=e.asset.amount,e.compute("share")},r.percentage=function(e){r.weight(e,e.parent.value,100)},r.weight=function(e,t,n){n?(e.value=e.size*t/n,e.amount=c(e.value/e.asset.price)):e.value=e.amount=0,e.compute("share")}},function(e,t,n){var r=n(3),i=n(10),o=n(8),a=n(7),s=n(11),c=n(9),u=n(29),l=n(4),f=n(1),d=n(30),h=l.__,p=function(e){"use strict";function t(e){var n;return r(this,t),(n=o(this,a(t).call(this,'\n<tr class="TargetGui">\n  <td align="left">\n    <img src=%image alt="">\n    <span>%name</span>\n  </td>\n  <td align="right">%command</td>\n  <td align="right">%toPercent:shareDiff</td>\n  <td align="right">%toDiv:description...</td>\n</tr>\n    '))).target=e,n.name=e.asset.code,n.define("command",null,function(){return n.toCommand(e)}),n.watch(e,["size","mode","share"],function(){return n.compute("command")}),e.asset.project("image",s(n)),e.project("shareDiff",s(n)),e.order&&e.order.project("description",s(n)),n}return c(t,u),i(t,[{key:"toCommand",value:function(e){switch(e.mode){case"ignore":return h("Ignore");case"amount":return"".concat(e.amount," ").concat(e.asset.code);case"weight":return"".concat(e.size," âˆ’ ").concat(this.toPercent(e.share));case"percentage":return this.toPercent(e.share)}}},{key:"toPercent",value:function(e){return e?d(100*e,2)+"%":"-"}},{key:"toDiv",value:function(e){return f.create("div",null,e)}}]),t}();p.Setup=function(e){"use strict";function t(e){var n;return r(this,t),(n=o(this,a(t).call(this,'\n<section>\n  <form onsubmit="return false">\n\n    <h3>%name</h3>\n    <hr>\n\n    <label><span>'.concat(h("Size"),':</span>\n\n      <input class="half" type="number" step="any" min="0" %max\n        value=%size placeholder=%share onchange=%maybeSwitchMode>\n\n      <select class="half" onchange=%setMode value=%mode>\n        <option value="weight">').concat(h("Weight"),'</option>\n        <option value="percentage">').concat(h("Percentage"),'</option>\n        <option value="amount">').concat(h("Amount"),'</option>\n        <option value="ignore" hidden=%targetIsXlm>').concat(h("Ignore"),'</option>\n      </select>\n\n    </label>\n\n    <hr>\n    <input type="submit" onclick=%close value="').concat(h("Close"),'">\n\n  </form>\n</section>\n    ')))).target=e,n.name=e.asset.name,n.targetIsXlm="XLM"===e.asset.id,e.project("share",s(n),function(e){return d(100*e,2)}),e.project("size",s(n)),n.project("size",e,function(e){return null!=e?Number(e):null}),e.project("mode",s(n)),n.project("mode",e),n}return c(t,u),i(t,[{key:"maybeSwitchMode",value:function(){0===this.size?this.mode="amount":this.size?"ignore"===this.mode&&(this.mode="percentage",this.target.computeAll()):this.mode="ignore"}},{key:"setMode",value:function(){switch(this.mode){case"weight":this.size=1,this.max=null;break;case"percentage":this.size=+d(100*this.target.asset.share,2),this.max=100;break;case"amount":this.size=this.target.asset.amount,this.max=null;break;case"ignore":this.size=null}}},{key:"close",value:function(){this.maybeSwitchMode(),this.trigger("close"),this.destroy()}}]),t}(),e.exports=p},function(e,t){e.exports='<section><h2>License</h2>\n  <section><h3>MIT License</h3>\n\n    <p>Copyright (c) 2019 Antoine Bodin &lt;<a\n    href="mailto:mister.ticot@cosmic.plus">mister.ticot@cosmic.plus</a>&gt;</p>\n\n    <p>Permission is hereby granted, free of charge, to any person obtaining a\n    copy of this software and associated documentation files (the "Software"),\n    to deal in the Software without restriction, including without limitation\n    the rights to use, copy, modify, merge, publish, distribute, sublicense,\n    and/or sell copies of the Software, and to permit persons to whom the\n    Software is furnished to do so, subject to the following conditions:</p>\n\n    <p>The above copyright notice and this permission notice shall be included\n    in all copies or substantial portions of the Software.</p>\n\n    <p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n    OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n    IN THE SOFTWARE.</p>\n  </section>\n</section>\n'},function(e,t){e.exports='<section><h2>February, 16th âˆ’ Beta 1 Release</h2>\n  <section><h3>Welcome!</h3>\n\n    <p>Equilibre.io is a portfolio balancer that runs on the Stellar\n    Decentralized Exchange. It is a convenient trading tool to manage long-term\n    positions.</p>\n\n    <p>Regularly balancing an investment portfolio is known to boost its\n    performances, providing you choose wisely the assets to bet on. Equilibre.io\n    also lets you spread your positions over several anchors, for better fund\n    safety.</p>\n\n    <p>Equilibre.io is still under testing & development. If you use it now,\n    I\'ll ask you to consider yourself as a tester. Please report any bug you\n    could encounter, and double-check transactions before signing them.</p>\n\n    <p>Your feedback matters to me and will be listened to.</p>\n\n    <p>Respectfully, <br>MisterTicot</p>\n\n  </section>\n\n  <section><h3>To Be Implemented</h3>\n    <ul>\n      <li>Interface to add/remove assets</li>\n      <li>Portfolio historic value</li>\n      <li>Customizable rebalancing periodicity</li>\n      <li>Pie graph for rebalancing tab</li>\n    </ul>\n  </section>\n\n  <section><h3>Known Limitations</h3>\n    <ul>\n\n      <li>It is required to "Cancel All" offers between applying a new balance\n      setup</li>\n\n    </ul>\n  </section>\n</section>\n'},function(e,t,n){var r=n(3),i=n(8),o=n(7),a=n(9),s=n(29),c=n(1),u=n(4).__,l=n(106),f=n(107),d=n(13),h=function(e){"use strict";function t(e,n){return r(this,t),i(this,o(t).call(this,'\n<footer id="footer" class="scrollable">\n  <div class="nobreak">%icons...</div>\n  %links\n</footer>\n    ',{icons:e,links:n}))}return a(t,s),t}(),p=[new f(n(108),"Keybase","https://keybase.io/team/cosmic_plus"),new f(n(109),"Telegram","https://t.me/cosmic_plus"),new f(n(110),"Reddit","https://reddit.com/r/cosmic_plus"),new f(n(111),"Twitter","https://twitter.com/cosmic_plus"),new f(n(112),"Medium","https://medium.com/cosmic-plus"),new f(n(113),"GitHub","https://github.com/cosmic-plus/webapp-equilibre-io"),new f(n(114),u("Website"),"https://cosmic.plus"),new f(n(115),u("Email"),"mailto:mister.ticot@cosmic.plus"),new f(n(116),"Donate",l)],m="GAWO2C52D57XBT7SQL6YB3XPHFLFD2J4Z5RN7HPFZSHXJMXH72HRXNV3";var v='{"childs":["EUR","CNY","USD",{"size":12.5,"mode":"percentage","asset":"XLM"},{"size":12.5,"mode":"percentage","asset":"ETH"},{"size":12.5,"mode":"percentage","asset":"BTC"},{"size":4,"mode":"percentage","asset":"SLT"},{"size":4,"mode":"percentage","asset":"REPO"},{"size":2.25,"mode":"percentage","asset":"PEDI"},{"size":2.25,"mode":"percentage","asset":"TERN"}]}',g=new h(p,new s('\n<p>\n  <a target="_blank" rel="noopener" href="https://cosmic.plus">'.concat(u("A Cosmic.Plus Software"),"</a>\n  âˆ’ <a onclick=%displayDemo>").concat(u("Demo"),'</a>\n  âˆ’ <a target="_blank" rel="noopener" href="https://nucleo.fi/leaderboard/top/?span=3m">Performance</a>\n  âˆ’ <a onclick=%displayLicense>').concat(u("License"),"</a>\n  âˆ’ <a onclick=%displayAbout>").concat(u("About"),"</a>\n</p>\n"),{displayDemo:function(){localStorage["target:".concat(m)]=v,location.href="?address=".concat(m)},displayLicense:function(){return d.tabs.select("#license")},displayAbout:function(){return d.tabs.select("#about")}}));c.append(document.body,g)},function(e,t,n){var r=n(37).CosmicLink,i=n(4).__,o=n(52),a="GAWO2C52D57XBT7SQL6YB3XPHFLFD2J4Z5RN7HPFZSHXJMXH72HRXNV3";e.exports=function(){var e=prompt("".concat(i("Equilibre.io runs on donation.")).concat(i("Each contribution is a pleasant surprise for me. :)"),"\n\n").concat(i("Enter an amount (in Lumens)"),":"));"0"===e||isNaN(+e)?confirm("".concat(i("Not a valid amount"),": ").concat(e)):e&&function(e){var t=i("Donation to Equilibre.io"),n=new r({memo:t,network:"public"}).addOperation("payment",{amount:e,destination:a});new o(n.uri)}(e)}},function(e,t,n){var r=n(3),i=n(8),o=n(7),a=n(9),s=n(29),c=function(e){"use strict";function t(e,n,a){var c;return r(this,t),(c=i(this,o(t).call(this,'<a -ref=%link class="Icon">%image</a>'))).image="string"==typeof e?new s(e):e,c.link.title=n,"function"==typeof a?c.link.onclick=a:"string"==typeof a&&(c.link.href=a,a.match(/^http/)&&(c.link.target="_blank",c.link.rel="noopener")),c}return a(t,s),t}();e.exports=c},,,,,,,,,function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="none" d="M0 0h512v512H0z"/><path d="M211.719 367.797C219.469 379.281 224 393.109 224 408c0 39.734-32.266 72-72 72-39.758 0-72-32.266-72-72 0-23.172 11.148-43.563 28.164-56.734 1.852 5.594 4.336 11.125 8.289 15.906 7.055 8.516 20.336 18.266 43.531 16.344 7.578-.641 15.844-2.547 24.586-5.641 8.875-3.078 18.508-6.5 27.149-10.078zM389.875 32.578c-13.344 3.797-24.156 10.672-38.813 18.328-90 47-196.25 39.25-220 77-27.469 51.672-48.883 89.203-48.945 107.625-.016.063-.055.094-.07.141.586 19.953 19.625 58.438 29.07 75.969 6.789-15.516 17.492-29.219 32.25-40.688 7.414-5.766 13.289-9.922 18.617-13.5-3.016-9.25-6.945-20.016-10.875-28.203 10.742-7.391 26.078-26.484 31.398-40.313 13.227.094 30.25-3.172 44.773-6.938 6.406 6.844 12.977 13.563 21.766 20.016-3.961 14.344-7.07 27.063-23.438 38.359-22.313 15.438-42.734 21.578-69.484 43.109-16.086 12.953-26.07 28.203-30.625 45.641-3.148 12.094 4.734 53.016 58 33.141 10.023-3.75 23.398-8.531 34.875-14.25 23.797-11.813 52.922-40.781 61-44.828 15.234-7.641 49.813-10.656 86.313-35.016 12.531-8.375 22.063-20.688 26.477-33.625 33.242-64.828 60.883-59.656 68.633-72.563C477.734 133.734 423.563 23 389.875 32.578z"/></svg>\n'}])]);
//# sourceMappingURL=app.js.map
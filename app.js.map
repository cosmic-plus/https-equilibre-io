{"version":3,"sources":["webpack:///./src/app.js","webpack:///./src/helpers/misc.js","webpack:///./src/logic/asset.js","webpack:///./src/helpers/side-frame.js","webpack:///./src/logic/market-data.js","webpack:///./src/logic/orderbook.js","webpack:///./src/logic/balance.js","webpack:///./src/helpers/form.js","webpack:///./src/helpers/html-extra.js","webpack:///./src/logic/order.js","webpack:///./src/logic/portfolio.js","webpack:///./src/logic/anchor.js","webpack:///./src/logic/offers.js","webpack:///./src/helpers/click-wall.js","webpack:///./src/helpers/bind-dom-key.js","webpack:///./src/helpers/handle-extra-attributes.js","webpack:///./src/helpers/dom.js","webpack:///./src/activity-gui.js","webpack:///./src/widgets/active-offers-table.js","webpack:///./src/portfolio-gui.js","webpack:///./src/widgets/asset-price-chart.js","webpack:///./src/widgets/portfolio-pie-chart.js","webpack:///./src/widgets/helpers/highcharts-theme.js","webpack:///./src/widgets/portfolio-table.js","webpack:///./src/settings-gui.js","webpack:///./src/rebalance-gui.js","webpack:///./src/logic/target.js","webpack:///./src/logic/strategy.js","webpack:///./src/widgets/target-setup.js","webpack:///./src/widgets/targets-controls.js","webpack:///./src/widgets/targets-table.js","webpack:///./src/html/license.html","webpack:///./src/html/welcome.html","webpack:///./src/footer.js","webpack:///./src/helpers/donate.js","webpack:///./src/helpers/icon.js","webpack:///./src/svg/donate.svg"],"names":["dom","require","Gui","html","Tabs","params","__","global","Portfolio","clickWall","Form","isOverflowing","ActivityGui","PortfolioGui","SettingsGui","RebalanceGui","license","welcome","tabs","nav","header","view","main","add","loginForm","select","location","hash","selected","fitScreen","replace","domNode","selector","ledger","hidden","onsubmit","login","_callee","_regeneratorRuntime","wrap","_context","prev","next","Promise","all","__webpack_require__","e","then","t","bind","sent","info","connect","publicKey","t0","error","stop","_callee2","address","_context2","disconnect","$set","enable","resolve","portfolio","concat","setTimeout","listen","initGui","disable","remove","href","id","content","pieChart","reflow","loginWithLedger","onclick","page","window","scrollTo","misc","exports","positive","number","Math","max","negative","min","fixed7","Number","toFixed","clamp","value","absoluteMin","value1","value2","abs","arraySum","array","key","reduce","sum","obj","x","arrayScale","targetSum","map","FIAT_BASEURL","FIAT_IMAGEFORMAT","Mirrorable","Projectable","marketData","Orderbook","Asset","module","_Projectable","_this","_classCallCheck","this","_possibleConstructorReturn","_getPrototypeOf","call","table","_assertThisInitialized","image","code","Object","assign","type","fiats","push","toLowerCase","useGlobalPrice","cryptos","isTether","name","anchors","balances","offers","mirror","balance","anchor","watch","compute","orderbook","forAsset","define","globalPrice","price","_inherits","_createClass","_getInfo","_asyncToGenerator","mark","abrupt","crypto","small","apply","arguments","addChild","amount","rawLiabilities","entry","buying","selling","refreshPrices","_ref","refreshCryptoPrices","refreshFiatPrices","filter","asset","_x","_callee3","assets","prices","_args3","_context3","length","undefined","forEach","_callee4","_args4","_context4","fiat","USD","EUR","CNY","BTC","apiId","ETH","XRP","KIN","BAT","ZRX","BCH","STEEM","SBD","LINK","XLM","SLT","MOBI","SHX","RMT","TERN","PEDI","GRAT","REPO","currency","setInterval","console","log","Observable","timeout","SideFrame","url","current","close","create","title","className","src","sandbox","style","append","document","body","show","_this2","htmlOverflow","documentElement","overflow","bodyOverflow","shadow","animationName","background","trigger","_this3","hide","_this4","destroy","addEventListener","event","frameWindow","contentWindow","source","data","position","zIndex","right","top","width","maxWidth","height","border","backgroundImage","backgroundRepeat","backgroundPosition","backgroundSize","padding","color","fontSize","fontWeight","cursor","borderBottomLeftRadius","insertBefore","firstChild","transition","axios","nice","day","coingeckoCall","get","exchangeratesCall","_callee8","symbols","_args8","_context8","base","join","response","start_at","rates","cacheHistory","localStorage","JSON","stringify","cachedHistory","json","_JSON$parse","parse","_JSON$parse2","_slicedToArray","date","setHistoryLatestPrice","assetHistory","limit","history","list","symbol","toUpperCase","stellarNative","tickers","coin_id","_ref3","localization","market_data","community_data","developer_data","sparkline","_ref4","ids","quote","vs_currencies","assetData","_x2","_ref5","_callee5","_args5","_context5","vs_currency","days","record","index","time","volume","total_volumes","_x3","_ref6","_callee6","_context6","_x6","_ref7","_callee7","cached","end_at","today","_args7","_context7","Date","toISOString","slice","setDate","getDate","keys","sort","getTime","_x7","cosmicLib","StellarSdk","offersCallBuilder","updateOffersPrices","childs","streamOffers","addOrderbook","_streamOffers","getOffers","_getOffers","ingest","areOffersEquals","bids","normalizeOffers","asks","set","side","merged","child","sortOffers","a","b","baseVolume","quoteVolume","row","mergedRow","quoteAmount","mergeOffers","baseAsset","quoteAsset","server","array1","array2","basePrice","bestBid","bestAsk","marketPrice","spread","prototype","findOffer","last","childsNum","offer","findAsk","findBid","depth","Anchor","Balance","entryId","asset_code","asset_issuer","known","buying_liabilities","selling_liabilities","project","forBalance","issuer","targetAmount","balanceTargetDeviation","targetMin","targetMax","targetMinDiff","targetMaxDiff","hiddenKey","setHiddenProperty","bindDomKey","handleExtraAttributes","_len","Array","_key","tagName","element","getAttribute","preventDefault","bindInputs","status","submit","reset","$status","_len2","_key2","rewrite","report","spinner","message","Error","binder","$node","object","walk","attributes","disabled","enabled","alias","label","_len3","_key3","button","_len4","_key4","_toConsumableArray","control","tag","required","textarea","values","placeholder","unshift","selectedIndex","input","datetime","constructor","shift","func","childNodes","parent","i","CosmicLink","Order","method","operations","parameters","refresh","target","order","splice","make","operation","find","newOperation","getOperation","setOperation","cost","operationDirection","op","addOneOperation","size","noMinValue","mode","baseAsk","minOfferValue","sizeMin","sizeMax","skipMarginalOffers","makeOfferFilter","addMultipleOperations","misallocatedKey","misallocated","toTrade","sizes","sizeKey","remains","tradable","operationsToCosmicLink","operationsToDescription","cosmicLink","memo","maxTime","accountId","addOperation","odesc","price_r","n","d","offerId","operationToOdesc","desc","market","percentage","spreadTightening","clone","diff","premium","maxSpread","clampOfferPrice","updateOfferPriceR","tightenSpread","amountDelta","liabilities","outdated","description","setBalancesTargets","areTargetAnchorsBalanced","amountDiff","riskMax","anchorsRebalanceRiskMax","under","over","currentRisk","valueDiffP","amountCap","transferAmount","buy","sell","balanceTargetAnchors","isOneOperationEnough","_construct","_loop","Offers","checkNetwork","horizon","accountCallBuilder","isSupported","_resolve","destination","isAccountEmpty","account_id","config","streamAccount","_streamAccount","getAccount","_getAccount","account","_ingest","indexOf","getInfo","forPortfolio","stream","accounts","total","aliases","helpers","shorter","USD:GDUKMGUGDZQK6YHYA5Z6AY2G4XDSZPSZ3SW5UN3ARVMO6QSRDWP5YLEX","WSD:GDSVWEA7XV6M5XNLODVTPCGMAJTNBLZBXOFNQD3BNPNYALEYBNT6CE2V","USD:GDSRCV5VTM3U7Y3L6DFRP3PEGBNQMGOWSRTGSBWX6Z3H6C7JHRI4XFJP","USD:GBUYUAI75XXWDZEKLY66CFYKQPET5JR4EENXZBUZ3YXZ7DS56Z4OKOFU","CNY:GAREELUB43IRHWEASCFBLKHURCGMHE5IF6XSE7EXDLACYHGRHM43RFOX","XCN:GCNY5OXYSY4FKHOPT2SPOQZAOEIGXB5LBYW3HVU3OWSTQITS65M5RCNY","BCNY:GBCNYBHAAPDSU3UIHXXQTHYZVSBJBI4YUNWXMKJBCPDHTVYR75G6NFHD","EURT:GAP5LETOV6YIE62YAM56STDANPRDO7ZFDBGSNHJQIYGGKSMOZAHOOS2S","SLT:GCKA6K5PCQ6PNF5RQBF7PQDJWRHO6UOGFMRLK3DYHDOI244V47XKQ4GP","MOBI:GA6HCMBLTZS5VYYBCATRBRZ3BZJMAFUDKYYF6AH6MVCMGWMRDNSWJPIH","SHX:GDSTRSHXHGJ7ZIVRBXEYE5Q74XUVCUSEKEBR7UCHEUUEK72N7I7KJ6JH","RMT:GDEGOXPCHXWFYY234D2YZSPEJ24BX42ESJNVHY5H7TWWQSYRN5ZKZE3N","TERN:GDGQDVO6XPFSY4NMX75A7AOVYCF5JYGW2SHCJJNWCQWIDGOZB53DGP6C","PEDI:GBVUDZLMHTLMZANLZB6P4S4RYF52MVWTYVYXTQ2EJBPBX4DZI2SDOLLY","GRAT:GAJ7V3EMD3FRWAPBEJAP7EC4223XI5EACDZ46RFMY5DYOMCIMWEFR5II","REPO:GCZNF24HPMYTV6NOEHI7Q5RJFFUI23JKUKY3H3XTQAFBQIBOHD5OXG3B","BTC:GATEMHCCKCY67ZUCKTROYN24ZYT5GK4EQZ65JJLDHKHRUZI3EUEKMTCH","BTC:GAUTUYY2THLF7SGITDFMXJVYH3LHDSMGEAKSBU267M2K7A3W543CKUEF","BTC:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P","BTC:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5","ETH:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P","ETH:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5","ETH:GBETHKBL5TCUTQ3JPDIYOZ5RDARTMHMEKIO2QZQ7IOZ4YC5XV3C2IKYU","ETH:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR","LTC:GC5LOR3BK6KIOK7GKAUD5EGHQCMFOGHJTC7I3ELB66PTDFXORC2VM5LP","LTC:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5","LTC:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P","XRP:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5","XRP:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P","KIN:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR","BAT:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR","ZRX:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR","BCH:GAEGOS7I6TYZSVHPSN76RSPIVL3SELATXZWLFO4DIAFYJF7MPAHFE7H4","STEEM:GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM","SBD:GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM","LINK:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR","loopcall","delay","callBuilder","records","alive","Offer","clean","forAccount","intern","recordToId","rawPrice","update","rawAmount","last_modified_time","last_modified_ledger","overlay","objKey","$input","nodeKey","importKeyOn","eventName","setCustomValidity","link","init","SELECT","$select","interactive","TEXTAREA","$textarea","INPUT","radio","checkbox","$radio","setter","checked","checkBox","$checkbox","setAliases","$label","for","$span","handleLabel","validate","hasProperty","reportValidity","validateNodeValue","handleValidate","scrollHeight","clientHeight","scrollWidth","clientWidth","ActiveOffersTable","_Gui","globalCurrency","OfferRow","txParams","network","uri","toLocaleDateString","AssetPriceChart","PortfolioPieChart","PortfolioTable","coingecko","trap","maybeDrawPriceChart","overview","priceChart","Highstock","drawChart","chart","stockChart","container","rangeSelector","backgroundColor","yAxis","labels","align","resize","offset","series","credits","Highcharts","makePoint","y","draw","legend","tooltip","pointFormat","plotOptions","pie","dataLabels","format","point","events","options","legendItemClick","colorByPoint","ignoreHiddenPoint","theme","allowPointSelect","animation","responsive","rules","condition","chartOptions","showInLegend","distance","colors","setOptions","rows","toAssetRow","onselect","AssetRow","selectedRow","simpleView","detailledView","cell","amounts","node","priceDetails","feed","anchorName","simple","anchorTotal","anchorHeader","languages","us","fr","currencies","general","GeneralSettings","reload","Target","TargetSetup","TargetsControls","TargetsTable","targetKey","template","controls","strategy","rebalance","computeAll","root","group","valueDiff","share","modified","hasChanged","sortChilds","localeCompare","fromJson","isValid","findIndex","fromObject","toJson","beautifyFlag","toObject","_target$childs","percentChilds","delayed","weights","weight","allocated","available","checkUnderFlag","overP","msg","underP","checkAllocationLimits","ignore","targetIsXlm","maybeSwitchMode","listOperations","remaining","pop","targets","toTargetRow","sortTargets","TargetRow","toCommand","toPercent","donate","Icon","Footer","icons","links","MYPUBKEY","demoConfig","footer","displayDemo","displayLicense","displayAbout","prompt","isNaN","confirm","showDonateFrame","action","match","rel"],"mappings":"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","file":"app.js","sourcesContent":["\"use_strict\"\n/**\n * Login interface\n */\nconst dom = require(\"@cosmic-plus/domutils/es5/dom\")\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst Tabs = require(\"@cosmic-plus/domutils/es5/tabs\")\nconst params = require(\"@cosmic-plus/domutils/es5/params\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"./logic/global\")\nconst Portfolio = require(\"./logic/portfolio\")\n\nconst clickWall = require(\"./helpers/click-wall\")\nconst Form = require(\"./helpers/form\")\nconst { isOverflowing } = require(\"./helpers/dom\")\n\nconst ActivityGui = require(\"./activity-gui\")\nconst PortfolioGui = require(\"./portfolio-gui\")\nconst SettingsGui = require(\"./settings-gui\")\nconst RebalanceGui = require(\"./rebalance-gui\")\n\nconst license = new Gui(require(\"./html/license.html\"))\nconst welcome = new Gui(require(\"./html/welcome.html\"))\n\nrequire(\"./footer\")\n\n/**\n * Init\n */\nconst tabs = global.tabs = new Tabs({ nav: dom.header, view: dom.main })\ntabs.add(\"#welcome\", __(\"Welcome\"), welcome)\ntabs.add(\"#login\", __(\"Login\"), dom.loginForm)\ntabs.add(\"#license\", null, license)\ntabs.add(\"#about\", null, welcome)\n\ntabs.select(location.hash)\nif (!tabs.selected) tabs.select(\"#welcome\")\n\ntabs.fitScreen = function () {\n  if (isOverflowing(dom.header)) {\n    html.replace(tabs.nav.domNode, tabs.selector.domNode)\n  }\n}\ntabs.fitScreen()\n\nconst loginForm = new Form(dom.loginForm, { hidden: false, onsubmit: login })\nloginForm.dom.loginWithLedger.onclick = loginWithLedgerWallet\n\nif (params.address) {\n  tabs.select(\"#login\")\n  loginForm[\"stellar-public-key\"] = params.address\n  login()\n}\n\ntabs.listen(\"select\", page => {\n  location.hash = page\n  window.scrollTo(0, 0)\n})\n\n/**\n * Functions\n */\n\nlet ledger\nasync function loginWithLedgerWallet () {\n  loginForm[\"stellar-public-key\"] = null\n  ledger = await getLedgerModule()\n  loginForm.info(__(\"Please open the Stellar App in your Ledger Wallet\"))\n  try {\n    await ledger.connect()\n    loginForm[\"stellar-public-key\"] = ledger.publicKey\n    login()\n  } catch (error) {\n    loginForm.error(error)\n  }\n}\n\nasync function login () {\n  const address = loginForm[\"stellar-public-key\"]\n  if (!address) loginForm.error(__(\"Please enter an address.\"))\n  if (ledger) ledger.disconnect()\n\n  loginForm.info(__(\"Connecting to your account...\"))\n  params.$set({ address })\n  clickWall.enable()\n\n  try {\n    global.portfolio = await Portfolio.resolve(address)\n    loginForm.info(`${__(\"Fetching market data\")}...`)\n    setTimeout(\n      () => loginForm.info(`${__(\"Sorry, it takes a while (^.^)\\\"\")}...`),\n      10000\n    )\n    setTimeout(() => loginForm.info(`${__(\"Almost there\")}...`), 20000)\n    setTimeout(\n      () => loginForm.info(`${__(\"I'm running, I'm running\")}...`),\n      30000\n    )\n    global.portfolio.listen(\"open\", () => {\n      initGui()\n      clickWall.disable()\n    })\n  } catch (error) {\n    clickWall.disable()\n    loginForm.error(error)\n  }\n}\n\nfunction initGui () {\n  const portfolio = global.portfolio\n\n  const selected = location.hash\n  tabs.remove(\"#welcome\")\n  tabs.remove(\"#login\")\n  tabs.add(\"#portfolio\", __(\"Portfolio\"), new PortfolioGui(portfolio))\n  tabs.add(\"#rebalance\", __(\"Rebalance\"), new RebalanceGui(portfolio))\n  tabs.add(\"#activity\", __(\"Activity\"), new ActivityGui(portfolio))\n  tabs.add(\"#settings\", __(\"Settings\"), new SettingsGui())\n  tabs.add(\"#logout\", __(\"Logout\"), () => {\n    location.replace(location.href.replace(/\\?.*$/, \"#login\"))\n  })\n  tabs.fitScreen()\n\n  // Fix portfolio pie chart positioning.\n  tabs.listen(\"select\", id => {\n    if (id === \"#portfolio\") tabs.selected.content.pieChart.reflow()\n  })\n\n  tabs.select(selected)\n  if (!tabs.selected) tabs.select(\"#portfolio\")\n}\n\n/**\n * Module loading\n */\n\nfunction getLedgerModule () {\n  return import(\n    /* webpackChunkName: \"ledger\" */ \"@cosmic-plus/ledger-wallet\"\n  ).then(ledger => ledger.default)\n}\n","\"use strict\"\n/**\n * Various independent helpers.\n */\nconst misc = exports\n\n/**\n * Returns **number** if it is greater than 0, else returns 0.\n */\nmisc.positive = function (number) {\n  return Math.max(0, number)\n}\n\n/**\n * Returns **number** if it is lesser than 0, else returns 0.\n */\nmisc.negative = function (number) {\n  return Math.min(0, number)\n}\n\n/**\n * Returns **number** with 7 digits after the dot.\n */\nmisc.fixed7 = function (number) {\n  return +Number(number).toFixed(7)\n}\n\n/**\n * Returns a number whose value is limited to the given range.\n */\nmisc.clamp = function (value, min, max) {\n  return Math.min(Math.max(value, min), max)\n}\n\n/**\n * Returns **value1** if its absolute is lesser than or equal **value2**\n * absolute, else returns **value2**.\n */\nmisc.absoluteMin = function (value1, value2) {\n  return Math.abs(value1) <= Math.abs(value2) ? value1 : value2\n}\n\n/**\n * Sum array values, or array elements `key` if specified.\n */\nmisc.arraySum = function (array, key) {\n  if (key) return array.reduce((sum, obj) => sum + obj[key], 0)\n  else return array.reduce((sum, x) => sum + x, 0)\n}\n\n/**\n * Proportionally scale **array** values, or **array** elements **key** property\n * if provided, to make their sum equal **targetSum**.\n */\nmisc.arrayScale = function (array, targetSum, key) {\n  const sum = misc.arraySum(array, key)\n  if (key) return array.map(obj => obj[key] * targetSum / sum)\n  else return array.map(x => x * targetSum / sum)\n}\n","\"use_strict\"\n/**\n * Asset class\n */\n\nconst AUTO_REFRESH_PRICES = true\nconst CRYPTO_PRICES_REFRESH_DELAY = 60 * 1000\nconst FIAT_PRICES_REFRESH_DELAY = 60 * 60 * 1000\nconst FIAT_BASEURL = \"https://www.xe.com/themes/xe/images/flags/svg/\"\nconst FIAT_IMAGEFORMAT = \".svg\"\n\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\n\nconst global = require(\"./global\")\nconst marketData = require(\"./market-data\")\nconst Orderbook = require(\"./orderbook\")\nconst { arraySum } = require(\"../helpers/misc\")\n\n/**\n * Class\n */\n\nconst Asset = module.exports = class Asset extends Projectable {\n  static resolve (id) {\n    return Asset.table[id] || new Asset(id)\n  }\n\n  constructor (id) {\n    super()\n\n    this.id = id\n    Asset.table[id] = this\n\n    // Empty image by default\n    this.image = \"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=\"\n\n    if (Asset.info[id]) {\n      this.code = id\n      Object.assign(this, Asset.info[id])\n      if (this.type === \"fiat\") {\n        Asset.fiats.push(this)\n        this.image = `${FIAT_BASEURL}${id.toLowerCase()}${FIAT_IMAGEFORMAT}`\n        this.useGlobalPrice = true\n      } else {\n        Asset.cryptos.push(this)\n        this.type = \"crypto\"\n        if (this.isTether || this.id === \"XLM\") this.useGlobalPrice = true\n      }\n    } else {\n      this.code = id.replace(/:.*/, \"\")\n      this.name = this.code\n      this.type = \"unknown\"\n    }\n\n    this.anchors = new Mirrorable()\n    this.balances = new Mirrorable()\n    this.offers = new Mirrorable()\n\n    this.balances.mirror(balance => {\n      this.anchors.push(balance.anchor)\n      this.watch(balance, \"amount\", () => this.compute(\"amount\"))\n      this.watch(balance, [\"buying\", \"selling\"], () => {\n        this.compute(\"liabilities\")\n      })\n    })\n\n    this.orderbook = Orderbook.forAsset(this)\n    this.define(\"price\", \"globalPrice\", () => {\n      return this.globalPrice || this.orderbook.price\n    })\n    this.watch(this.orderbook, \"price\", () => this.compute(\"price\"))\n  }\n\n  async getInfo () {\n    // Happens once & only for cryptos.\n    if (this.name || this.type !== \"crypto\") return\n    this.info = await marketData.crypto.info(this)\n    this.name = this.info.name\n    this.image = this.info.image.small\n  }\n\n  addOrderbook (orderbook) {\n    this.orderbook.addChild(orderbook)\n  }\n}\n\nAsset.define(\"amount\", \"balances\", function () {\n  return this.balances && arraySum(this.balances, \"amount\")\n})\n\nAsset.define(\"value\", [\"amount\", \"price\"], function () {\n  return this.amount === 0 ? 0 : this.amount * this.price\n})\n\nAsset.define(\"liabilities\", [\"balances\", \"price\"], function () {\n  if (this.balances) {\n    const rawLiabilities = this.balances.reduce(\n      (sum, entry) => sum + entry.buying - entry.selling,\n      0\n    )\n    return this.price * rawLiabilities\n  }\n})\n\nAsset.define(\"isSupported\", [\"type\", \"price\"], function () {\n  return !!(this.type !== \"unknown\" || this.price)\n})\n\n/**\n * Utilities\n */\n\nAsset.refreshPrices = async function (array) {\n  if (!array) {\n    await Asset.refreshCryptoPrices()\n    await Asset.refreshFiatPrices()\n  } else {\n    await Asset.refreshCryptoPrices(\n      array.filter(asset => asset.type === \"crypto\").map(asset => asset.code)\n    )\n    await Asset.refreshFiatPrices(\n      array.filter(asset => asset.type === \"fiat\").map(asset => asset.code)\n    )\n  }\n}\n\nAsset.refreshCryptoPrices = async function (assets = Asset.cryptos) {\n  if (!assets.length) return\n  const prices = await marketData.crypto.prices(assets)\n  assets.forEach(asset => {\n    if (asset.useGlobalPrice) asset.globalPrice = prices[asset.code]\n  })\n}\n\nAsset.refreshFiatPrices = async function (fiats = Asset.fiats) {\n  if (!fiats.length) return\n  const prices = await marketData.fiat.prices(fiats)\n  fiats.forEach(asset => {\n    if (asset.useGlobalPrice) asset.globalPrice = prices[asset.code]\n  })\n}\n\n/**\n * Known Assets\n */\n\nAsset.info = {\n  USD: { isTether: true, type: \"fiat\", name: \"US Dollar\" },\n  EUR: { isTether: true, type: \"fiat\", name: \"Euro\" },\n  CNY: { isTether: true, type: \"fiat\", name: \"Renminbi\" },\n\n  BTC: { isTether: true, apiId: \"bitcoin\" },\n  ETH: { isTether: true, apiId: \"ethereum\" },\n  XRP: { isTether: true, apiId: \"ripple\" },\n  KIN: { isTether: true, apiId: \"kin\" },\n  BAT: { isTether: true, apiId: \"basic-attention-token\" },\n  ZRX: { isTether: true, apiId: \"0x\" },\n  BCH: { isTether: true, apiId: \"bitcoin-cash\" },\n  STEEM: { isTether: true, apiId: \"steem\" },\n  SBD: { isTether: true, apiId: \"steem-dollar\" },\n  LINK: { isTether: true, apiId: \"chainlink\" },\n\n  XLM: { apiId: \"stellar\" },\n  SLT: { apiId: \"smartlands\" },\n  MOBI: { apiId: \"mobius\" },\n  SHX: { apiId: \"stronghold-token\" },\n  RMT: { apiId: \"sureremit\" },\n  TERN: { apiId: \"ternio\" },\n  PEDI: { apiId: \"pedity\" },\n  GRAT: { apiId: \"gratz\" },\n  REPO: { apiId: \"repo\" }\n}\n\n/**\n * Init\n */\n\nAsset.table = {}\nAsset.cryptos = []\nAsset.fiats = []\nnew Asset(global.currency)\n\n// Automatic global price refresh\nif (AUTO_REFRESH_PRICES) {\n  setInterval(Asset.refreshCryptoPrices, CRYPTO_PRICES_REFRESH_DELAY)\n  setInterval(Asset.refreshFiatPrices, FIAT_PRICES_REFRESH_DELAY)\n}\n\n// eslint-disable-next-line no-console\nconsole.log(Asset.table)\n","\"use_strict\"\n/**\n * Signing Side Frame\n */\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst Observable = require(\"@cosmic-plus/jsutils/es5/observable\")\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\n/**\n * Class\n */\n\nclass SideFrame extends Observable {\n  constructor (url) {\n    super()\n\n    if (SideFrame.current) SideFrame.current.close()\n    SideFrame.current = this\n\n    this.domNode = html.create(\"iframe\", {\n      title: \"Signing Frame\",\n      className: \"animated\",\n      src: url,\n      sandbox: \"allow-same-origin allow-scripts allow-forms allow-popups\",\n      hidden: true\n    })\n    Object.assign(this.domNode.style, SideFrame.style)\n    html.append(document.body, this.domNode)\n\n    this.show()\n  }\n\n  show () {\n    if (!this.domNode.hidden) return\n\n    this.htmlOverflow = document.documentElement.style.overflow\n    this.bodyOverflow = document.body.style.overflow\n    document.documentElement.style.overflow = \"hidden\"\n    document.body.style.overflow = \"hidden\"\n\n    html.show(SideFrame.shadow, SideFrame.close, this.domNode)\n    this.domNode.style.animationName = \"slideInRight\"\n    SideFrame.shadow.style.background = \"rgba(0,0,0,0.3)\"\n\n    return timeout(400).then(() => {\n      SideFrame.shadow.onclick = () => this.close()\n      SideFrame.close.onclick = () => this.close()\n      this.trigger(\"show\")\n    })\n  }\n\n  hide () {\n    if (this.domNode.hidden) return\n\n    document.documentElement.style.overflow = this.htmlOverflow\n    document.body.style.overflow = this.bodyOverflow\n\n    SideFrame.shadow.onclick = null\n    html.hide(SideFrame.close)\n\n    this.domNode.style.animationName = \"slideOutRight\"\n    SideFrame.shadow.style.background = \"transparent\"\n\n    return timeout(400).then(() => {\n      html.hide(SideFrame.shadow, SideFrame.close, this.domNode)\n      this.trigger(\"hide\")\n    })\n  }\n\n  close () {\n    SideFrame.current = null\n    this.hide().then(() => {\n      html.destroy(this.domNode)\n      this.trigger(\"close\")\n      this.destroy()\n    })\n  }\n}\n\n/**\n * Event\n */\n\nwindow.addEventListener(\"message\", event => {\n  const frameWindow =\n    SideFrame.current && SideFrame.current.domNode.contentWindow\n\n  if (event.source === frameWindow) {\n    switch (event.data) {\n    case \"show\":\n      SideFrame.current.show()\n      break\n    case \"hide\":\n      SideFrame.current.hide()\n      break\n    case \"close\":\n      SideFrame.current.close()\n      break\n    }\n  }\n})\n\n/**\n * Frame style\n */\n\nSideFrame.style = {\n  position: \"fixed\",\n  zIndex: 998,\n  right: 0,\n  top: 0,\n  width: \"30em\",\n  maxWidth: \"100%\",\n  height: \"100vh\",\n  border: \"0.1em solid hsl(240, 10%, 75%)\",\n  background: \"hsl(240, 40%, 98%)\",\n  backgroundImage: `url('./images/cosmic-link.svg')`,\n  backgroundRepeat: \"no-repeat\",\n  backgroundPosition: \"center\",\n  backgroundSize: \"12em 12em\",\n  padding: 0\n}\n\n/**\n * Closing button\n */\n\nSideFrame.close = html.create(\"span\", { hidden: true }, ` ${__(\"Close\")}`)\nObject.assign(SideFrame.close.style, {\n  position: \"fixed\",\n  zIndex: 999,\n  top: \"0.1em\",\n  right: \"0.1em\",\n  color: \"hsl(0, 0%, 40%)\",\n  fontSize: \"0.9em\",\n  fontWeight: \"bold\",\n  cursor: \"pointer\",\n  background: \"hsl(0, 0%, 95%)\",\n  borderBottomLeftRadius: \"0.1em\",\n  padding: \"0.1em 0.3em\"\n})\ndocument.body.insertBefore(SideFrame.close, document.body.firstChild)\n\n/**\n * Shadow Layer\n */\n\nSideFrame.shadow = html.create(\"div\", { hidden: true })\nObject.assign(SideFrame.shadow.style, {\n  position: \"fixed\",\n  zIndex: 997,\n  top: 0,\n  width: \"100%\",\n  height: \"100%\",\n  background: \"transparent\",\n  transition: \"background 0.4s\"\n})\ndocument.body.insertBefore(SideFrame.shadow, document.body.firstChild)\n\n/**\n * Export\n */\n\nmodule.exports = SideFrame\n","\"use_strict\"\n/**\n * Markets statistics & data\n *\n * @exports marketData\n */\nconst marketData = exports\n\nconst axios = require(\"@cosmic-plus/base/es5/axios\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { day } = require(\"@cosmic-plus/jsutils/es5/misc\")\n\nconst global = require(\"./global\")\n\n/**\n * Generic price/history\n */\n\nmarketData.assetHistory = function (asset, limit = 1000) {\n  if (asset.type === \"crypto\") return marketData.crypto.history(asset, limit)\n  else if (asset.type === \"fiat\") return marketData.fiat.history(asset, limit)\n}\n\n/**\n * Crypto price/history by \"https://www.coingecko.com\"\n */\n\nmarketData.crypto = {}\n\nfunction coingeckoCall (page, params) {\n  return axios.get(`https://api.coingecko.com/api/v3/${page}`, { params })\n}\n\nmarketData.crypto.list = async function () {\n  const response = await coingeckoCall(\"coins/list\")\n  const list = {}\n  response.data.forEach(entry => {\n    const symbol = entry.symbol.toUpperCase()\n    list[symbol] = { apiId: entry.id, name: entry.name }\n  })\n  return list\n}\n\nmarketData.crypto.stellarNative = async function () {\n  const response = await coingeckoCall(\"exchanges/stellar_term\")\n  return response.data.tickers.map(x => x.coin_id).filter(x => x)\n}\n\nmarketData.crypto.info = async function (asset) {\n  const response = await coingeckoCall(`coins/${asset.apiId}`, {\n    localization: false,\n    tickers: false,\n    market_data: false,\n    community_data: false,\n    developer_data: false,\n    sparkline: false\n  })\n  return response.data\n}\n\nmarketData.crypto.prices = async function (assets) {\n  const ids = assets.map(asset => asset.apiId).join(\",\")\n  const quote = global.currency.toLowerCase()\n  const response = await coingeckoCall(\"simple/price\", {\n    ids,\n    vs_currencies: quote\n  })\n  const prices = {}\n  assets.forEach(asset => {\n    const assetData = response.data[asset.apiId]\n    if (assetData) prices[asset.code] = assetData[quote]\n  })\n  return prices\n}\n\nmarketData.crypto.history = async function (asset, limit = 1000) {\n  const response = await coingeckoCall(`coins/${asset.apiId}/market_chart`, {\n    vs_currency: global.currency,\n    days: limit\n  })\n  const data = response.data.prices.map((record, index) => {\n    return {\n      time: record[0],\n      price: record[1],\n      // volume: response.data.total_volumes[index][1]\n      volume: +nice(response.data.total_volumes[index][1] / record[1])\n    }\n  })\n\n  // Normalize last day timestamp.\n  const oneDay = 24 * 60 * 60 * 1000\n  data[data.length - 1].time = data[data.length - 2].time + oneDay\n\n  setHistoryLatestPrice(asset, data)\n  return data\n}\n\n/**\n * Fiat prices / history by \"https://exchangeratesapi.io\"\n */\n\nmarketData.fiat = {}\n\nasync function exchangeratesCall (page, symbols, params = {}) {\n  params.base = global.currency\n  if (typeof symbols === \"string\") {\n    params.symbols = symbols\n  } else {\n    if (global.currency === \"EUR\") symbols = symbols.filter(x => x !== \"EUR\")\n    params.symbols = symbols.join(\",\")\n  }\n  params.source = \"equilibre.io\"\n\n  return axios\n    .get(`https://api.exchangeratesapi.io/${page}`, { params })\n    .then(response => {\n      if (global.currency === \"EUR\" && !response.data.start_at) {\n        response.data.rates.EUR = 1\n      }\n      return response\n    })\n}\n\nmarketData.fiat.prices = async function (assets) {\n  const symbols = assets.map(asset => asset.code)\n  const response = await exchangeratesCall(\"latest\", symbols)\n  const data = response.data.rates\n  for (let symbol in data) {\n    data[symbol] = nice(1 / data[symbol], 8)\n  }\n  return data\n}\n\nmarketData.fiat.history = async function (asset, limit = 1000) {\n  const cached = cachedHistory(asset)\n  if (cached) return cached\n\n  const end_at = new Date().toISOString().slice(0, 10)\n  const today = new Date(end_at)\n  today.setDate(today.getDate() - limit)\n  const start_at = today.toISOString().slice(0, 10)\n  const response = await exchangeratesCall(\"history\", asset.code, {\n    start_at,\n    end_at\n  })\n\n  const data = Object.keys(response.data.rates)\n    .sort()\n    .map(date => {\n      return {\n        time: new Date(date).getTime(),\n        price: +nice(1 / response.data.rates[date][asset.code], 8)\n      }\n    })\n  cacheHistory(asset, data)\n  return data\n}\n\n/**\n * Helpers\n */\n\nfunction cacheHistory (asset, data) {\n  localStorage[`prices.${asset.code}`] = JSON.stringify([day(), data])\n}\n\nfunction cachedHistory (asset) {\n  const json = localStorage[`prices.${asset.code}`]\n  if (!json) return\n\n  const [date, data] = JSON.parse(json)\n  if (date !== day()) return\n\n  setHistoryLatestPrice(asset, data)\n  return data\n}\n\nfunction setHistoryLatestPrice (asset, data) {\n  data[data.length - 1].price = asset.price\n}\n","\"use_strict\"\n/**\n * Orderbook class\n */\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\nconst StellarSdk = require(\"@cosmic-plus/base/es5/stellar-sdk\")\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst { fixed7 } = require(\"../helpers/misc\")\n\nconst Orderbook = module.exports = class Orderbook extends Projectable {\n  static forBalance (balance, quote) {\n    if (balance.asset === quote) return\n\n    const orderbook = new Orderbook({ balance, quote })\n    orderbook.streamOffers()\n\n    balance.orderbook = orderbook\n    balance.asset.addOrderbook(orderbook)\n\n    return orderbook\n  }\n\n  static forAsset (asset) {\n    return new Orderbook({ asset })\n  }\n\n  constructor (params) {\n    super()\n\n    if (params.balance) {\n      this.type = \"native\"\n      this.balance = params.balance\n      this.base = params.balance.asset\n      this.quote = params.quote\n      this.name = `${this.base.code}/${this.quote.code}`\n      this.offersCallBuilder = Orderbook.offersCallBuilder(this.balance)\n\n      this.watch(this.quote, \"price\", () => this.updateOffersPrices())\n    } else if (params.asset) {\n      this.type = \"agregated\"\n      this.base = params.asset\n      this.name = `${this.base.code} (${__(\"Agregated\")})`\n      this.childs = []\n    }\n\n    this.watch(this.base, \"globalPrice\", () => this.compute(\"price\"))\n  }\n\n  static offersCallBuilder (balance) {\n    const baseAsset = new StellarSdk.Asset(balance.code, balance.anchor.address)\n    const quoteAsset = StellarSdk.Asset.native()\n    const server = cosmicLib.resolve.server()\n    return server.orderbook(baseAsset, quoteAsset)\n  }\n\n  async streamOffers () {\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      await this.getOffers()\n      await timeout(15000)\n    }\n  }\n\n  async getOffers () {\n    try {\n      const offers = await this.offersCallBuilder.call()\n      this.ingest(offers)\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  ingest (offers) {\n    if (!areOffersEquals(this.bids, offers.bids)) {\n      this.bids = normalizeOffers(offers.bids, this.quote, this.balance, \"bids\")\n    }\n    if (!areOffersEquals(this.asks, offers.asks)) {\n      this.asks = normalizeOffers(offers.asks, this.quote, this.balance, \"asks\")\n    }\n  }\n\n  updateOffersPrices () {\n    if (this.bids) {\n      this.set(\"bids\", updateOffersPrices(this.bids, this.quote))\n    }\n    if (this.asks) {\n      this.set(\"asks\", updateOffersPrices(this.asks, this.quote))\n    }\n  }\n\n  mergeOffers (side) {\n    if (this.childs.length < 2) {\n      this.set(side, this.childs[0] && this.childs[0][side])\n      return\n    }\n\n    /// Merge order books\n    const merged = this.childs.reduce((merged, child) => {\n      return child[side] ? merged.concat(child[side]) : merged\n    }, [])\n    if (!merged.length) {\n      this[side] = null\n      return\n    }\n\n    const sortOffers =\n      side === \"bids\"\n        ? (a, b) => b.price - a.price\n        : (a, b) => a.price - b.price\n\n    /// Update volumes.\n    let volume = 0,\n      baseVolume = 0,\n      quoteVolume = 0\n    this.set(\n      side,\n      merged.sort(sortOffers).map(row => {\n        const mergedRow = Object.assign({}, row)\n        mergedRow.volume = volume += fixed7(row.amount * row.price)\n        mergedRow.baseVolume = baseVolume += +row.amount\n        mergedRow.quoteVolume = quoteVolume += +row.quoteAmount\n        return mergedRow\n      })\n    )\n  }\n\n  addChild (orderbook) {\n    this.childs.push(orderbook)\n    this.watch(orderbook, \"bids\", () => this.mergeOffers(\"bids\"))\n    this.watch(orderbook, \"asks\", () => this.mergeOffers(\"asks\"))\n  }\n}\n\nOrderbook.define(\"bestBid\", \"bids\", function () {\n  return this.bids && this.bids[0] && this.bids[0].price\n})\nOrderbook.define(\"bestAsk\", \"asks\", function () {\n  return this.asks && this.asks[0] && this.asks[0].price\n})\nOrderbook.define(\"price\", [\"bestBid\", \"bestAsk\"], function () {\n  if (this.base.globalPrice) return (this.bestBid + this.bestAsk) / 2\n  else return this.marketPrice()\n})\nOrderbook.define(\"spread\", [\"bestBid\", \"bestAsk\"], function () {\n  return this.bestAsk - this.bestBid\n})\nOrderbook.define(\"spread%\", [\"spread\", \"bestAsk\"], function () {\n  return 100 * this.spread / this.bestAsk\n})\n\n/**\n * Utilities\n */\n\n/**\n * Look for the best first offer in **orderbook** **side** that match **filter**\n * (if provided) among child orderbooks.\n *\n * @param  {Orderbook} orderbook [description]\n * @param  {String}    side      `bids` or `asks`\n * @param  {Function}  [filter]  A filter that is passed by the returned offer\n * @return {Object}    An orderbook offer\n */\nOrderbook.prototype.findOffer = function (side, filter) {\n  const offers = this[side]\n  const childsNum = this.childs ? this.childs.length : 1\n  const anchors = {}\n\n  let last\n  for (let index in offers) {\n    const offer = offers[index]\n    if (filter && !filter(offer)) continue\n    const anchor = offer.balance.anchor.address\n    if (!anchors[anchor]) {\n      anchors[anchor] = true\n      last = offer\n    }\n    if (Object.keys(anchors).length === childsNum) break\n  }\n  return last\n}\n\nOrderbook.prototype.findAsk = function (filter) {\n  return this.findOffer(\"asks\", filter)\n}\nOrderbook.prototype.findBid = function (filter) {\n  return this.findOffer(\"bids\", filter)\n}\n\n/**\n * Returns the price of asset at **depth** XLM of orderbook's **side**.\n *\n * @param  {String} [side=\"bids\"] Either \"bids\" or \"asks\"\n * @param  {Number} [depth] The depth to look at, in term of XLM\n * @return {Number} Offer price at requested depth\n */\nOrderbook.prototype.marketPrice = function (side = \"bids\", depth = 50) {\n  const offer = this.findOffer(side, offer => offer.quoteVolume > depth)\n  return offer ? offer.price : 0\n}\n\n/**\n * Helpers\n */\n\nfunction areOffersEquals (array1, array2) {\n  if (!array1) return false\n  if (array1.length !== array2.length) return false\n  for (let index in array1.length) {\n    if (array1[index].amount !== array2[index].amount) return false\n    if (array1[index].price !== array2[index].price) return false\n  }\n  return true\n}\n\nfunction normalizeOffers (offers, quote, balance, side) {\n  offers.forEach(row => {\n    row.volume = undefined\n    row.baseVolume = undefined\n    row.basePrice = +row.price\n    row.quoteAmount = +row.amount\n    row.quoteVolume = undefined\n    row.balance = balance\n    row.side = side\n  })\n  return updateOffersPrices(offers, quote)\n}\n\nfunction updateOffersPrices (offers, quote) {\n  let volume = 0,\n    quoteVolume = 0,\n    baseVolume = 0\n  offers.forEach(row => {\n    if (row.side === \"asks\") {\n      row.quoteAmount = fixed7(row.amount * row.basePrice)\n    } else {\n      row.amount = fixed7(row.quoteAmount / row.basePrice)\n    }\n    row.price = fixed7(row.basePrice * quote.price)\n    row.volume = volume += fixed7(row.amount * row.price)\n    row.baseVolume = baseVolume += +row.amount\n    row.quoteVolume = quoteVolume += +row.quoteAmount\n  })\n  return offers\n}\n","\"use_strict\"\n/**\n * Balance entry\n */\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\n\nconst Anchor = require(\"./anchor\")\nconst Asset = require(\"./asset\")\nconst Orderbook = require(\"./orderbook\")\n\nconst global = require(\"./global\")\nconst { fixed7, positive, negative } = require(\"../helpers/misc\")\n\nconst Balance = module.exports = class Balance extends Projectable {\n  static resolve (code, issuer) {\n    const id = code ? `${code}:${issuer}` : \"XLM\"\n    return Balance.table[id]\n  }\n\n  static ingest (entry) {\n    const id = entryId(entry)\n    const balance = Balance.table[id]\n    if (!balance) return new Balance(entry, id)\n\n    balance.amount = +entry.balance\n    balance.buying = +entry.buying_liabilities\n    balance.selling = +entry.selling_liabilities\n    return balance\n  }\n\n  constructor (entry) {\n    super()\n\n    this.id = entryId(entry)\n    this.code = entry.asset_code || \"XLM\"\n    this.anchor = Anchor.resolve(entry.asset_issuer || \"stellar.org\")\n    Balance.table[this.id] = this\n\n    if (this.id === \"XLM\" || this.id in Anchor.known) {\n      this.asset = Asset.resolve(Anchor.known[this.id] || this.code)\n      this.known = true\n    } else {\n      this.asset = Asset.resolve(this.id)\n      this.known = false\n    }\n    this.amount = +entry.balance\n    this.buying = +entry.buying_liabilities\n    this.offers = new Mirrorable()\n    this.selling = +entry.selling_liabilities\n\n    this.asset.balances.push(this)\n\n    if (this.code === \"XLM\") {\n      this.asset.project(\"price\", this)\n    } else {\n      this.orderbook = Orderbook.forBalance(this, Asset.resolve(\"XLM\"))\n      this.orderbook.project(\"price\", this)\n    }\n  }\n}\n\nBalance.table = {}\nBalance.define(\"value\", [\"amount\", \"price\"], function () {\n  return this.amount === 0 ? 0 : this.amount * this.price\n})\n\n// targetAmount is set by \"./order.js\"\nBalance.define(\"targetMin\", [\"targetAmount\"], function () {\n  return fixed7(this.targetAmount * (1 - global.balanceTargetDeviation))\n})\nBalance.define(\"targetMax\", [\"targetAmount\"], function () {\n  return fixed7(this.targetAmount * (1 + global.balanceTargetDeviation))\n})\nBalance.define(\"targetMinDiff\", [\"amount\", \"targetMin\"], function () {\n  return fixed7(this.targetMin - this.amount)\n})\nBalance.define(\"targetMaxDiff\", [\"amount\", \"targetMax\"], function () {\n  return fixed7(this.targetMax - this.amount)\n})\nBalance.define(\"sizeMin\", [\"targetMinDiff\"], function () {\n  return negative(this.targetMinDiff)\n})\nBalance.define(\"sizeMax\", [\"targetMaxDiff\"], function () {\n  return positive(this.targetMaxDiff)\n})\nBalance.define(\"underMin\", [\"targetMinDiff\"], function () {\n  return negative(-this.targetMinDiff)\n})\nBalance.define(\"overMax\", [\"targetMaxDiff\"], function () {\n  return positive(-this.targetMaxDiff)\n})\n\n/**\n * Helpers\n */\n\nfunction entryId (entry) {\n  return entry.asset_code ? `${entry.asset_code}:${entry.asset_issuer}` : \"XLM\"\n}\n","\"use_strict\"\n/**\n * form.js  Generate formulary with ease\n *\n * Differences with ordinary interface:\n *\n * - Form request is sent only if `method=\"get\"` or `method=\"post\"` is\n *   explicitely set.\n * - Form inputs are `required` by default.\n * - Select control is renamed selector (verbs are reserved).\n */\n\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\nconst hiddenKey = require(\"@cosmic-plus/jsutils/es5/misc\").setHiddenProperty\n\nconst bindDomKey = require(\"./bind-dom-key\")\nconst handleExtraAttributes = require(\"./handle-extra-attributes\")\nconst html = require(\"./html-extra\")\n\n/**\n * Definition\n */\n\nclass Form extends Projectable {\n  /**\n   * Two forms:\n   *\n   * * new Form($form, attributes)\n   * * new Form([attributes], ...childs)\n   */\n  constructor (...params) {\n    super()\n\n    // Import or create the form DOM node.\n    if (params.length && params[0].tagName === \"FORM\") {\n      hiddenKey(this, \"domNode\", params[0])\n      if (params[1]) Object.assign(this.domNode, params[1])\n    } else {\n      hiddenKey(this, \"domNode\", html.element(\"form\", ...params))\n    }\n\n    // Validation - request is sent only if a method is explicitely set.\n    this.domNode.addEventListener(\"submit\", () => {\n      const method = this.domNode.getAttribute(\"method\")\n      if (!method) event.preventDefault()\n      this.trigger(\"submit\")\n    })\n\n    // Bind values\n    Form.bindInputs(this, this.domNode)\n    hiddenKey(this, \"dom\", handleExtraAttributes(this.domNode))\n\n    // Add message box if none exists.\n    if (!this.dom.status) {\n      this.dom.status = [Form.status()]\n      html.append(this.domNode, this.dom.status[0])\n    }\n  }\n\n  /**\n   * Controls\n   */\n\n  submit () {\n    this.domNode.submit()\n  }\n\n  reset () {\n    this.domNode.reset()\n  }\n\n  /**\n   * Status Display\n   */\n\n  report (type, ...content) {\n    const $status = this.dom.status[0]\n    if ($status) {\n      $status.className = type\n      html.rewrite($status, ...content)\n    }\n  }\n\n  info (content) {\n    this.report(\"info\", content, Form.spinner())\n  }\n\n  error (content) {\n    // Extract message from Error object. (TODO: handle it in html)\n    this.report(\"error\", content.message || content)\n    if (content instanceof Error) throw content\n    else throw new Error(content)\n  }\n}\n\n// Automatically clean report on user input.\nForm.listen(\"change\", event => event.report(null))\n\n/**\n * Binding\n */\n\nForm.bindInputs = function (object, $node) {\n  html.walk($node, binder, object)\n}\n\nfunction binder ($node, object) {\n  if ($node.name) bindDomKey(object, $node.name, $node)\n}\n\n/**\n * Helpers (Actions)\n */\n\nForm.enable = function (element, attributes) {\n  element.disabled = false\n  Object.assign(element, attributes)\n}\n\nForm.disable = function (element, attributes) {\n  element.enabled = true\n  Object.assign(element, attributes)\n}\n\nForm.hide = html.hide\nForm.show = html.show\n\n/**\n * Elements\n */\n\nForm.element = html.element\n\nForm.status = function (message = \"\") {\n  return Form.element(\"p\", { alias: \"status\" }, message)\n}\n\nForm.spinner = function () {\n  return Form.element(\"span\", { className: \"spinner\" })\n}\n\nForm.label = function (...params) {\n  return Form.element(\"label\", ...params)\n}\n\nForm.button = function (params, ...childs) {\n  if (!childs.length) childs = [params.value]\n  return Form.element(\"button\", params, ...childs)\n}\n\nForm.control = function (tag, params) {\n  const defaults = { required: true }\n  const attributes = Object.assign(defaults, params)\n  return Form.element(tag, attributes)\n}\n\nForm.textarea = function (params) {\n  return Form.control(\"textarea\", params)\n}\n\nForm.selector = function (params) {\n  const selector = Form.control(\"select\", params)\n  if (selector.values) {\n    html.append(selector, ...makeOptions(selector.values))\n  }\n  if (selector.placeholder) {\n    const placeholder = html.element(\n      \"option\",\n      { value: \"\", disabled: true, selected: true, hidden: true },\n      selector.placeholder\n    )\n    html.unshift(selector, placeholder)\n    if (params.selectedIndex != null) params.selectedIndex++\n  }\n\n  if (params.selectedIndex) selector.selectedIndex = params.selectedIndex\n  else if (params.value) selector.value = params.value\n\n  return selector\n}\n\nForm.input = function (type, params = {}) {\n  const input = Form.control(\"input\", params)\n  input.type = type\n  return input\n}\n\n// Exclude: button, datetime-local, reset, submit, select, search (no verbs)\nconst inputTypes = [\n  \"checkbox\",\n  \"color\",\n  \"date\",\n  \"email\",\n  \"file\",\n  \"hidden\",\n  \"image\",\n  \"month\",\n  \"number\",\n  \"password\",\n  \"radio\",\n  \"range\",\n  \"tel\",\n  \"text\",\n  \"time\",\n  \"url\",\n  \"week\"\n]\n\ninputTypes.forEach(type => Form[type] = params => Form.input(type, params))\nForm.datetime = params => Form.input(\"datetime-local\", params)\n\n/**\n * Elements Helpers\n */\n\nfunction makeOptions (object) {\n  if (object instanceof Array) {\n    return object.map(value => {\n      return html.element(\"option\", { value }, value)\n    })\n  } else {\n    return Object.keys(object).map(value => {\n      return html.element(\"option\", { value }, object[value])\n    })\n  }\n}\n\n/**\n * Export\n */\n\nmodule.exports = Form\n","\"use_strict\"\n/**\n * Additional methods for html.\n */\nconst html = Object.create(require(\"@cosmic-plus/domutils/es5/html\"))\nmodule.exports = html\n\n/**\n * Creates an new HTML element.\n */\nhtml.element = function (tag, ...params) {\n  let attributes\n  if (\n    params[0]\n    && params[0].constructor === Object\n    && params[0].domNode === undefined\n  ) {\n    attributes = params.shift()\n  }\n\n  return html.create(tag, attributes, ...params)\n}\n\n/**\n * Walks **element** dom tree, applying **func** to each node.\n */\nhtml.walk = function (element, func, ...params) {\n  func(element, ...params)\n  element.childNodes.forEach(child => html.walk(child, func, ...params))\n}\n\n/**\n * Add **...children** as first **parent** children.\n */\nhtml.unshift = function (parent, ...children) {\n  for (let i = 0; i < children.length; i++) {\n    parent.insertBefore(children[i], parent.childNodes[i])\n  }\n}\n","\"use_strict\"\n/**\n * Order class\n */\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst CosmicLink = cosmicLib.CosmicLink\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"./global\")\nconst {\n  positive,\n  negative,\n  fixed7,\n  clamp,\n  absoluteMin,\n  arraySum,\n  arrayScale\n} = require(\"../helpers/misc\")\n\n/**\n * Class\n */\n\nconst Order = module.exports = class Order extends Projectable {\n  static rebalance (target) {\n    if (target.asset.code === \"XLM\") return\n\n    const order = new Order(\"balance\", target.asset.orderbook, target)\n    order.watch(target, \"amount\", () => order.refresh())\n    order.watch(target.asset.orderbook, [\"bids\", \"asks\"], () => order.refresh())\n    target.asset.offers.listen(\"change\", () => order.refresh(), order)\n\n    return order\n  }\n\n  constructor (type, orderbook, ...parameters) {\n    super()\n    this.type = type\n    this.method = Order.type[this.type]\n    this.operations = new Mirrorable()\n    this.orderbook = orderbook\n    this.parameters = parameters\n\n    this.operations.listen(\"update\", () => {\n      this.compute([\"cosmicLink\", \"description\"])\n    })\n\n    this.refresh()\n  }\n\n  refresh () {\n    this.operations.splice(0, this.operations.length)\n    this.operations.trigger(\"update\")\n    this.method(this, ...this.parameters)\n    this.trigger(\"refresh\")\n  }\n\n  /**\n   * Operations Management\n   */\n\n  getOperation (offer, make) {\n    const id = `${offer.balance.anchor.name}:${make ? offer.price : \"take\"}`\n    const operation = this.operations.find(x => x.id === id)\n    if (operation) {\n      return operation\n    } else {\n      const newOperation = { id }\n      this.operations.push(newOperation)\n      return newOperation\n    }\n  }\n\n  addOperation (offer, amount) {\n    const operation = this.getOperation(offer, amount > 0)\n    this.setOperation(operation, offer, Number(amount) || operation.amount)\n  }\n\n  setOperation (operation, offer, amount) {\n    operation.amount = fixed7(amount)\n    operation.cost = amount * offer.price\n    operation.offer = offer\n    this.operations.trigger(\"update\")\n  }\n}\n\nOrder.define(\"cosmicLink\", \"operations\", function () {\n  return Order.operationsToCosmicLink(this.operations)\n})\nOrder.define(\"description\", \"operations\", function () {\n  return Order.operationsToDescription(this.operations)\n})\n\n/**\n * Utilities\n */\n\nOrder.operationsToCosmicLink = function (operations = []) {\n  const cosmicLink = new CosmicLink({\n    memo: \"Equilibre.io\",\n    maxTime: \"+5\",\n    source: global.portfolio.accountId\n  })\n  operations.forEach(operation => {\n    cosmicLink.addOperation(\"manageOffer\", operationToOdesc(operation))\n  })\n\n  return cosmicLink\n}\n\nOrder.operationsToDescription = function (operations = []) {\n  const desc = []\n  operations.forEach(op => {\n    if (operationDirection(op) === \"buy\") {\n      desc.push(`\n${__(\"Buy\")} ${nice(op.amount)} ${op.offer.balance.code} ${__(\"at\")} \\\n${nice(op.offer.price)} ${global.currency}\n      `)\n    } else {\n      desc.push(`\n${__(\"Sell\")} ${nice(op.amount)} ${op.offer.balance.code} ${__(\"at\")} \\\n${nice(op.offer.price)} ${global.currency}\n      `)\n    }\n  })\n  return desc\n}\n\n/**\n * Helpers\n */\n\nfunction operationDirection (op) {\n  if (\n    op.amount > 0 && op.offer.side === \"bids\"\n    || op.amount < 0 && op.offer.side === \"asks\"\n  ) {\n    return \"buy\"\n  } else {\n    return \"sell\"\n  }\n}\n\nfunction operationToOdesc (operation) {\n  const offer = operation.offer\n  const base = offer.balance.code + \":\" + offer.balance.anchor.address\n  const quote = \"XLM\"\n\n  let odesc\n  if (operationDirection(operation) === \"buy\") {\n    odesc = {\n      buying: base,\n      selling: quote,\n      amount: fixed7(operation.amount * offer.price_r.n / offer.price_r.d),\n      price: { n: offer.price_r.d, d: offer.price_r.n }\n    }\n  } else {\n    odesc = {\n      buying: quote,\n      selling: base,\n      amount: operation.amount,\n      price: offer.price_r\n    }\n  }\n  odesc.offerId = operation.offer.id\n\n  return odesc\n}\n\n/**\n * Orders types\n */\n\nOrder.type = {}\n\nOrder.type.market = function (order, size) {\n  if (!size) return\n\n  const side = size > 0 ? \"asks\" : \"bids\"\n  const amount = Math.abs(size)\n  const offer = order.orderbook.findOffer(side, offer => {\n    return offer.baseVolume > amount\n  })\n  order.addOperation(offer, amount)\n}\n\nOrder.type.limit = function (order, size, { orderbook, filter }) {\n  if (!size) return\n\n  const side = size > 0 ? \"bids\" : \"asks\"\n  const offer = (orderbook || order.orderbook).findOffer(side, filter)\n  if (offer) order.addOperation(tightenSpread(offer), Math.abs(size))\n}\n\n/**\n * Rebalancing\n */\n\nOrder.type.balance = function (order, target) {\n  const asset = target.asset\n  const orderbook = asset.orderbook\n\n  // Requirements\n\n  if (target.amount == null || target.amountDelta === 0) return\n\n  if (!orderbook.bestBid || !orderbook.bestAsk) {\n    order.description = [__(\"Fetching orderbook...\")]\n    return\n  }\n\n  if (asset.liabilities) {\n    const currentOffers = asset.offers.filter(offer => !offer.outdated)\n    if (currentOffers.length) {\n      order.description = [__(\"Rebalancing...\")]\n      return\n    }\n  }\n\n  // Rebalancing\n\n  setBalancesTargets(target)\n  if (!areTargetAnchorsBalanced(target)) {\n    balanceTargetAnchors(target, target.amountDiff)\n  } else if (isOneOperationEnough(target, target.amountDiff)) {\n    addOneOperation(target, target.amountDiff)\n  } else {\n    addMultipleOperations(target, target.amountDiff)\n  }\n}\n\n/**\n * Set the `targetAmount` property of **target** balances according to\n * `target.amount`.\n */\nfunction setBalancesTargets (target) {\n  // Empty orderbooks cannot be traded.\n  const balances = []\n  target.asset.balances.forEach(balance => {\n    if (balance.orderbook.price != null) balances.push(balance)\n    else balance.targetAmount = null\n  })\n\n  // Special cases.\n  if (!balances.length) {\n    return\n  } else if (balances.length === 1) {\n    return balances[0].targetAmount = target.amount\n  }\n\n  // Set each balance tradable amount.\n  const targetAmount = fixed7(target.amount / balances.length)\n  balances.forEach(balance => balance.targetAmount = targetAmount)\n}\n\n/**\n * Returns whether or not **target** asset anchors current funds are risk\n * balanced.\n */\nfunction areTargetAnchorsBalanced (target) {\n  const balances = target.asset.balances\n  return !(arraySum(balances, \"underMin\") && arraySum(balances, \"overMax\"))\n}\n\n/**\n * Create a set of operations that even out anchor amounts of `target.asset`.\n */\nfunction balanceTargetAnchors (\n  target,\n  size = target.amountDiff,\n  riskMax = global.anchorsRebalanceRiskMax\n) {\n  const balances = target.asset.balances\n\n  // Compute the amount to transfer between anchors.\n  const under = -arraySum(balances, \"underMin\")\n  const over = arraySum(balances, \"overMax\")\n  const misallocated = Math.max(under - positive(size), over + negative(size))\n\n  // Eventually limit risk by capping that amount.\n  const currentRisk = Math.abs(target.valueDiffP)\n  const amountCap = target.amount * positive(riskMax - currentRisk)\n  const transferAmount = Math.min(misallocated, amountCap)\n\n  // Factor in the amount of asset to buy/sell to balance portfolio.\n  const buy = fixed7(transferAmount + positive(size))\n  const sell = fixed7(transferAmount - negative(size))\n\n  // Generate operations accordingly.\n  addMultipleOperations(target, buy)\n  addMultipleOperations(target, -sell)\n}\n\n/**\n * Returns whether or not it is possible meet **target** rebalancing target in\n * one operation.\n */\nfunction isOneOperationEnough (target, size) {\n  const balances = target.asset.balances\n  return !!balances.filter(b => b.sizeMin <= size && size <= b.sizeMax).length\n}\n\n/**\n * Adds an operation to `target.order` that trades **size** `target.asset` on\n * **orderbook**.\n */\nfunction addOneOperation (target, size, orderbook = target.asset.orderbook) {\n  const noMinValue = target.mode === \"quantity\" || target.amount === 0\n  const baseAsk = orderbook.asks[0].basePrice\n  if (!noMinValue && Math.abs(size * baseAsk) < global.minOfferValue) return\n\n  const filter = makeOfferFilter(target, size)\n  Order.type.limit(target.order, size, { orderbook, filter })\n}\n\n/**\n * Split a trade over multiple anchors.\n */\nfunction addMultipleOperations (target, size) {\n  const balances = target.asset.balances\n\n  // First trade under/over allocated funds, if any.\n  const misallocatedKey = positive(size) ? \"underMin\" : \"overMax\"\n  const misallocated = arraySum(balances, misallocatedKey)\n  const toTrade = absoluteMin(size, misallocated)\n  const sizes = arrayScale(balances, toTrade, misallocatedKey)\n\n  // Then, if it was not enough, trade available well-allocated funds.\n  if (toTrade !== size) {\n    const sizeKey = positive(size) ? \"sizeMax\" : \"sizeMin\"\n    const remains = size - misallocated\n    const tradable = balances.map(b => b[sizeKey] - b[misallocatedKey])\n    const sizes2 = arrayScale(tradable, remains)\n    sizes2.forEach((value, index) => sizes[index] += value)\n  }\n\n  // Create operations accordingly.\n  balances.forEach((balance, index) => {\n    const size = fixed7(sizes[index])\n    addOneOperation(target, size, balance.orderbook)\n  })\n}\n\n/**\n * Returns a balancing offer filter for **tradedAmount** to be used with\n * `Orderbook.findOffer()`.\n */\nfunction makeOfferFilter (target, size) {\n  return offer => {\n    return (\n      size >= offer.balance.sizeMin\n      && size <= offer.balance.sizeMax\n      && offer.baseVolume > Math.abs(size) * global.skipMarginalOffers\n    )\n  }\n}\n\n/**\n * Create a copy of **offer** with a delta to global market price reduced by\n * **percentage**.\n */\nfunction tightenSpread (offer, percentage = global.spreadTightening) {\n  const clone = Object.assign({}, offer)\n  const diff = percentage * offer.balance.asset.orderbook[\"spread%\"] / 100\n\n  if (offer.side === \"bids\") clone.price = offer.price * (1 + diff)\n  else clone.price = offer.price * (1 - diff)\n\n  if (offer.balance.asset.globalPrice) clampOfferPrice(clone)\n  updateOfferPriceR(clone)\n\n  return clone\n}\n\n/**\n * Floor/ceil **offer**'s price between global market price and **premium**.\n */\nfunction clampOfferPrice (offer, premium = global.maxSpread / 2) {\n  const globalPrice = offer.balance.asset.price\n  if (offer.side === \"bids\") {\n    offer.price = clamp(offer.price, globalPrice * (1 - premium), globalPrice)\n  } else {\n    offer.price = clamp(offer.price, globalPrice, globalPrice * (1 + premium))\n  }\n}\n\n/**\n * Set `offer.price_r` according to `offer.price`.\n *\n * @param  {Object} offer\n */\nfunction updateOfferPriceR (offer) {\n  const quote = offer.balance.orderbook.quote\n\n  offer.price_r = {\n    n: nice(offer.price * 10000000000, 0),\n    d: nice(quote.price * 10000000000, 0)\n  }\n\n  // Ten characters maximum\n  while (offer.price_r.n > 999999999 || offer.price_r.d > 999999999) {\n    offer.price_r.n = nice(offer.price_r.n / 10, 0)\n    offer.price_r.d = nice(offer.price_r.d / 10, 0)\n  }\n}\n\n/**\n * Append Order.type to Order class\n */\n\nfor (let key in Order.type) {\n  if (!Order[key]) Order[key] = (...parameters) => new Order(key, ...parameters)\n}\n","\"use_strict\"\n/**\n * Compute portfolio data from Account object.\n */\nconst axios = require(\"@cosmic-plus/base/es5/axios\")\nconst cosmicLib = require(\"cosmic-lib\")\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst Asset = require(\"./asset\")\nconst Balance = require(\"./balance\")\nconst global = require(\"./global\")\n// const History = require(\"./portfolio-history\")\nconst Offers = require(\"./offers\")\n\nconst { arraySum } = require(\"../helpers/misc\")\n/**\n * Class\n */\n\nmodule.exports = class Portfolio extends Projectable {\n  static async resolve (address) {\n    await checkNetwork()\n\n    const destination = await cosmicLib.resolve.address(address)\n    if (destination.memo)\n      throw new Error(__(\"Invalid federated address: shared account.\"))\n    if (await cosmicLib.resolve.isAccountEmpty(destination.account_id))\n      throw new Error(__(\"Empty account\"))\n\n    const portfolio = new Portfolio(destination.account_id)\n    cosmicLib.config.source = portfolio.address = address\n    portfolio.streamAccount()\n\n    return portfolio\n  }\n\n  constructor (accountId) {\n    super()\n\n    // eslint-disable-next-line no-console\n    console.log(this)\n\n    this.accountId = accountId\n    this.assets = new Mirrorable()\n    this.balances = new Mirrorable()\n    this.accountCallBuilder = Portfolio.accountCallBuilder(accountId)\n\n    this.define(\"total\", \"assets\", () => {\n      const assets = this.assets.filter(asset => asset.isSupported)\n      return arraySum(assets, \"value\")\n    })\n    this.assets.mirror(asset =>\n      this.watch(asset, [\"value\", \"isSupported\"], () => this.compute(\"total\"))\n    )\n\n    this.new = true\n  }\n\n  static accountCallBuilder (accountId) {\n    const server = cosmicLib.resolve.server()\n    return server.accounts().accountId(accountId)\n  }\n\n  async streamAccount () {\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      await this.getAccount()\n      await timeout(5000)\n    }\n  }\n\n  async getAccount () {\n    try {\n      const account = await this.accountCallBuilder.call()\n      this.ingest(account)\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  async ingest (account) {\n    this.account = account\n\n    for (let index in account.balances) {\n      const balance = Balance.ingest(account.balances[index])\n      const asset = balance.asset\n\n      if (this.assets.indexOf(asset) === -1) {\n        this.assets.push(asset)\n        this.balances.push(balance)\n        asset.watch(this, \"total\", () => asset.compute(\"share\"))\n        asset.getInfo()\n      } else if (this.balances.indexOf(balance) === -1) {\n        this.balances.push(balance)\n      }\n    }\n\n    if (this.new) {\n      delete this.new\n      await Asset.refreshPrices()\n      this.offers = Offers.forPortfolio(this)\n      await this.offers.stream()\n      this.trigger(\"open\")\n    }\n  }\n}\n\n/**\n * Extension\n */\n\nAsset.define(\"share\", \"value\", function () {\n  return global.portfolio && this.value / global.portfolio.total\n})\n\n/**\n * Helpers\n */\n\nasync function checkNetwork () {\n  const horizon = cosmicLib.resolve.horizon()\n  try {\n    await axios.get(horizon)\n  } catch (error) {\n    throw new Error(__(\"Can't connect to the Stellar blockchain\"))\n  }\n}\n","\"use_strict\"\n/**\n * Anchor class\n */\nconst aliases = require(\"@cosmic-plus/base/es5/aliases\")\nconst helpers = require(\"@cosmic-plus/jsutils/es5/misc\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\n\n/**\n * Class\n */\n\nconst Anchor = module.exports = class Anchor extends Projectable {\n  static resolve (address) {\n    return Anchor.all[address] || new Anchor(address)\n  }\n\n  constructor (address) {\n    super()\n\n    this.address = address\n    this.alias = aliases.all[address]\n    this.name = helpers.shorter(this.alias || this.address)\n    Anchor.all[address] = this\n\n    this.assets = {}\n  }\n}\n\nAnchor.all = {}\n\n/**\n * Known Anchors\n */\n\nAnchor.known = {\n  \"USD:GDUKMGUGDZQK6YHYA5Z6AY2G4XDSZPSZ3SW5UN3ARVMO6QSRDWP5YLEX\": \"USD\",\n  \"WSD:GDSVWEA7XV6M5XNLODVTPCGMAJTNBLZBXOFNQD3BNPNYALEYBNT6CE2V\": \"USD\",\n  \"USD:GDSRCV5VTM3U7Y3L6DFRP3PEGBNQMGOWSRTGSBWX6Z3H6C7JHRI4XFJP\": \"USD\",\n  \"USD:GBUYUAI75XXWDZEKLY66CFYKQPET5JR4EENXZBUZ3YXZ7DS56Z4OKOFU\": \"USD\",\n  \"CNY:GAREELUB43IRHWEASCFBLKHURCGMHE5IF6XSE7EXDLACYHGRHM43RFOX\": \"CNY\",\n  \"XCN:GCNY5OXYSY4FKHOPT2SPOQZAOEIGXB5LBYW3HVU3OWSTQITS65M5RCNY\": \"CNY\",\n  \"BCNY:GBCNYBHAAPDSU3UIHXXQTHYZVSBJBI4YUNWXMKJBCPDHTVYR75G6NFHD\": \"CNY\",\n  \"EURT:GAP5LETOV6YIE62YAM56STDANPRDO7ZFDBGSNHJQIYGGKSMOZAHOOS2S\": \"EUR\",\n\n  \"SLT:GCKA6K5PCQ6PNF5RQBF7PQDJWRHO6UOGFMRLK3DYHDOI244V47XKQ4GP\": null,\n  \"MOBI:GA6HCMBLTZS5VYYBCATRBRZ3BZJMAFUDKYYF6AH6MVCMGWMRDNSWJPIH\": null,\n  \"SHX:GDSTRSHXHGJ7ZIVRBXEYE5Q74XUVCUSEKEBR7UCHEUUEK72N7I7KJ6JH\": null,\n  \"RMT:GDEGOXPCHXWFYY234D2YZSPEJ24BX42ESJNVHY5H7TWWQSYRN5ZKZE3N\": null,\n  \"TERN:GDGQDVO6XPFSY4NMX75A7AOVYCF5JYGW2SHCJJNWCQWIDGOZB53DGP6C\": null,\n  \"PEDI:GBVUDZLMHTLMZANLZB6P4S4RYF52MVWTYVYXTQ2EJBPBX4DZI2SDOLLY\": null,\n  \"GRAT:GAJ7V3EMD3FRWAPBEJAP7EC4223XI5EACDZ46RFMY5DYOMCIMWEFR5II\": null,\n  \"REPO:GCZNF24HPMYTV6NOEHI7Q5RJFFUI23JKUKY3H3XTQAFBQIBOHD5OXG3B\": null,\n\n  \"BTC:GATEMHCCKCY67ZUCKTROYN24ZYT5GK4EQZ65JJLDHKHRUZI3EUEKMTCH\": null,\n  \"BTC:GAUTUYY2THLF7SGITDFMXJVYH3LHDSMGEAKSBU267M2K7A3W543CKUEF\": null,\n  \"BTC:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P\": null,\n  \"BTC:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5\": null,\n  \"ETH:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P\": null,\n  \"ETH:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5\": null,\n  \"ETH:GBETHKBL5TCUTQ3JPDIYOZ5RDARTMHMEKIO2QZQ7IOZ4YC5XV3C2IKYU\": null,\n  \"ETH:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR\": null,\n  \"LTC:GC5LOR3BK6KIOK7GKAUD5EGHQCMFOGHJTC7I3ELB66PTDFXORC2VM5LP\": null,\n  \"LTC:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5\": null,\n  \"LTC:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P\": null,\n  \"XRP:GBVOL67TMUQBGL4TZYNMY3ZQ5WGQYFPFD5VJRWXR72VA33VFNL225PL5\": null,\n  \"XRP:GCNSGHUCG5VMGLT5RIYYZSO7VQULQKAJ62QA33DBC5PPBSO57LFWVV6P\": null,\n  \"KIN:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR\": null,\n  \"BAT:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR\": null,\n  \"ZRX:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR\": null,\n  \"BCH:GAEGOS7I6TYZSVHPSN76RSPIVL3SELATXZWLFO4DIAFYJF7MPAHFE7H4\": null,\n  \"STEEM:GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM\": null,\n  \"SBD:GB3KBOFUCVTWEZ7YIZ7PAKLQMKPCTGWU3LOMANMCT7V6I3AAK4USTEEM\": null,\n  \"LINK:GBDEVU63Y6NTHJQQZIKVTC23NWLQVP3WJ2RI2OTSJTNYOIGICST6DUXR\": null\n}\n","\"use_strict\"\n/**\n * Account offers\n */\n\nconst cosmicLib = require(\"cosmic-lib\")\nconst loopcall = require(\"@cosmic-plus/loopcall\")\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\nconst hiddenKey = require(\"@cosmic-plus/jsutils/es5/misc\").setHiddenProperty\nconst { day } = require(\"@cosmic-plus/jsutils/es5/misc\")\n\nconst Asset = require(\"./asset\")\nconst Balance = require(\"./balance\")\n\nconst { fixed7 } = require(\"../helpers/misc\")\n\n/**\n * Class\n */\n\nclass Offers extends Mirrorable {\n  static forPortfolio (portfolio) {\n    const offers = Offers.forAccount(portfolio.accountId)\n    hiddenKey(offers, \"portfolio\", portfolio)\n    return offers\n  }\n\n  static forAccount (accountId) {\n    const offers = new Offers()\n    hiddenKey(offers, \"accountId\", accountId)\n    hiddenKey(offers, \"callBuilder\", Offers.callBuilder(accountId))\n    return offers\n  }\n\n  static callBuilder (accountId) {\n    const server = cosmicLib.resolve.server()\n    return server.offers(\"accounts\", accountId)\n  }\n\n  async stream (delay = 15000) {\n    // Resolves after first get().\n    return this.get().then(() => setTimeout(() => this.stream(), delay))\n  }\n\n  async get () {\n    try {\n      const records = await loopcall(this.callBuilder, { limit: 200 })\n      this.ingest(records)\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  ingest (records) {\n    this.forEach(offer => offer.alive = false)\n    const offers = records.map(record => Offer.ingest(record)).filter(x => x)\n    this.splice(0, 0, ...offers)\n    this.clean()\n  }\n\n  clean () {\n    for (let index = this.length - 1; index > -1; index--) {\n      const offer = this[index]\n      if (!offer.alive) {\n        this.splice(index, 1)\n        offer.destroy()\n      }\n    }\n  }\n}\n\nclass Offer extends Projectable {\n  static resolve (record) {\n    return Offer.table[recordToId(record)]\n  }\n\n  static ingest (record) {\n    const offer = Offer.resolve(record)\n    if (offer) offer.update(record)\n    else return new Offer(record)\n  }\n\n  constructor (record) {\n    super()\n\n    this.intern = recordToId(record)\n    Offer.table[this.intern] = this\n\n    const quote = Asset.resolve(\"XLM\")\n    const asset = record.buying.asset_code ? record.buying : record.selling\n    this.balance = Balance.resolve(asset.asset_code, asset.asset_issuer)\n    this.asset = this.balance.asset\n    this.side = record.buying.asset_code ? \"buy\" : \"sell\"\n\n    this.define(\n      \"price\",\n      \"rawPrice\",\n      this.side === \"sell\"\n        ? () => quote.price * this.rawPrice\n        : () => quote.price / this.rawPrice\n    )\n    this.watch(quote, \"price\", () => this.compute(\"price\"))\n\n    this.update(record)\n\n    this.balance.offers.push(this)\n    this.asset.offers.push(this)\n\n    this.listen(\"destroy\", () => {\n      delete Offer.table[this.intern]\n      this.balance.offers.splice(this.balance.offers.indexOf(this), 1)\n      this.asset.offers.splice(this.asset.offers.indexOf(this), 1)\n    })\n  }\n\n  update (record) {\n    Object.assign(this, record)\n    this.alive = true\n\n    this.rawPrice = record.price\n    this.compute(\"price\")\n    this.rawAmount = record.amount\n    if (this.side === \"buy\") {\n      this.amount = fixed7(this.rawAmount * this.rawPrice)\n    }\n\n    this.date = day(this.last_modified_time)\n    this.outdated = this.date !== day()\n  }\n}\n\nOffer.table = {}\n\n/**\n * Helpers\n */\n\nfunction recordToId (record) {\n  return `${record.id}-${record.last_modified_ledger}`\n}\n\n/**\n * Export\n */\n\nmodule.exports = Offers\n","\"use_strict\"\n/**\n * Overlay that prevent user interaction\n */\nconst clickWall = module.exports\n\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\n\nconst overlay = html.create(\"div\", { hidden: true })\nhtml.append(document.body, overlay)\n\nObject.assign(overlay.style, {\n  position: \"fixed\",\n  zIndex: 999,\n  top: 0,\n  width: \"100%\",\n  height: \"100%\"\n})\n\nclickWall.enable = () => html.show(overlay)\nclickWall.disable = () => html.hide(overlay)\n","\"use_strict\"\n\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\n\n/**\n * Bind **$input**'s **nodeKey** to **object** **objKey**. If **nodeKey** is not\n * provided, the default value is used.\n */\nmodule.exports = function bindnodeKey (object, objKey, $input, nodeKey) {\n  const binder = bind[$input.tagName]\n  if (binder) binder(object, objKey, $input, nodeKey)\n  else object[objKey] = $input[nodeKey || \"value\"]\n}\n\n/**\n * Element-specific binders\n */\nconst bind = {}\n\nbind.SELECT = function (object, objKey, $select, nodeKey = \"value\") {\n  object[objKey] = $select[nodeKey]\n  if (bind.SELECT.interactive.indexOf(nodeKey) !== -1) {\n    importKeyOn(\"change\", object, objKey, $select, nodeKey)\n  }\n}\nbind.SELECT.interactive = [\"selectedIndex\", \"selectedOptions\", \"value\"]\n\nbind.TEXTAREA = function (object, objKey, $textarea, nodeKey = \"value\") {\n  object[objKey] = $textarea[nodeKey]\n  if (nodeKey === \"value\") {\n    importKeyOn(\"input\", object, objKey, $textarea, nodeKey)\n  }\n}\n\nbind.INPUT = function (object, objKey, $input, nodeKey) {\n  object[objKey] = $input[nodeKey]\n  if ($input.type === \"radio\") {\n    bind.radio(...arguments)\n  } else if ($input.type === \"checkbox\") {\n    bind.checkbox(...arguments)\n  } else if (!nodeKey || nodeKey === \"value\") {\n    importKeyOn(\"input\", object, objKey, $input, nodeKey || \"value\")\n  }\n}\n\nbind.radio = function (object, objKey, $radio) {\n  const setter = () => {\n    if ($radio.checked) object[objKey] = $radio.value\n  }\n  $radio.addEventListener(\"change\", setter)\n  setter()\n}\n\nbind.checkBox = function (object, objKey, $checkbox, nodeKey = \"checked\") {\n  object[objKey] = $checkbox[nodeKey]\n  if (nodeKey === \"checked\") {\n    importKeyOn(\"change\", object, objKey, $checkbox, nodeKey)\n  }\n}\n\n/**\n * Event setter.\n */\nfunction importKeyOn (eventName, object, objKey, $input, nodeKey) {\n  $input.addEventListener(eventName, () => {\n    object[objKey] = $input[nodeKey]\n    $input.setCustomValidity(\"\")\n  })\n  if (object instanceof Projectable) {\n    object.link(objKey, $input, nodeKey, null, { init: false })\n  }\n}\n","\"use_strict\"\n\nconst { timeout } = require(\"@cosmic-plus/jsutils/es5/misc\")\n\nconst html = require(\"./html-extra\")\n\n/**\n * Walk **$node** tree and handle extra attributes for each domNode. Extra\n * attributes are:\n *\n * * alias:  Define an identifier for the local context.\n * * label:  Enclose the node into a dedicated label element.\n */\nmodule.exports = function walkNodeTree ($node) {\n  const aliases = {}\n  html.walk($node, handleExtraAttributes, aliases)\n  return aliases\n}\n\nfunction handleExtraAttributes ($node, aliases) {\n  setAliases($node, aliases)\n  handleLabel($node)\n  handleValidate($node)\n}\n\n/**\n * Bind **$node** to **aliases** properties for to its className, alias, name\n * and/or id.\n */\nfunction setAliases ($node, aliases) {\n  // Ordered by priority\n  if ($node.className) {\n    if (!aliases[$node.className]) aliases[$node.className] = []\n    aliases[$node.className].push($node)\n  } else if ($node.alias) {\n    aliases[$node.alias] = $node\n    delete aliases[$node.alias]\n  } else if ($node.name) {\n    aliases[$node.name] = $node\n  } else if ($node.id) {\n    aliases[$node.id] = $node\n  }\n}\n\n/**\n * Enclose **$node** into its own label if it has a `label=` attribute.\n */\nfunction handleLabel ($node) {\n  // `<option>` tags have a `label` attribute in HTML5.\n  if (!$node.label || $node.tagName === \"OPTION\") return\n\n  const $label = html.element(\"label\", { for: $node })\n  const $span = html.element(\"span\", $node.label)\n  html.replace($node, $label)\n  html.append($label, $span, $node)\n  delete $node.label\n}\n\n/**\n * Setup automatic validation using **$node**'s validate function.\n */\nfunction handleValidate ($node) {\n  const validate = $node.validate\n  if (!validate || !$node.hasProperty(\"oninput\")) return\n\n  $node.addEventListener(\"input\", () => {\n    $node.setCustomValidity(\"\")\n    timeout(0).then(() => validateNodeValue($node, validate))\n  })\n  delete $node.validate\n}\n\nfunction validateNodeValue ($node, validate) {\n  try {\n    validate($node.value)\n  } catch (error) {\n    $node.setCustomValidity(error.message)\n    $node.reportValidity()\n    console.error(error)\n  }\n}\n","\"use_strict\"\n/**\n * Various helpers\n */\n\nconst helpers = exports\n\nhelpers.isOverflowing = function (element) {\n  return (\n    element.scrollHeight > element.clientHeight\n    || element.scrollWidth > element.clientWidth\n  )\n}\n","\"use_strict\"\n/**\n * Activity Gui\n */\n\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst ActiveOffersTable = require(\"./widgets/active-offers-table\")\nconst global = require(\"./logic/global\")\n\n/**\n * Class\n */\n\nmodule.exports = class ActivityGui extends Gui {\n  constructor (portfolio) {\n    super(`\n<section class=\"ActivityGui\">\n  <h2>${__(\"Activity\")}</h2>\n\n  %table\n\n  <p class=\"note\">\n    ${__(\"All orders are passed against Stellar Lumens (XLM).\")}\n    ${__(\n    \"For your comfort, prices are displayed in their %%globalCurrency equivalent.\"\n  )}\n    ${__(\n    \"However, those converted values will change according to XLM price movement.\"\n  )}\n  </p>\n\n</section>\n    `)\n\n    this.portfolio = portfolio\n    this.table = new ActiveOffersTable(portfolio)\n    this.globalCurrency = global.currency\n  }\n}\n","\"use strict\"\n/**\n * Active Offers Table\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { CosmicLink } = require(\"cosmic-lib\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst SideFrame = require(\"../helpers/side-frame\")\n\nconst global = require(\"../logic/global\")\n\nmodule.exports = class ActiveOffersTable extends Gui {\n  constructor (portfolio) {\n    super(`\n<section class=\"ActiveOffersTable\">\n  <table>\n    <tr>\n      <th>${__(\"Date\")}</th>\n      <th>${__(\"Asset\")}</th>\n      <th>${__(\"Direction\")}</th>\n      <th>${__(\"Amount\")}</th>\n      <th>${__(\"Price\")} (%globalCurrency)</th>\n    </tr>\n    %toOfferRow:offers...\n    <tr><td colspan=\"5\" align=\"center\" onclick=%cancelOffers>\n      <h3>${__(\"Cancel All\")}</h3>\n    </td></tr>\n  </table>\n</section>\n    `)\n\n    this.portfolio = portfolio\n    this.offers = portfolio.offers\n    this.globalCurrency = global.currency\n  }\n\n  toOfferRow (offer) {\n    return new OfferRow(offer)\n  }\n\n  cancelOffers () {\n    if (!this.offers.length) return\n\n    const txParams = {\n      memo: \"Equilibre.io\",\n      network: \"public\",\n      maxTime: \"+5\",\n      source: this.portfolio.accountId\n    }\n\n    const cosmicLink = new CosmicLink(txParams)\n    this.offers.forEach(offer => {\n      cosmicLink.addOperation(\"manageOffer\", { offerId: offer.id, amount: 0 })\n    })\n\n    const sideFrame = new SideFrame(cosmicLink.uri)\n    sideFrame.listen(\"destroy\", () => {\n      this.portfolio.getAccount()\n      this.portfolio.offers.get()\n    })\n  }\n}\n\nclass OfferRow extends Gui {\n  constructor (offer) {\n    super(`\n<tr>\n  <td>%toDate:last_modified_time</td>\n  <td>\n    <img src=%image alt=\"\">\n    <span>%name / %anchor</span>\n  </td>\n  <td>%side</td>\n  <td align=\"right\">%nice:amount</td>\n  <td align=\"right\">%nice:price</td>\n</tr>\n    `)\n\n    this.offer = offer\n    offer.project([\"last_modified_time\", \"amount\", \"price\"], this)\n\n    this.name = offer.asset.code\n    this.side = offer.side === \"buy\" ? __(\"Buy\") : __(\"Sell\")\n    this.anchor = offer.balance.anchor.name\n    offer.asset.link(\"image\", this)\n  }\n\n  nice (number) {\n    return nice(number)\n  }\n\n  toDate (value) {\n    const date = value ? new Date(value) : new Date()\n    return date.toLocaleDateString()\n  }\n}\n","\"use_strict\"\n/**\n * Portfolio Graphical User Interface\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst Tabs = require(\"@cosmic-plus/domutils/es5/tabs\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst AssetPriceChart = require(\"./widgets/asset-price-chart\")\nconst PortfolioPieChart = require(\"./widgets/portfolio-pie-chart\")\nconst PortfolioTable = require(\"./widgets/portfolio-table\")\n\nconst global = require(\"./logic/global\")\n\n/**\n * Class\n */\n\nmodule.exports = class PortfolioGui extends Gui {\n  constructor (portfolio) {\n    super(`\n<section><h2>${__(\"Portfolio\")}: %total %currency</h2>\n\n  %nav\n  <section>%view</section>\n\n  %priceChart\n\n  <p class=\"note\">\n    ${__(\"Anchor prices are from Stellar DEX\")} /\n    ${__(\"Global prices are from %%coingecko when available.\")}\n  </p>\n\n</section>`)\n\n    this.portfolio = portfolio\n\n    // Init.\n    portfolio.project(\"total\", this, x => nice(x, 2))\n    this.currency = global.currency\n    this.coingecko = new Gui(\n      `<a target=\"_blank\" rel=\"noopener\" href=\"https://coingecko.com\">coingecko</a>`\n    )\n\n    // Bind components together.\n    this.table = new PortfolioTable(portfolio)\n    this.project(\"selected\", this.table)\n    this.table.project(\"selected\", this)\n\n    this.pieChart = new PortfolioPieChart(portfolio)\n    this.project(\"selected\", this.pieChart)\n    this.pieChart.project(\"selected\", this)\n\n    this.trap(\"selected\", () => this.maybeDrawPriceChart())\n\n    // Create overview.\n    const overview = new Tabs()\n    overview.add(\"table\", __(\"Table\"), this.table)\n    overview.add(\"chart\", __(\"Chart\"), this.pieChart)\n\n    overview.project([\"nav\", \"view\"], this)\n    overview.listen(\"select\", id => {\n      if (id === \"chart\") this.pieChart.reflow()\n    })\n\n    // Save & load last selected tab.\n    overview.listen(\"select\", id => localStorage[\"PortfolioSummary.tab\"] = id)\n    overview.select(localStorage[\"PortfolioSummary.tab\"])\n    if (!overview.selected) overview.select(\"table\")\n  }\n\n  maybeDrawPriceChart () {\n    if (this.priceChart) this.priceChart.destroy()\n\n    const asset = this.selected\n    const assetHasChart = asset && (asset.isTether || asset.apiId)\n\n    if (assetHasChart && asset.code !== global.currency) {\n      this.priceChart = new AssetPriceChart(asset)\n    } else {\n      this.priceChart = null\n    }\n  }\n}\n","\"use strict\"\n/**\n * Asset Price Chart\n */\nconst Highstock = require(\"highcharts/highstock\")\n\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"../logic/global\")\nconst marketData = require(\"../logic/market-data\")\n\n/**\n * Class\n */\n\nmodule.exports = class AssetPriceChart extends Gui {\n  constructor (asset) {\n    super(`\n      <section><h3>${asset.code} ${__(\"to\")} ${global.currency}</h3>\n        <div -ref=%container><p>${__(\"Loading...\")}</p></div>\n      </section>\n    `)\n\n    this.asset = asset\n    marketData.assetHistory(asset).then(data => this.drawChart(data))\n\n    this.listen(\"destroy\", () => this.chart && this.chart.destroy())\n  }\n\n  drawChart (data) {\n    this.chart = Highstock.stockChart(this.container, {\n      rangeSelector: { selected: 2 },\n      chart: { backgroundColor: \"#fbfbfd\" },\n      yAxis: [\n        { labels: { align: \"left\" }, height: \"80%\", resize: { enabled: true } },\n        { labels: { align: \"left\" }, top: \"80%\", height: \"20%\", offset: 0 }\n      ],\n      series: [\n        {\n          type: \"spline\",\n          name: \"Price\",\n          data: data.map(x => [x.time, +nice(x.price)])\n        },\n        {\n          type: \"column\",\n          name: \"Volume\",\n          data: data.map(x => [x.time, x.volume]),\n          yAxis: 1\n        }\n      ],\n      credits: { enabled: false }\n    })\n  }\n}\n","\"use strict\"\n/**\n * Portfolio Pie Chart\n */\nconst Highcharts = require(\"highcharts\")\nrequire(\"./helpers/highcharts-theme\")\n\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"../logic/global\")\n\n/**\n * Class\n */\n\nmodule.exports = class PortfolioPieChart extends Gui {\n  constructor (portfolio) {\n    super(`<div -ref=%container align=\"center\"></div>`)\n    this.portfolio = portfolio\n\n    this.watch(this.portfolio, \"total\", () => this.draw())\n    this.listen(\"destroy\", () => this.chart && this.chart.destroy())\n  }\n\n  reflow () {\n    if (this.chart) this.chart.reflow()\n  }\n\n  draw () {\n    if (this.chart) this.chart.destroy()\n\n    this.chart = Highcharts.chart(this.container, {\n      title: \"\",\n      legend: { enabled: false },\n      chart: { type: \"pie\" },\n      tooltip: {\n        pointFormat: `\n${__(\"Amount\")}: {point.amount} {point.code}<br>\n${__(\"Price\")}: {point.price} ${global.currency}<br>\n<b>${__(\"Value\")}: {point.y} ${global.currency}</b>\n`\n      },\n\n      plotOptions: {\n        pie: {\n          dataLabels: {\n            format: \"{point.amount} {point.code}<br>({point.percentage:.0f}%)\"\n          },\n          point: {\n            events: {\n              select: x => this.selected = x.target.options.asset,\n              legendItemClick: () => false\n            }\n          }\n        }\n      },\n\n      series: [\n        {\n          name: __(\"Amount\"),\n          colorByPoint: true,\n          ignoreHiddenPoint: true,\n          data: this.portfolio.assets\n            .filter(asset => asset.value)\n            .map(makePoint)\n            .sort((a, b) => b.y - a.y)\n        }\n      ]\n    })\n  }\n}\n\n/**\n * Helpers\n */\n\nfunction makePoint (asset) {\n  return {\n    name: asset.name,\n    code: asset.code,\n    asset: asset,\n    y: +nice(asset.value, 2),\n    amount: nice(asset.amount),\n    price: nice(asset.price),\n    percentage: asset.percentage\n  }\n}\n","\"use_strict\"\n/**\n * Theme for Highchart\n */\n\nconst Highcharts = require(\"highcharts\")\n\nHighcharts.theme = {\n  chart: { backgroundColor: \"#fbfbfd\" },\n  tooltip: { style: { fontSize: \"14px\" } },\n  credits: { enabled: false },\n\n  plotOptions: {\n    pie: {\n      allowPointSelect: true,\n      animation: false,\n      cursor: \"pointer\",\n      dataLabels: { style: { fontSize: \"14px\" } }\n    }\n  },\n\n  responsive: {\n    rules: [\n      {\n        condition: {\n          maxWidth: 500\n        },\n        chartOptions: {\n          legend: { enabled: true },\n          plotOptions: {\n            pie: {\n              showInLegend: true,\n              dataLabels: {\n                format: \"{point.percentage:.0f}%\",\n                distance: -20\n              }\n            }\n          }\n        }\n      }\n    ]\n  },\n\n  colors: [\n    \"rgba(231,  76,  60, 0.8)\",\n    \"rgba(230, 126,  34, 0.8)\",\n    \"rgba(242, 202,  39, 0.8)\",\n    \"rgba(46,  204, 112, 0.8)\",\n    \"rgba(52,  152, 219, 0.8)\",\n    \"rgba(155,  89, 182, 0.8)\",\n\n    \"rgba(231,  76,  60, 0.6)\",\n    \"rgba(230, 126,  34, 0.6)\",\n    \"rgba(242, 202,  39, 0.6)\",\n    \"rgba(46,  204, 112, 0.6)\",\n    \"rgba(52,  152, 219, 0.6)\",\n    \"rgba(155,  89, 182, 0.6)\",\n\n    \"rgba(231,  76,  60, 0.4)\",\n    \"rgba(230, 126,  34, 0.4)\",\n    \"rgba(242, 202,  39, 0.4)\",\n    \"rgba(46,  204, 112, 0.4)\",\n    \"rgba(52,  152, 219, 0.4)\",\n    \"rgba(155,  89, 182, 0.4)\"\n  ]\n}\n\nHighcharts.setOptions(Highcharts.theme)\n","\"use strict\"\n/**\n * Portfolio Table\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\n/**\n * Class\n */\nmodule.exports = class PortfolioTable extends Gui {\n  constructor (portfolio) {\n    super(`\n<table class=\"PortfolioTable\">\n  <tr>\n    <th>${__(\"Name\")}</th>\n    <th>${__(\"Anchor\")}</th>\n    <th>${__(\"Amount\")}</th>\n    <th>${__(\"Price\")}</th>\n    <th>${__(\"Value\")}</th>\n  </tr>\n  %rows...\n</table>\n`)\n\n    this.portfolio = portfolio\n    this.rows = portfolio.assets.mirror(asset => this.toAssetRow(asset))\n    this.watch(portfolio, \"total\", () => this.sort())\n    this.trap(\"selected\", () => this.onselect(this.selected))\n  }\n\n  toAssetRow (asset) {\n    const row = new AssetRow(asset)\n    row.domNode.onclick = () => {\n      if (this.selected === row.asset) this.selected = null\n      else this.selected = row.asset\n    }\n    return row\n  }\n\n  sort () {\n    this.rows.sort((a, b) => b.asset.value - a.asset.value)\n  }\n\n  onselect (asset) {\n    if (this.selectedRow) this.selectedRow.simpleView()\n    this.selectedRow = this.rows.find(row => row.asset === asset)\n    if (this.selectedRow) this.selectedRow.detailledView()\n  }\n}\n\nclass AssetRow extends Gui {\n  constructor (asset) {\n    super(`\n<tr %class>\n  <td align=\"left\">\n    <img src=%image alt=\"\">\n    <span>%name</span>\n  </td>\n  <td align=\"left\">\n    <div hidden=%simple>%anchors...</div>\n    <div class=%mode>%anchorTotal</div>\n  </td>\n  <td align=\"right\">\n    <div hidden=%simple>%amounts...</div>\n    <div class=%mode>%amountTotal</div>\n  </td>\n  <td align=\"right\">\n    <div hidden=%simple>%prices...</div>\n    <div class=%mode title=%priceDetails>%priceTotal</div>\n  </td>\n  <td align=\"right\">\n    <div hidden=%simple>%values...</div>\n    <div class=%mode>%valueTotal</div>\n  </td>\n</tr>\n    `)\n\n    this.asset = asset\n\n    this.name = asset.code\n    this.anchors = asset.balances.mirror(x => cell(x.anchor, \"name\"))\n    this.amounts = asset.balances.mirror(x => cell(x, \"amount\", nice))\n    this.prices = asset.balances.mirror(x => priceCell(x, \"price\", nice))\n    this.values = asset.balances.mirror(x => cell(x, \"value\", x => nice(x, 2)))\n    asset.link(\"image\", this)\n    asset.link(\"amount\", this, \"amountTotal\", nice)\n    asset.link(\"price\", this, \"priceTotal\", nice)\n    asset.link(\"value\", this, \"valueTotal\", x => nice(x, 2))\n    asset.anchors.feed(this, \"anchorHeader\", anchorName)\n\n    const orderbook = this.asset.orderbook\n    this.define(\"priceDetails\", \"orderbook\", () => priceDetails(orderbook))\n    this.watch(orderbook, [\"bestAsk\", \"bestBid\", \"spread%\"], () => {\n      this.compute(\"priceDetails\")\n    })\n\n    this.simpleView()\n  }\n\n  simpleView () {\n    this.simple = true\n    this.class = \"\"\n    this.mode = \"\"\n    this.anchorTotal = this.anchorHeader\n  }\n\n  detailledView () {\n    this.simple = false\n    this.class = \"selected\"\n    this.mode = \"footer\"\n    this.anchorTotal = \"Total\"\n  }\n}\n\n/**\n * Helpers\n */\n\nfunction anchorName (anchors) {\n  if (anchors.length === 1) return anchors[0].name\n  else return `${__(\"multiple\")} (${anchors.length})`\n}\n\nfunction cell (object, key, func) {\n  const node = html.create(\"div\", null, object[key])\n  object.link(key, node, \"textContent\", func)\n  return node\n}\n\nfunction priceCell (object, key, func) {\n  const node = cell(object, \"price\", func)\n  object.trap(\"orderbook\", () => {\n    if (object.orderbook) {\n      object.orderbook.trap([\"bestAsk\", \"bestBid\", \"spread%\"], () => {\n        node.title = priceDetails(object.orderbook)\n      })\n    }\n  })\n  return node\n}\n\nfunction priceDetails (orderbook) {\n  if (orderbook.base.code === \"XLM\") return \"\"\n  return `\nBuy: ${nice(orderbook.bestBid)} \\\n- Sell: ${nice(orderbook.bestAsk)} \\\n- Spread: ${nice(orderbook[\"spread%\"], 2)}%\n  `\n}\n","\"use_strict\"\n/**\n * Settings Graphical User Interface\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst Form = require(\"./helpers/form\")\nconst global = require(\"./logic/global\")\n\n/**\n * Available translations.\n */\nconst languages = {\n  us: \"English\",\n  fr: \"Franais\"\n}\n\n/**\n * Possible reference currencies.\n */\nconst currencies = [\n  \"AUD\",\n  \"BGN\",\n  \"BRL\",\n  \"CAD\",\n  \"CHF\",\n  \"CNY\",\n  \"CZK\",\n  \"DKK\",\n  \"EUR\",\n  \"GBP\",\n  \"HKD\",\n  \"HRK\",\n  \"HUF\",\n  \"IDR\",\n  \"ILS\",\n  \"INR\",\n  \"ISK\",\n  \"JPY\",\n  \"KRW\",\n  \"MXN\",\n  \"MYR\",\n  \"NOK\",\n  \"NZD\",\n  \"PHP\",\n  \"PLN\",\n  \"RON\",\n  \"RUB\",\n  \"SEK\",\n  \"SGD\",\n  \"THB\",\n  \"TRY\",\n  \"USD\",\n  \"ZAR\"\n]\n\n/**\n * Class\n */\n\nclass SettingsGui extends Gui {\n  constructor () {\n    super(`\n      <section><h2>${__(\"Settings\")}</h2>\n        <section><h3>${__(\"General Settings\")}</h3>\n          %general\n        </section>\n      </section>\n    `)\n\n    this.general = new GeneralSettings(global)\n  }\n}\n\nclass GeneralSettings extends Form {\n  constructor (global) {\n    super(\n      Form.selector({\n        label: __(\"Language\"),\n        name: \"language\",\n        values: languages\n      }),\n      Form.selector({\n        label: __(\"Currency\"),\n        name: \"currency\",\n        values: currencies\n      })\n    )\n\n    // Two-way binding.\n    global.project([\"currency\", \"language\"], this)\n    this.project([\"currency\", \"language\"], global)\n\n    // Refresh interface.\n    this.listen(\"change\", () => location.reload())\n  }\n}\n\n/**\n * Export\n */\n\nmodule.exports = SettingsGui\n","\"use_strict\"\n/**\n * Target Graphical User Interface\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst Target = require(\"./logic/target\")\nconst TargetSetup = require(\"./widgets/target-setup\")\nconst TargetsControls = require(\"./widgets/targets-controls\")\nconst TargetsTable = require(\"./widgets/targets-table\")\n\n/**\n * Class\n */\n\nmodule.exports = class RebalanceGui extends Gui {\n  constructor (portfolio) {\n    super(`\n<section class=\"RebalanceGui\">\n  <h2>${__(\"Rebalance\")}</h2>\n\n  %table\n\n  %controls\n\n</section>\n    `)\n\n    this.portfolio = portfolio\n\n    // Load & bind template from localStorage.\n    const targetKey = `target:${portfolio.account.id}`\n    const template = localStorage[targetKey]\n    this.target = Target.forPortfolio(portfolio, template)\n    this.target.link(\"json\", localStorage, targetKey, null, { init: false })\n\n    // Targets table.\n    this.table = new TargetsTable(this.target)\n    this.table.project(\"selected\", this)\n    this.project(\"selected\", this.table)\n\n    // Controls.\n    this.trap(\"selected\", () => {\n      if (this.controls) this.controls.destroy()\n      if (this.selected) {\n        this.controls = new TargetSetup(this.selected)\n        this.controls.listen(\"close\", () => this.selected = null)\n      } else {\n        this.controls = new TargetsControls(this.target)\n      }\n    })\n  }\n}\n","\"use_strict\"\n/**\n * Target class.\n *\n * A (portfolio) Target object represents a statically or dynamically allocated\n * target slice of the user portfolio. It is a theoric goal that the rebalancing\n * process aims to reach as much as possible.\n *\n * A Target may be composed by several Target subentries, in such a way that the\n * complete portfolio balancing target ends up being a tree made of Targets.\n */\nconst Mirrorable = require(\"@cosmic-plus/jsutils/es5/mirrorable\")\nconst Projectable = require(\"@cosmic-plus/jsutils/es5/projectable\")\n\nconst Asset = require(\"./asset\")\nconst Order = require(\"./order\")\n\nconst strategy = require(\"./strategy\")\nconst { arraySum, fixed7, positive } = require(\"../helpers/misc\")\n\n/**\n * Definition\n */\n\nclass Target extends Projectable {\n  constructor (asset) {\n    super()\n\n    if (asset) {\n      this.asset = asset\n      this.mode = \"ignore\"\n      this.order = Order.rebalance(this)\n\n      asset.target = this\n      this.watch(asset, \"value\", () => this.compute(\"valueDiff\"))\n\n      // XLM is never ignored.\n      if (asset.id === \"XLM\") {\n        this.mode = \"weight\"\n        this.size = 1\n      }\n    } else {\n      this.childs = new Mirrorable()\n      this.childs.listen(\"add\", child => child.parent = this)\n      this.childs.listen(\"change\", () => this.computeAll())\n    }\n\n    // Normalize & compute\n    this.trap(\"size\", () => {\n      if (this.size) {\n        this.size = positive(this.size)\n        if (this.mode === \"percentage\") this.size = Math.min(100, this.size)\n      }\n      this.computeAll()\n    })\n  }\n\n  get root () {\n    if (this.parent) return this.parent.root\n    else return this\n  }\n}\n\nTarget.define(\"name\", [\"group\", \"asset\"], function () {\n  return this.group || this.asset.id\n})\nTarget.define(\"valueDiff\", [\"value\", \"asset\"], function () {\n  return this.asset && this.asset.value - this.value\n})\nTarget.define(\"valueDiffP\", \"valueDiff\", function () {\n  return this.value ? this.valueDiff / this.value : null\n})\nTarget.define(\"amountDiff\", [\"amount\"], function () {\n  return fixed7(this.amount - this.asset.amount)\n})\nTarget.define(\"amountDelta\", [\"amountDiff\"], function () {\n  return Math.abs(this.amountDiff)\n})\n// Gets computed by \"strategy.js\".\nTarget.define(\"share\", null, function () {\n  return this.value / this.root.portfolio.total\n})\nTarget.define(\"shareDiff\", [\"share\"], function () {\n  return this.asset.share - this.share\n})\n\n/**\n * Actions\n */\n\nTarget.prototype.computeAll = function () {\n  if (this.parent) {\n    this.root.computeAll()\n  } else if (this.portfolio && this.portfolio.total) {\n    try {\n      this.error = null\n      this.value = this.portfolio.total\n      this.modified = this.hasChanged()\n      strategy.apply(this)\n    } catch (error) {\n      this.error = error.message\n      console.error(error)\n    }\n    this.trigger(\"update\")\n  }\n}\n\n/**\n * Utilities\n */\n\n/**\n * Return deterministically sorted **target** childs without mutating source\n * object.\n */\nTarget.sortChilds = function (target) {\n  const childs = target.childs.slice()\n  return childs.sort((a, b) => a.name.localeCompare(b.name))\n}\n\n/**\n * Source: Portfolio\n */\n\nTarget.forPortfolio = function (portfolio, json) {\n  const target = json ? Target.fromJson(json) : new Target()\n  target.portfolio = portfolio\n\n  portfolio.target = target\n  target.watch(portfolio, \"total\", () => target.computeAll())\n\n  // Add/Remove assets after trustline change.\n  portfolio.assets.forEach(asset => {\n    if (\n      !target.childs.find(child => asset === child.asset)\n      && asset.isSupported\n    )\n      target.childs.push(new Target(asset))\n  })\n  target.childs.forEach((child, index) => {\n    if (\n      !portfolio.assets.find(asset => asset === child.asset)\n      || !child.asset.isSupported\n    )\n      target.childs.splice(index, 1)\n  })\n  portfolio.assets.listen(\"add\", asset => {\n    if (asset.isValid) target.childs.push(new Target(asset))\n  })\n  portfolio.assets.listen(\"remove\", asset => {\n    const index = target.childs.findIndex(child => child.asset === asset)\n    target.childs.splice(index, 1)\n  })\n\n  return target\n}\n\n/**\n * Format: JSON\n */\n\nTarget.fromJson = function (json) {\n  const object = JSON.parse(json)\n  const target = Target.fromObject(object)\n  target.json = json\n  return target\n}\n\nTarget.prototype.toJson = function (beautifyFlag) {\n  const object = this.toObject()\n  return JSON.stringify(object, null, beautifyFlag && 2)\n}\n\nTarget.prototype.hasChanged = function () {\n  return this.toJson() !== (this.json || \"{\\\"childs\\\":[]}\")\n}\n\n/**\n * Format: Object\n */\n\nTarget.fromObject = function (object) {\n  if (typeof object === \"string\") object = { asset: object }\n\n  // Create Target instance.\n  const asset = object.asset && Asset.resolve(object.asset)\n  const target = new Target(asset)\n  target.size = object.size\n  target.mode = object.mode\n\n  // Conversion from versions <= 0.5  REMOVAL: 2020-05 (one year).\n  if (target.mode === \"equal\") target.mode = \"weight\"\n  if (target.mode === \"skip\") target.mode = \"ignore\"\n\n  // Fix for versions <= 0.6.1 - REMOVAL: 2020-06 (one year).\n  if (target.asset && target.asset.id === \"XLM\" && target.mode === \"ignore\") {\n    target.mode = \"weight\"\n    target.size = 1\n  }\n\n  // Set defaults.\n  if (!target.mode) target.mode = \"weight\"\n  if (target.size == null && target.mode === \"weight\") target.size = 1\n\n  // Parse childs.\n  if (object.childs) {\n    target.group = object.group\n    const childs = object.childs.map(entry => Target.fromObject(entry))\n\n    // Conversion from versions <= 0.5  REMOVAL: 2020-05 (one year).\n    //\n    // When there was no \"equal\" target, percentage targets whose sum is under\n    // 100 would act like \"weight\".\n    const percentChilds = childs.filter(child => child.mode === \"percentage\")\n    if (\n      percentChilds.length\n      && !childs.find(child => child.mode === \"weight\")\n      && arraySum(percentChilds, \"size\") !== 100\n    ) {\n      percentChilds.forEach(child => child.mode = \"weight\")\n    }\n\n    target.childs.push(...childs)\n  }\n\n  return target\n}\n\nTarget.prototype.toObject = function () {\n  if (this.mode === \"ignore\") return\n  let object = { mode: this.mode, size: this.size }\n  if (object.mode === \"weight\") {\n    delete object.mode\n    if (object.size === 1) delete object.size\n  }\n\n  if (this.asset) {\n    object.asset = this.name\n    if (Object.keys(object).length === 1) object = object.asset\n  } else if (this.childs) {\n    object.group = this.group\n    const childs = Target.sortChilds(this)\n    object.childs = childs.map(target => target.toObject()).filter(x => x)\n  }\n\n  return object\n}\n\n/**\n * Export\n */\n\nmodule.exports = Target\n","\"use_strict\"\n/**\n * Rebalancing strategies\n */\nconst strategy = exports\n\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst global = require(\"./global\")\nconst { fixed7, positive } = require(\"../helpers/misc\")\n\n/**\n * Applicator\n */\n\nstrategy.apply = function (target) {\n  const delayed = []\n  let sum = 0,\n    weights = 0\n\n  target.childs.forEach(child => {\n    const mode = child.mode\n    if (mode === \"weight\") {\n      delayed.push(child)\n      weights += child.size\n    } else {\n      strategy[mode](child)\n      sum += child.value\n    }\n  })\n\n  const remains = positive(target.value - sum)\n  delayed.forEach(child => strategy.weight(child, remains, weights))\n\n  checkAllocationLimits(sum, target.value, delayed.length)\n}\n\nfunction checkAllocationLimits (allocated, available, checkUnderFlag) {\n  if (allocated > available) {\n    const over = +nice(allocated - available, 2)\n    const overP = +nice(100 * over / available, 2)\n    let msg = __(\"Rebalance setup is over portfolio value by\")\n    msg += ` ${over} ${global.currency} (${overP}%) `\n    throw new Error(msg)\n  } else if (!checkUnderFlag && allocated < available) {\n    const under = +nice(available - allocated, 2)\n    const underP = +nice(100 * under / available, 2)\n    let msg = __(\"Rebalance setup is under portfolio value by\")\n    msg += ` ${under} ${global.currency} (${underP}%) `\n    throw new Error(msg)\n  }\n}\n\n/**\n * Strategies\n */\n\nstrategy.amount = function (target) {\n  target.amount = target.size\n  target.value = target.amount * target.asset.price\n  target.compute(\"share\")\n}\n\nstrategy.ignore = function (target) {\n  target.value = target.asset.value\n  target.amount = target.asset.amount\n  target.compute(\"share\")\n}\n\nstrategy.percentage = function (target) {\n  strategy.weight(target, target.parent.value, 100)\n}\n\nstrategy.weight = function (target, remains, weights) {\n  if (!weights) {\n    target.value = target.amount = 0\n  } else {\n    target.value = target.size * remains / weights\n    target.amount = fixed7(target.value / target.asset.price)\n  }\n  target.compute(\"share\")\n}\n","\"use strict\"\n/**\n * Target Setup Form\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\n\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nmodule.exports = class TargetSetup extends Gui {\n  constructor (target) {\n    super(`\n<section class=\"TargetSetup\">\n  <form onsubmit=\"return false\">\n\n    <h3>%name</h3>\n    <hr>\n\n    <label><span>${__(\"Size\")}:</span>\n\n      <input class=\"half\" type=\"number\" step=\"any\" min=\"0\" %max\n        value=%size placeholder=%share onchange=%maybeSwitchMode>\n\n      <select class=\"half\" onchange=%setMode value=%mode>\n        <option value=\"weight\">${__(\"Weight\")}</option>\n        <option value=\"percentage\">${__(\"Percentage\")}</option>\n        <option value=\"amount\">${__(\"Amount\")}</option>\n        <option value=\"ignore\" hidden=%targetIsXlm>${__(\"Ignore\")}</option>\n      </select>\n\n    </label>\n\n    <hr>\n    <input type=\"submit\" onclick=%close value=\"${__(\"Close\")}\">\n\n  </form>\n</section>\n    `)\n\n    this.target = target\n    this.name = target.asset.name\n    this.targetIsXlm = target.asset.id === \"XLM\"\n\n    target.project(\"share\", this, x => nice(100 * x, 2))\n\n    target.project(\"size\", this)\n    this.project(\"size\", target, x => x != null ? Number(x) : null)\n\n    target.project(\"mode\", this)\n    this.project(\"mode\", target)\n  }\n\n  maybeSwitchMode () {\n    if (this.size === 0) {\n      this.mode = \"amount\"\n    } else if (!this.size) {\n      this.mode = \"ignore\"\n    } else if (this.mode === \"ignore\") {\n      this.mode = \"percentage\"\n      this.target.computeAll()\n    }\n  }\n\n  setMode () {\n    // TODO: Move this logic to Target model.\n    switch (this.mode) {\n    case \"weight\":\n      this.size = 1\n      this.max = null\n      break\n    case \"percentage\":\n      this.size = +nice(100 * this.target.asset.share, 2)\n      this.max = 100\n      break\n    case \"amount\":\n      this.size = this.target.asset.amount\n      this.max = null\n      break\n    case \"ignore\":\n      this.size = null\n      break\n    }\n  }\n\n  close () {\n    this.maybeSwitchMode()\n    this.trigger(\"close\")\n    this.destroy()\n  }\n}\n","\"use strict\"\n/**\n * Targets Controls\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst SideFrame = require(\"../helpers/side-frame\")\n\nconst Order = require(\"../logic/order\")\n\n/**\n * Class\n */\n\nmodule.exports = class TargetsControls extends Gui {\n  constructor (target) {\n    super(`\n<section class=\"TargetControls\">\n  <form onsubmit=\"return false\" hidden=%hideRebalance>\n    <button onclick=%rebalance disabled=%invalid>${__(\"Rebalance\")}</button>\n  </form>\n\n  <form onsubmit=\"return false\" hidden=%hideSave>\n    <button onclick=%save disabled=%invalid>${__(\"Save\")}</button>\n    <button onclick=%cancel>${__(\"Cancel\")}</button>\n  </form>\n\n  %toParagraph:error\n</section>\n    `)\n\n    this.target = target\n    target.project([\"error\", \"modified\"], this)\n\n    this.define(\"hideRebalance\", [\"modified\"], () => this.modified)\n    this.define(\"hideSave\", [\"modified\"], () => !this.modified)\n    this.define(\"invalid\", [\"error\"], () => !!this.error)\n  }\n\n  toParagraph (error) {\n    if (error) return html.create(\"p\", \".error\", error)\n  }\n\n  cancel () {\n    location.reload()\n  }\n\n  save () {\n    this.target.json = this.target.toJson()\n    this.target.modified = false\n  }\n\n  rebalance () {\n    // TODO: Move this logic to Order & Offers models.\n    const operations = listOperations(this.target)\n    const portfolio = this.target.portfolio\n    const outdated = portfolio.offers.filter(offer => offer.outdated)\n    const remaining = outdated.filter(offer => {\n      return !operations.find(op => op.offer.id === offer.id)\n    })\n    operations.forEach(op => {\n      if (!op.offer.id && remaining.length) op.offer.id = remaining.pop().id\n    })\n\n    if (!operations.length) return false\n\n    const cosmicLink = Order.operationsToCosmicLink(operations)\n    remaining.forEach(offer => {\n      cosmicLink.addOperation(\"manageOffer\", { amount: 0, offerId: offer.id })\n    })\n    if (cosmicLink) {\n      const sideFrame = new SideFrame(cosmicLink.uri)\n      sideFrame.listen(\"destroy\", () => {\n        portfolio.getAccount()\n        portfolio.offers.get()\n      })\n    }\n  }\n}\n\nfunction listOperations (target) {\n  let operations = []\n  target.childs.forEach(child => {\n    if (child.order) operations = operations.concat(child.order.operations)\n  })\n  return operations\n}\n","\"use strict\"\n/**\n * Targets Table\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst nice = require(\"@cosmic-plus/jsutils/es5/nice\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nmodule.exports = class TargetsTable extends Gui {\n  constructor (target) {\n    super(`\n<section class=\"TargetsTable\">\n  <table>\n    <tr>\n      <th>${__(\"Name\")}</th>\n      <th>${__(\"Goal\")}</th>\n      <th>${__(\"Divergence\")}</th>\n      <th>${__(\"Operation\")}</th>\n    </tr>\n\n    %targets...\n\n    <tr hidden=true>\n      <td align=\"center\" colspan=\"4\"><h3>${__(\"Add Asset\")}</h3></td>\n    </tr>\n  </table>\n</section>\n    `)\n\n    this.targets = target.childs.mirror(child => this.toTargetRow(child))\n    this.selected = undefined\n\n    target.listen(\"update\", () => this.sortTargets())\n    this.sortTargets()\n  }\n\n  toTargetRow (target) {\n    const row = new TargetRow(target)\n    row.domNode.onclick = () => this.selected = target\n    return row\n  }\n\n  sortTargets () {\n    this.targets.sort((a, b) => {\n      a = a.target\n      b = b.target\n      if (b.mode === \"ignore\" && a.mode !== \"ignore\") return -1\n      else if (a.mode === \"ignore\" && b.mode !== \"ignore\") return 1\n      return b.value - a.value || a.asset.code.localeCompare(b.asset.code)\n    })\n  }\n}\n\nclass TargetRow extends Gui {\n  constructor (target) {\n    super(`\n<tr class=\"TargetRow\">\n  <td align=\"left\">\n    <img src=%image alt=\"\">\n    <span>%name</span>\n  </td>\n  <td align=\"right\">%command</td>\n  <td align=\"right\">%toPercent:shareDiff</td>\n  <td align=\"right\">%toDiv:description...</td>\n</tr>\n    `)\n\n    this.target = target\n    this.name = target.asset.code\n\n    this.define(\"command\", null, () => this.toCommand(target))\n    this.watch(target, [\"size\", \"mode\", \"share\"], () => this.compute(\"command\"))\n\n    target.asset.project(\"image\", this)\n    target.project(\"shareDiff\", this)\n\n    if (target.order) target.order.project(\"description\", this)\n  }\n\n  toCommand (target) {\n    switch (target.mode) {\n    case \"ignore\":\n      return __(\"Ignore\")\n    case \"amount\":\n      return `${target.amount} ${target.asset.code}`\n    case \"weight\":\n      return `${target.size}  ${this.toPercent(target.share)}`\n    case \"percentage\":\n      return this.toPercent(target.share)\n    }\n  }\n\n  toPercent (x) {\n    return !x ? \"-\" : nice(x * 100, 2) + \"%\"\n  }\n\n  toDiv (obj) {\n    return html.create(\"div\", null, obj)\n  }\n}\n","module.exports = \"<section><h2>License</h2>\\n  <section><h3>MIT License</h3>\\n\\n    <p>Copyright (c) 2019 Antoine Bodin &lt;<a\\n    href=\\\"mailto:mister.ticot@cosmic.plus\\\">mister.ticot@cosmic.plus</a>&gt;</p>\\n\\n    <p>Permission is hereby granted, free of charge, to any person obtaining a\\n    copy of this software and associated documentation files (the \\\"Software\\\"),\\n    to deal in the Software without restriction, including without limitation\\n    the rights to use, copy, modify, merge, publish, distribute, sublicense,\\n    and/or sell copies of the Software, and to permit persons to whom the\\n    Software is furnished to do so, subject to the following conditions:</p>\\n\\n    <p>The above copyright notice and this permission notice shall be included\\n    in all copies or substantial portions of the Software.</p>\\n\\n    <p>THE SOFTWARE IS PROVIDED \\\"AS IS\\\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\\n    OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\\n    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\\n    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\\n    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\\n    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\\n    IN THE SOFTWARE.</p>\\n  </section>\\n</section>\\n\"","module.exports = \"<section><h2>February, 16th  Beta 1 Release</h2>\\n  <section><h3>Welcome!</h3>\\n\\n    <p>Equilibre.io is a portfolio balancer that runs on the Stellar\\n    Decentralized Exchange. It is a convenient trading tool to manage long-term\\n    positions.</p>\\n\\n    <p>Regularly balancing an investment portfolio is known to boost its\\n    performances, providing you choose wisely the assets to bet on. Equilibre.io\\n    also lets you spread your positions over several anchors, for better fund\\n    safety.</p>\\n\\n    <p>Equilibre.io is still under testing & development. If you use it now,\\n    I'll ask you to consider yourself as a tester. Please report any bug you\\n    could encounter, and double-check transactions before signing them.</p>\\n\\n    <p>Your feedback matters to me and will be listened to.</p>\\n\\n    <p>Respectfully, <br>MisterTicot</p>\\n\\n  </section>\\n\\n  <section><h3>To Be Implemented</h3>\\n    <ul>\\n      <li>Interface to add/remove assets</li>\\n      <li>Portfolio historic value</li>\\n      <li>Customizable rebalancing periodicity</li>\\n      <li>Pie graph for rebalancing tab</li>\\n    </ul>\\n  </section>\\n\\n  <section><h3>Known Limitations</h3>\\n    <ul>\\n\\n      <li>It is required to \\\"Cancel All\\\" offers between applying a new balance\\n      setup</li>\\n\\n    </ul>\\n  </section>\\n</section>\\n\"","\"use_strict\"\n/**\n * Footer\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\nconst html = require(\"@cosmic-plus/domutils/es5/html\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst donate = require(\"./helpers/donate\")\nconst Icon = require(\"./helpers/icon\")\n\nconst global = require(\"./logic/global\")\n\n/**\n * Class\n */\n\nclass Footer extends Gui {\n  constructor (icons, links) {\n    super(\n      `\n<footer id=\"footer\" class=\"scrollable\">\n  <div class=\"nobreak\">%icons...</div>\n  %links\n</footer>\n    `,\n      { icons, links }\n    )\n  }\n}\n\n/**\n * Icons\n *\n * SVG from @fortawesome/font-awesome-free\n * CC BY 4.0 License (https://creativecommons.org/licenses/by/4.0/)\n */\n\nconst icons = [\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/brands/keybase.svg\"),\n    \"Keybase\",\n    \"https://keybase.io/team/cosmic_plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/brands/telegram-plane.svg\"),\n    \"Telegram\",\n    \"https://t.me/cosmic_plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/brands/reddit.svg\"),\n    \"Reddit\",\n    \"https://reddit.com/r/cosmic_plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/brands/twitter.svg\"),\n    \"Twitter\",\n    \"https://twitter.com/cosmic_plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/brands/medium.svg\"),\n    \"Medium\",\n    \"https://medium.com/cosmic-plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/brands/github.svg\"),\n    \"GitHub\",\n    \"https://github.com/cosmic-plus/webapp-equilibre-io\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/solid/globe.svg\"),\n    __(\"Website\"),\n    \"https://cosmic.plus\"\n  ),\n  new Icon(\n    require(\"@fortawesome/fontawesome-free/svgs/solid/envelope.svg\"),\n    __(\"Email\"),\n    \"mailto:mister.ticot@cosmic.plus\"\n  ),\n  new Icon(require(\"./svg/donate.svg\"), \"Donate\", donate)\n]\n\n/**\n * Demo Page\n */\nconst MYPUBKEY = \"GAWO2C52D57XBT7SQL6YB3XPHFLFD2J4Z5RN7HPFZSHXJMXH72HRXNV3\"\nfunction displayDemo () {\n  localStorage[`target:${MYPUBKEY}`] = demoConfig\n  location.href = `?address=${MYPUBKEY}`\n}\n\nconst demoConfig = `{\"childs\":[\"EUR\",\"CNY\",\"USD\",{\"size\":12.5,\"mode\":\"percentage\",\"asset\":\"XLM\"},{\"size\":12.5,\"mode\":\"percentage\",\"asset\":\"ETH\"},{\"size\":12.5,\"mode\":\"percentage\",\"asset\":\"BTC\"},{\"size\":4,\"mode\":\"percentage\",\"asset\":\"SLT\"},{\"size\":4,\"mode\":\"percentage\",\"asset\":\"REPO\"},{\"size\":2.25,\"mode\":\"percentage\",\"asset\":\"PEDI\"},{\"size\":2.25,\"mode\":\"percentage\",\"asset\":\"TERN\"}]}`\n\n/**\n * Links\n */\nconst links = new Gui(\n  `\n<p>\n  <a target=\"_blank\" rel=\"noopener\" href=\"https://cosmic.plus\">${__(\n    \"A Cosmic.Plus Software\"\n  )}</a>\n   <a onclick=%displayDemo>${__(\"Demo\")}</a>\n   <a target=\"_blank\" rel=\"noopener\" href=\"https://nucleo.fi/leaderboard/top/?span=3m\">Performance</a>\n   <a onclick=%displayLicense>${__(\"License\")}</a>\n   <a onclick=%displayAbout>${__(\"About\")}</a>\n</p>\n`,\n  {\n    displayDemo,\n    displayLicense: () => global.tabs.select(\"#license\"),\n    displayAbout: () => global.tabs.select(\"#about\")\n  }\n)\n\n/**\n * Create footer\n */\n\nconst footer = new Footer(icons, links)\nhtml.append(document.body, footer)\n","\"use_strict\"\n/**\n * Donate Interface\n */\nconst { CosmicLink } = require(\"cosmic-lib\")\nconst { __ } = require(\"@cosmic-plus/i18n\")\n\nconst SideFrame = require(\"./side-frame\")\n\nconst MYPUBKEY = \"GAWO2C52D57XBT7SQL6YB3XPHFLFD2J4Z5RN7HPFZSHXJMXH72HRXNV3\"\n\nmodule.exports = function promptDonation () {\n  const amount = prompt(`\\\n${__(\"Equilibre.io runs on donation.\")}\\\n${__(\"Each contribution is a pleasant surprise for me. :)\")}\n\n${__(\"Enter an amount (in Lumens)\")}:\\\n`)\n\n  if (amount === \"0\" || isNaN(+amount)) {\n    confirm(`${__(\"Not a valid amount\")}: ${amount}`)\n  } else if (amount) {\n    showDonateFrame(amount)\n  }\n}\n\nfunction showDonateFrame (amount) {\n  const memo = __(\"Donation to Equilibre.io\")\n  const network = \"public\"\n  const cosmicLink = new CosmicLink({ memo, network }).addOperation(\"payment\", {\n    amount,\n    destination: MYPUBKEY\n  })\n\n  new SideFrame(cosmicLink.uri)\n}\n","\"use_strict\"\n/**\n * Footer Icons\n */\nconst Gui = require(\"@cosmic-plus/domutils/es5/gui\")\n\nclass Icon extends Gui {\n  constructor (image, name, action) {\n    super(`<a -ref=%link class=\"Icon\">%image</a>`)\n\n    this.image = typeof image === \"string\" ? new Gui(image) : image\n    this.link.title = name\n\n    if (typeof action === \"function\") {\n      this.link.onclick = action\n    } else if (typeof action === \"string\") {\n      this.link.href = action\n      if (action.match(/^http/)) {\n        this.link.target = \"_blank\"\n        this.link.rel = \"noopener\"\n      }\n    }\n  }\n}\n\nmodule.exports = Icon\n","module.exports = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><path fill=\\\"none\\\" d=\\\"M0 0h512v512H0z\\\"/><path d=\\\"M211.719 367.797C219.469 379.281 224 393.109 224 408c0 39.734-32.266 72-72 72-39.758 0-72-32.266-72-72 0-23.172 11.148-43.563 28.164-56.734 1.852 5.594 4.336 11.125 8.289 15.906 7.055 8.516 20.336 18.266 43.531 16.344 7.578-.641 15.844-2.547 24.586-5.641 8.875-3.078 18.508-6.5 27.149-10.078zM389.875 32.578c-13.344 3.797-24.156 10.672-38.813 18.328-90 47-196.25 39.25-220 77-27.469 51.672-48.883 89.203-48.945 107.625-.016.063-.055.094-.07.141.586 19.953 19.625 58.438 29.07 75.969 6.789-15.516 17.492-29.219 32.25-40.688 7.414-5.766 13.289-9.922 18.617-13.5-3.016-9.25-6.945-20.016-10.875-28.203 10.742-7.391 26.078-26.484 31.398-40.313 13.227.094 30.25-3.172 44.773-6.938 6.406 6.844 12.977 13.563 21.766 20.016-3.961 14.344-7.07 27.063-23.438 38.359-22.313 15.438-42.734 21.578-69.484 43.109-16.086 12.953-26.07 28.203-30.625 45.641-3.148 12.094 4.734 53.016 58 33.141 10.023-3.75 23.398-8.531 34.875-14.25 23.797-11.813 52.922-40.781 61-44.828 15.234-7.641 49.813-10.656 86.313-35.016 12.531-8.375 22.063-20.688 26.477-33.625 33.242-64.828 60.883-59.656 68.633-72.563C477.734 133.734 423.563 23 389.875 32.578z\\\"/></svg>\\n\""],"sourceRoot":""}